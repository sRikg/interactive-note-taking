<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>[1708.02182] Regularizing and Optimizing LSTM Language Models</title><meta property="og:description" content="Recurrent neural networks (RNNs), such as long short-term memory networks (LSTMs), serve as a fundamental building block for many sequence learning tasks, including machine translation, language modeling, and question …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Regularizing and Optimizing LSTM Language Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Regularizing and Optimizing LSTM Language Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1708.02182">

<!--Generated on Fri Dec 31 15:01:12 2021 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="machine learning,  deep learning,  LSTM,  regularization,  optimization">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }
  
  detectColorScheme();
  
  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv.0.7.4.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.0.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Regularizing and Optimizing LSTM Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Stephen Merity
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nitish Shirish Keskar
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Richard Socher
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Recurrent neural networks (RNNs), such as long short-term memory networks (LSTMs), serve as a fundamental building block for many sequence learning tasks, including machine translation, language modeling, and question answering.
In this paper, we consider the specific problem of word-level language modeling and investigate strategies for regularizing and optimizing LSTM-based models.
We propose the weight-dropped LSTM which uses DropConnect on hidden-to-hidden weights as a form of recurrent regularization.
Further, we introduce NT-ASGD, a variant of the averaged stochastic gradient method, wherein the averaging trigger is determined using a non-monotonic condition as opposed to being tuned by the user.
Using these and other regularization strategies, we achieve state-of-the-art word level perplexities on two data sets: 57.3 on Penn Treebank and 65.8 on WikiText-2.
In exploring the effectiveness of a neural cache in conjunction with our proposed model, we achieve an even lower state-of-the-art perplexity of 52.8 on Penn Treebank and 52.0 on WikiText-2.</p>
</div>
<div class="ltx_keywords">machine learning, deep learning, LSTM, regularization, optimization
</div>
<div id="p1" class="ltx_para ltx_noindent">
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Effective regularization techniques for deep learning have been the subject of much research in recent years.
Given the over-parameterization of neural networks, generalization performance crucially relies on the ability to regularize the models sufficiently.
Strategies such as dropout <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al., <a href="#bib.bib35" title="" class="ltx_ref">2014</a>)</cite> and batch normalization <cite class="ltx_cite ltx_citemacro_citep">(Ioffe &amp; Szegedy, <a href="#bib.bib15" title="" class="ltx_ref">2015</a>)</cite> have found great success and are now ubiquitous in feed-forward and convolutional neural networks.
Naïvely applying these approaches to the case of recurrent neural networks (RNNs) has not been highly successful however.
Many recent works have hence been focused on the extension of these regularization strategies to RNNs; we briefly discuss some of them below.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A naïve application of dropout <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al., <a href="#bib.bib35" title="" class="ltx_ref">2014</a>)</cite> to an RNN’s hidden state is ineffective as it disrupts the RNN’s ability to retain long term dependencies <cite class="ltx_cite ltx_citemacro_citep">(Zaremba et al., <a href="#bib.bib42" title="" class="ltx_ref">2014</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citet">Gal &amp; Ghahramani (<a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite> propose overcoming this problem by retaining the same dropout mask across multiple time steps as opposed to sampling a new binary mask at each timestep.
Another approach is to regularize the network through limiting updates to the RNN’s hidden state.
One such approach is taken by <cite class="ltx_cite ltx_citemacro_citet">Semeniuta et al. (<a href="#bib.bib33" title="" class="ltx_ref">2016</a>)</cite> wherein the authors drop updates to network units, specifically the input gates of the LSTM, in lieu of the units themselves.
This is reminiscent of zoneout <cite class="ltx_cite ltx_citemacro_citep">(Krueger et al., <a href="#bib.bib22" title="" class="ltx_ref">2016</a>)</cite> where updates to the hidden state may fail to occur for randomly selected neurons.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Instead of operating on the RNN’s hidden states, one can regularize the network through restrictions on the recurrent matrices as well.
This can be done either through restricting the capacity of the matrix <cite class="ltx_cite ltx_citemacro_citep">(Arjovsky et al., <a href="#bib.bib1" title="" class="ltx_ref">2016</a>; Wisdom et al., <a href="#bib.bib41" title="" class="ltx_ref">2016</a>; Jing et al., <a href="#bib.bib16" title="" class="ltx_ref">2016</a>)</cite> or through element-wise interactions <cite class="ltx_cite ltx_citemacro_citep">(Balduzzi &amp; Ghifary, <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Bradbury et al., <a href="#bib.bib5" title="" class="ltx_ref">2016</a>; Seo et al., <a href="#bib.bib34" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Other forms of regularization explicitly act upon activations such as batch normalization <cite class="ltx_cite ltx_citemacro_citep">(Ioffe &amp; Szegedy, <a href="#bib.bib15" title="" class="ltx_ref">2015</a>)</cite>, recurrent batch normalization <cite class="ltx_cite ltx_citemacro_citep">(Cooijmans et al., <a href="#bib.bib6" title="" class="ltx_ref">2016</a>)</cite>, and layer normalization <cite class="ltx_cite ltx_citemacro_citep">(Ba et al., <a href="#bib.bib2" title="" class="ltx_ref">2016</a>)</cite>.
These all introduce additional training parameters and can complicate the training process while increasing the sensitivity of the model.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this work, we investigate a set of regularization strategies that are not only highly effective but which can also be used with no modification to existing LSTM implementations.
The weight-dropped LSTM applies recurrent regularization through a DropConnect mask on the hidden-to-hidden recurrent weights.
Other strategies include the use of randomized-length backpropagation through time (BPTT), embedding dropout, activation regularization (AR), and temporal activation regularization (TAR).</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">As no modifications are required of the LSTM implementation these regularization strategies are compatible with black box libraries, such as NVIDIA cuDNN, which can be many times faster than naïve LSTM implementations.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Effective methods for training deep recurrent networks have also been a topic of renewed interest. Once a model has been defined, the training algorithm used is required to not only find a good minimizer of the loss function but also converge to such a minimizer rapidly. The choice of the optimizer is even more important in the context of regularized models since such strategies, especially the use of dropout, can impede the training process. Stochastic gradient descent (SGD), and its variants such as Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib20" title="" class="ltx_ref">2014</a>)</cite> and RMSprop <cite class="ltx_cite ltx_citemacro_citep">(Tieleman &amp; Hinton, <a href="#bib.bib38" title="" class="ltx_ref">2012</a>)</cite> are amongst the most popular training methods. These methods iteratively reduce the training loss through scaled (stochastic) gradient steps. In particular, Adam has been found to be widely applicable despite requiring less tuning of its hyperparameters. In the context of word-level language modeling, past work has empirically found that SGD outperforms other methods in not only the final loss but also in the rate of convergence. This is in agreement with recent evidence pointing to the insufficiency of adaptive gradient methods <cite class="ltx_cite ltx_citemacro_citep">(Wilson et al., <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.3" class="ltx_p">Given the success of SGD, especially within the language modeling domain, we investigate the use of averaged SGD (ASGD) <cite class="ltx_cite ltx_citemacro_citep">(Polyak &amp; Juditsky, <a href="#bib.bib31" title="" class="ltx_ref">1992</a>)</cite> which is known to have superior theoretical guarantees.
ASGD carries out iterations similar to SGD, but instead of returning the last iterate as the solution, returns an average of the iterates past a certain, tuned, threshold <math id="S1.p8.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S1.p8.1.m1.1a"><mi id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><ci id="S1.p8.1.m1.1.1.cmml" xref="S1.p8.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S1.p8.1.m1.1d">italic_T</annotation></semantics></math>.
This threshold <math id="S1.p8.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S1.p8.2.m2.1a"><mi id="S1.p8.2.m2.1.1" xref="S1.p8.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S1.p8.2.m2.1b"><ci id="S1.p8.2.m2.1.1.cmml" xref="S1.p8.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S1.p8.2.m2.1d">italic_T</annotation></semantics></math> is typically tuned and has a direct impact on the performance of the method.
We propose a variant of ASGD where <math id="S1.p8.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S1.p8.3.m3.1a"><mi id="S1.p8.3.m3.1.1" xref="S1.p8.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S1.p8.3.m3.1b"><ci id="S1.p8.3.m3.1.1.cmml" xref="S1.p8.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S1.p8.3.m3.1d">italic_T</annotation></semantics></math> is determined on the fly through a non-monotonic criterion and show that it achieves better training outcomes compared to SGD.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Weight-dropped LSTM</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">We refer to the mathematical formulation of the LSTM,</p>
<table id="S9.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle i_{t}" display="inline"><semantics id="S2.Ex1.m1.1a"><msub id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.2" xref="S2.Ex1.m1.1.1.2.cmml">i</mi><mi id="S2.Ex1.m1.1.1.3" xref="S2.Ex1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.cmml" xref="S2.Ex1.m1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.2">𝑖</ci><ci id="S2.Ex1.m1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle i_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m2.1" class="ltx_Math" alttext="\displaystyle=\sigma(W^{i}x_{t}+U^{i}h_{t-1})" display="inline"><semantics id="S2.Ex1.m2.1a"><mrow id="S2.Ex1.m2.1.1" xref="S2.Ex1.m2.1.1.cmml"><mi id="S2.Ex1.m2.1.1.3" xref="S2.Ex1.m2.1.1.3.cmml"></mi><mo id="S2.Ex1.m2.1.1.2" xref="S2.Ex1.m2.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m2.1.1.1" xref="S2.Ex1.m2.1.1.1.cmml"><mi id="S2.Ex1.m2.1.1.1.3" xref="S2.Ex1.m2.1.1.1.3.cmml">σ</mi><mo id="S2.Ex1.m2.1.1.1.2" xref="S2.Ex1.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m2.1.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.1.2" xref="S2.Ex1.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m2.1.1.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.1.1.cmml"><mrow id="S2.Ex1.m2.1.1.1.1.1.1.2" xref="S2.Ex1.m2.1.1.1.1.1.1.2.cmml"><msup id="S2.Ex1.m2.1.1.1.1.1.1.2.2" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex1.m2.1.1.1.1.1.1.2.2.2" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S2.Ex1.m2.1.1.1.1.1.1.2.2.3" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2.3.cmml">i</mi></msup><mo id="S2.Ex1.m2.1.1.1.1.1.1.2.1" xref="S2.Ex1.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex1.m2.1.1.1.1.1.1.2.3" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex1.m2.1.1.1.1.1.1.2.3.2" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S2.Ex1.m2.1.1.1.1.1.1.2.3.3" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S2.Ex1.m2.1.1.1.1.1.1.1" xref="S2.Ex1.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.Ex1.m2.1.1.1.1.1.1.3" xref="S2.Ex1.m2.1.1.1.1.1.1.3.cmml"><msup id="S2.Ex1.m2.1.1.1.1.1.1.3.2" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex1.m2.1.1.1.1.1.1.3.2.2" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S2.Ex1.m2.1.1.1.1.1.1.3.2.3" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2.3.cmml">i</mi></msup><mo id="S2.Ex1.m2.1.1.1.1.1.1.3.1" xref="S2.Ex1.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex1.m2.1.1.1.1.1.1.3.3" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex1.m2.1.1.1.1.1.1.3.3.2" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.2" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.1" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.1.cmml">-</mo><mn id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.3" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.1.3" xref="S2.Ex1.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m2.1b"><apply id="S2.Ex1.m2.1.1.cmml" xref="S2.Ex1.m2.1.1"><eq id="S2.Ex1.m2.1.1.2.cmml" xref="S2.Ex1.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.Ex1.m2.1.1.3.cmml" xref="S2.Ex1.m2.1.1.3">absent</csymbol><apply id="S2.Ex1.m2.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1"><times id="S2.Ex1.m2.1.1.1.2.cmml" xref="S2.Ex1.m2.1.1.1.2"></times><ci id="S2.Ex1.m2.1.1.1.3.cmml" xref="S2.Ex1.m2.1.1.1.3">𝜎</ci><apply id="S2.Ex1.m2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1"><plus id="S2.Ex1.m2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.1"></plus><apply id="S2.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2"><times id="S2.Ex1.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.1"></times><apply id="S2.Ex1.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S2.Ex1.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S2.Ex1.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S2.Ex1.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.Ex1.m2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3"><times id="S2.Ex1.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.1"></times><apply id="S2.Ex1.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S2.Ex1.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S2.Ex1.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex1.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex1.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3"><minus id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.Ex1.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m2.1c">\displaystyle=\sigma(W^{i}x_{t}+U^{i}h_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle f_{t}" display="inline"><semantics id="S2.Ex2.m1.1a"><msub id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.2" xref="S2.Ex2.m1.1.1.2.cmml">f</mi><mi id="S2.Ex2.m1.1.1.3" xref="S2.Ex2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.1b"><apply id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.cmml" xref="S2.Ex2.m1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.2">𝑓</ci><ci id="S2.Ex2.m1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.1c">\displaystyle f_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex2.m2.1" class="ltx_Math" alttext="\displaystyle=\sigma(W^{f}x_{t}+U^{f}h_{t-1})" display="inline"><semantics id="S2.Ex2.m2.1a"><mrow id="S2.Ex2.m2.1.1" xref="S2.Ex2.m2.1.1.cmml"><mi id="S2.Ex2.m2.1.1.3" xref="S2.Ex2.m2.1.1.3.cmml"></mi><mo id="S2.Ex2.m2.1.1.2" xref="S2.Ex2.m2.1.1.2.cmml">=</mo><mrow id="S2.Ex2.m2.1.1.1" xref="S2.Ex2.m2.1.1.1.cmml"><mi id="S2.Ex2.m2.1.1.1.3" xref="S2.Ex2.m2.1.1.1.3.cmml">σ</mi><mo id="S2.Ex2.m2.1.1.1.2" xref="S2.Ex2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex2.m2.1.1.1.1.1" xref="S2.Ex2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m2.1.1.1.1.1.2" xref="S2.Ex2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m2.1.1.1.1.1.1" xref="S2.Ex2.m2.1.1.1.1.1.1.cmml"><mrow id="S2.Ex2.m2.1.1.1.1.1.1.2" xref="S2.Ex2.m2.1.1.1.1.1.1.2.cmml"><msup id="S2.Ex2.m2.1.1.1.1.1.1.2.2" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex2.m2.1.1.1.1.1.1.2.2.2" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S2.Ex2.m2.1.1.1.1.1.1.2.2.3" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2.3.cmml">f</mi></msup><mo id="S2.Ex2.m2.1.1.1.1.1.1.2.1" xref="S2.Ex2.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex2.m2.1.1.1.1.1.1.2.3" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex2.m2.1.1.1.1.1.1.2.3.2" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S2.Ex2.m2.1.1.1.1.1.1.2.3.3" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S2.Ex2.m2.1.1.1.1.1.1.1" xref="S2.Ex2.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.Ex2.m2.1.1.1.1.1.1.3" xref="S2.Ex2.m2.1.1.1.1.1.1.3.cmml"><msup id="S2.Ex2.m2.1.1.1.1.1.1.3.2" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex2.m2.1.1.1.1.1.1.3.2.2" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S2.Ex2.m2.1.1.1.1.1.1.3.2.3" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml">f</mi></msup><mo id="S2.Ex2.m2.1.1.1.1.1.1.3.1" xref="S2.Ex2.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex2.m2.1.1.1.1.1.1.3.3" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex2.m2.1.1.1.1.1.1.3.3.2" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.2" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.1" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.1.cmml">-</mo><mn id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.3" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.Ex2.m2.1.1.1.1.1.3" xref="S2.Ex2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m2.1b"><apply id="S2.Ex2.m2.1.1.cmml" xref="S2.Ex2.m2.1.1"><eq id="S2.Ex2.m2.1.1.2.cmml" xref="S2.Ex2.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.Ex2.m2.1.1.3.cmml" xref="S2.Ex2.m2.1.1.3">absent</csymbol><apply id="S2.Ex2.m2.1.1.1.cmml" xref="S2.Ex2.m2.1.1.1"><times id="S2.Ex2.m2.1.1.1.2.cmml" xref="S2.Ex2.m2.1.1.1.2"></times><ci id="S2.Ex2.m2.1.1.1.3.cmml" xref="S2.Ex2.m2.1.1.1.3">𝜎</ci><apply id="S2.Ex2.m2.1.1.1.1.1.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1"><plus id="S2.Ex2.m2.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.1"></plus><apply id="S2.Ex2.m2.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2"><times id="S2.Ex2.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.1"></times><apply id="S2.Ex2.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.Ex2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S2.Ex2.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.2.3">𝑓</ci></apply><apply id="S2.Ex2.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.Ex2.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S2.Ex2.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.Ex2.m2.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3"><times id="S2.Ex2.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.1"></times><apply id="S2.Ex2.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.Ex2.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S2.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.2.3">𝑓</ci></apply><apply id="S2.Ex2.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex2.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex2.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3"><minus id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.Ex2.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m2.1c">\displaystyle=\sigma(W^{f}x_{t}+U^{f}h_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle o_{t}" display="inline"><semantics id="S2.Ex3.m1.1a"><msub id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml"><mi id="S2.Ex3.m1.1.1.2" xref="S2.Ex3.m1.1.1.2.cmml">o</mi><mi id="S2.Ex3.m1.1.1.3" xref="S2.Ex3.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.1b"><apply id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex3.m1.1.1.1.cmml" xref="S2.Ex3.m1.1.1">subscript</csymbol><ci id="S2.Ex3.m1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.2">𝑜</ci><ci id="S2.Ex3.m1.1.1.3.cmml" xref="S2.Ex3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.1c">\displaystyle o_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex3.m2.1" class="ltx_Math" alttext="\displaystyle=\sigma(W^{o}x_{t}+U^{o}h_{t-1})" display="inline"><semantics id="S2.Ex3.m2.1a"><mrow id="S2.Ex3.m2.1.1" xref="S2.Ex3.m2.1.1.cmml"><mi id="S2.Ex3.m2.1.1.3" xref="S2.Ex3.m2.1.1.3.cmml"></mi><mo id="S2.Ex3.m2.1.1.2" xref="S2.Ex3.m2.1.1.2.cmml">=</mo><mrow id="S2.Ex3.m2.1.1.1" xref="S2.Ex3.m2.1.1.1.cmml"><mi id="S2.Ex3.m2.1.1.1.3" xref="S2.Ex3.m2.1.1.1.3.cmml">σ</mi><mo id="S2.Ex3.m2.1.1.1.2" xref="S2.Ex3.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex3.m2.1.1.1.1.1" xref="S2.Ex3.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m2.1.1.1.1.1.2" xref="S2.Ex3.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m2.1.1.1.1.1.1" xref="S2.Ex3.m2.1.1.1.1.1.1.cmml"><mrow id="S2.Ex3.m2.1.1.1.1.1.1.2" xref="S2.Ex3.m2.1.1.1.1.1.1.2.cmml"><msup id="S2.Ex3.m2.1.1.1.1.1.1.2.2" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex3.m2.1.1.1.1.1.1.2.2.2" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S2.Ex3.m2.1.1.1.1.1.1.2.2.3" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2.3.cmml">o</mi></msup><mo id="S2.Ex3.m2.1.1.1.1.1.1.2.1" xref="S2.Ex3.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex3.m2.1.1.1.1.1.1.2.3" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex3.m2.1.1.1.1.1.1.2.3.2" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S2.Ex3.m2.1.1.1.1.1.1.2.3.3" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S2.Ex3.m2.1.1.1.1.1.1.1" xref="S2.Ex3.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.Ex3.m2.1.1.1.1.1.1.3" xref="S2.Ex3.m2.1.1.1.1.1.1.3.cmml"><msup id="S2.Ex3.m2.1.1.1.1.1.1.3.2" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex3.m2.1.1.1.1.1.1.3.2.2" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S2.Ex3.m2.1.1.1.1.1.1.3.2.3" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2.3.cmml">o</mi></msup><mo id="S2.Ex3.m2.1.1.1.1.1.1.3.1" xref="S2.Ex3.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex3.m2.1.1.1.1.1.1.3.3" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex3.m2.1.1.1.1.1.1.3.3.2" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.2" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.1" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.1.cmml">-</mo><mn id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.3" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.Ex3.m2.1.1.1.1.1.3" xref="S2.Ex3.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m2.1b"><apply id="S2.Ex3.m2.1.1.cmml" xref="S2.Ex3.m2.1.1"><eq id="S2.Ex3.m2.1.1.2.cmml" xref="S2.Ex3.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.Ex3.m2.1.1.3.cmml" xref="S2.Ex3.m2.1.1.3">absent</csymbol><apply id="S2.Ex3.m2.1.1.1.cmml" xref="S2.Ex3.m2.1.1.1"><times id="S2.Ex3.m2.1.1.1.2.cmml" xref="S2.Ex3.m2.1.1.1.2"></times><ci id="S2.Ex3.m2.1.1.1.3.cmml" xref="S2.Ex3.m2.1.1.1.3">𝜎</ci><apply id="S2.Ex3.m2.1.1.1.1.1.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1"><plus id="S2.Ex3.m2.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.1"></plus><apply id="S2.Ex3.m2.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2"><times id="S2.Ex3.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.1"></times><apply id="S2.Ex3.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.Ex3.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S2.Ex3.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.2.3">𝑜</ci></apply><apply id="S2.Ex3.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex3.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.Ex3.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S2.Ex3.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.Ex3.m2.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3"><times id="S2.Ex3.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.1"></times><apply id="S2.Ex3.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex3.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.Ex3.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S2.Ex3.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.2.3">𝑜</ci></apply><apply id="S2.Ex3.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex3.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex3.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3"><minus id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.Ex3.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m2.1c">\displaystyle=\sigma(W^{o}x_{t}+U^{o}h_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m2.1d">= italic_σ ( italic_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex4.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{c}_{t}" display="inline"><semantics id="S2.Ex4.m1.1a"><msub id="S2.Ex4.m1.1.1" xref="S2.Ex4.m1.1.1.cmml"><mover accent="true" id="S2.Ex4.m1.1.1.2" xref="S2.Ex4.m1.1.1.2.cmml"><mi id="S2.Ex4.m1.1.1.2.2" xref="S2.Ex4.m1.1.1.2.2.cmml">c</mi><mo stretchy="false" id="S2.Ex4.m1.1.1.2.1" xref="S2.Ex4.m1.1.1.2.1.cmml">~</mo></mover><mi id="S2.Ex4.m1.1.1.3" xref="S2.Ex4.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.1b"><apply id="S2.Ex4.m1.1.1.cmml" xref="S2.Ex4.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex4.m1.1.1.1.cmml" xref="S2.Ex4.m1.1.1">subscript</csymbol><apply id="S2.Ex4.m1.1.1.2.cmml" xref="S2.Ex4.m1.1.1.2"><ci id="S2.Ex4.m1.1.1.2.1.cmml" xref="S2.Ex4.m1.1.1.2.1">~</ci><ci id="S2.Ex4.m1.1.1.2.2.cmml" xref="S2.Ex4.m1.1.1.2.2">𝑐</ci></apply><ci id="S2.Ex4.m1.1.1.3.cmml" xref="S2.Ex4.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.1c">\displaystyle\tilde{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m1.1d">over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex4.m2.1" class="ltx_Math" alttext="\displaystyle=\text{tanh}(W^{c}x_{t}+U^{c}h_{t-1})" display="inline"><semantics id="S2.Ex4.m2.1a"><mrow id="S2.Ex4.m2.1.1" xref="S2.Ex4.m2.1.1.cmml"><mi id="S2.Ex4.m2.1.1.3" xref="S2.Ex4.m2.1.1.3.cmml"></mi><mo id="S2.Ex4.m2.1.1.2" xref="S2.Ex4.m2.1.1.2.cmml">=</mo><mrow id="S2.Ex4.m2.1.1.1" xref="S2.Ex4.m2.1.1.1.cmml"><mtext id="S2.Ex4.m2.1.1.1.3" xref="S2.Ex4.m2.1.1.1.3a.cmml">tanh</mtext><mo id="S2.Ex4.m2.1.1.1.2" xref="S2.Ex4.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex4.m2.1.1.1.1.1" xref="S2.Ex4.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex4.m2.1.1.1.1.1.2" xref="S2.Ex4.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex4.m2.1.1.1.1.1.1" xref="S2.Ex4.m2.1.1.1.1.1.1.cmml"><mrow id="S2.Ex4.m2.1.1.1.1.1.1.2" xref="S2.Ex4.m2.1.1.1.1.1.1.2.cmml"><msup id="S2.Ex4.m2.1.1.1.1.1.1.2.2" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2.cmml"><mi id="S2.Ex4.m2.1.1.1.1.1.1.2.2.2" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S2.Ex4.m2.1.1.1.1.1.1.2.2.3" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2.3.cmml">c</mi></msup><mo id="S2.Ex4.m2.1.1.1.1.1.1.2.1" xref="S2.Ex4.m2.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.Ex4.m2.1.1.1.1.1.1.2.3" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex4.m2.1.1.1.1.1.1.2.3.2" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3.2.cmml">x</mi><mi id="S2.Ex4.m2.1.1.1.1.1.1.2.3.3" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="S2.Ex4.m2.1.1.1.1.1.1.1" xref="S2.Ex4.m2.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.Ex4.m2.1.1.1.1.1.1.3" xref="S2.Ex4.m2.1.1.1.1.1.1.3.cmml"><msup id="S2.Ex4.m2.1.1.1.1.1.1.3.2" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex4.m2.1.1.1.1.1.1.3.2.2" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S2.Ex4.m2.1.1.1.1.1.1.3.2.3" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2.3.cmml">c</mi></msup><mo id="S2.Ex4.m2.1.1.1.1.1.1.3.1" xref="S2.Ex4.m2.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S2.Ex4.m2.1.1.1.1.1.1.3.3" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S2.Ex4.m2.1.1.1.1.1.1.3.3.2" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.2.cmml">h</mi><mrow id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.2" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.1" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.1.cmml">-</mo><mn id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.3" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo stretchy="false" id="S2.Ex4.m2.1.1.1.1.1.3" xref="S2.Ex4.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m2.1b"><apply id="S2.Ex4.m2.1.1.cmml" xref="S2.Ex4.m2.1.1"><eq id="S2.Ex4.m2.1.1.2.cmml" xref="S2.Ex4.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.Ex4.m2.1.1.3.cmml" xref="S2.Ex4.m2.1.1.3">absent</csymbol><apply id="S2.Ex4.m2.1.1.1.cmml" xref="S2.Ex4.m2.1.1.1"><times id="S2.Ex4.m2.1.1.1.2.cmml" xref="S2.Ex4.m2.1.1.1.2"></times><ci id="S2.Ex4.m2.1.1.1.3a.cmml" xref="S2.Ex4.m2.1.1.1.3"><mtext id="S2.Ex4.m2.1.1.1.3.cmml" xref="S2.Ex4.m2.1.1.1.3">tanh</mtext></ci><apply id="S2.Ex4.m2.1.1.1.1.1.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1"><plus id="S2.Ex4.m2.1.1.1.1.1.1.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.1"></plus><apply id="S2.Ex4.m2.1.1.1.1.1.1.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2"><times id="S2.Ex4.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.1"></times><apply id="S2.Ex4.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex4.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S2.Ex4.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S2.Ex4.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.2.3">𝑐</ci></apply><apply id="S2.Ex4.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.Ex4.m2.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.Ex4.m2.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3.2">𝑥</ci><ci id="S2.Ex4.m2.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S2.Ex4.m2.1.1.1.1.1.1.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3"><times id="S2.Ex4.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.1"></times><apply id="S2.Ex4.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex4.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.Ex4.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S2.Ex4.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.2.3">𝑐</ci></apply><apply id="S2.Ex4.m2.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex4.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex4.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.2">ℎ</ci><apply id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3"><minus id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.1"></minus><ci id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.Ex4.m2.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m2.1c">\displaystyle=\text{tanh}(W^{c}x_{t}+U^{c}h_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m2.1d">= tanh ( italic_W start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_U start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle c_{t}" display="inline"><semantics id="S2.Ex5.m1.1a"><msub id="S2.Ex5.m1.1.1" xref="S2.Ex5.m1.1.1.cmml"><mi id="S2.Ex5.m1.1.1.2" xref="S2.Ex5.m1.1.1.2.cmml">c</mi><mi id="S2.Ex5.m1.1.1.3" xref="S2.Ex5.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.1b"><apply id="S2.Ex5.m1.1.1.cmml" xref="S2.Ex5.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex5.m1.1.1.1.cmml" xref="S2.Ex5.m1.1.1">subscript</csymbol><ci id="S2.Ex5.m1.1.1.2.cmml" xref="S2.Ex5.m1.1.1.2">𝑐</ci><ci id="S2.Ex5.m1.1.1.3.cmml" xref="S2.Ex5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.1c">\displaystyle c_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m1.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex5.m2.1" class="ltx_Math" alttext="\displaystyle=i_{t}\odot\tilde{c}_{t}+f_{t}\odot+\tilde{c}_{t-1}" display="inline"><semantics id="S2.Ex5.m2.1a"><mrow id="S2.Ex5.m2.1b"><mo id="S2.Ex5.m2.1.1" xref="S2.Ex5.m2.1.1.cmml">=</mo><msub id="S2.Ex5.m2.1.2" xref="S2.Ex5.m2.1.2.cmml"><mi id="S2.Ex5.m2.1.2.2" xref="S2.Ex5.m2.1.2.2.cmml">i</mi><mi id="S2.Ex5.m2.1.2.3" xref="S2.Ex5.m2.1.2.3.cmml">t</mi></msub><mo id="S2.Ex5.m2.1.3" xref="S2.Ex5.m2.1.3.cmml">⊙</mo><msub id="S2.Ex5.m2.1.4" xref="S2.Ex5.m2.1.4.cmml"><mover accent="true" id="S2.Ex5.m2.1.4.2" xref="S2.Ex5.m2.1.4.2.cmml"><mi id="S2.Ex5.m2.1.4.2.2" xref="S2.Ex5.m2.1.4.2.2.cmml">c</mi><mo stretchy="false" id="S2.Ex5.m2.1.4.2.1" xref="S2.Ex5.m2.1.4.2.1.cmml">~</mo></mover><mi id="S2.Ex5.m2.1.4.3" xref="S2.Ex5.m2.1.4.3.cmml">t</mi></msub><mo id="S2.Ex5.m2.1.5" xref="S2.Ex5.m2.1.5.cmml">+</mo><msub id="S2.Ex5.m2.1.6" xref="S2.Ex5.m2.1.6.cmml"><mi id="S2.Ex5.m2.1.6.2" xref="S2.Ex5.m2.1.6.2.cmml">f</mi><mi id="S2.Ex5.m2.1.6.3" xref="S2.Ex5.m2.1.6.3.cmml">t</mi></msub><mo id="S2.Ex5.m2.1.7" xref="S2.Ex5.m2.1.7.cmml">⊙</mo><mo id="S2.Ex5.m2.1.8" xref="S2.Ex5.m2.1.8.cmml">+</mo><msub id="S2.Ex5.m2.1.9" xref="S2.Ex5.m2.1.9.cmml"><mover accent="true" id="S2.Ex5.m2.1.9.2" xref="S2.Ex5.m2.1.9.2.cmml"><mi id="S2.Ex5.m2.1.9.2.2" xref="S2.Ex5.m2.1.9.2.2.cmml">c</mi><mo stretchy="false" id="S2.Ex5.m2.1.9.2.1" xref="S2.Ex5.m2.1.9.2.1.cmml">~</mo></mover><mrow id="S2.Ex5.m2.1.9.3" xref="S2.Ex5.m2.1.9.3.cmml"><mi id="S2.Ex5.m2.1.9.3.2" xref="S2.Ex5.m2.1.9.3.2.cmml">t</mi><mo id="S2.Ex5.m2.1.9.3.1" xref="S2.Ex5.m2.1.9.3.1.cmml">-</mo><mn id="S2.Ex5.m2.1.9.3.3" xref="S2.Ex5.m2.1.9.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m2.1c"><cerror id="S2.Ex5.m2.1d"><csymbol cd="ambiguous" id="S2.Ex5.m2.1e">fragments</csymbol><eq id="S2.Ex5.m2.1.1.cmml" xref="S2.Ex5.m2.1.1"></eq><apply id="S2.Ex5.m2.1.2.cmml" xref="S2.Ex5.m2.1.2"><csymbol cd="ambiguous" id="S2.Ex5.m2.1.2.1.cmml" xref="S2.Ex5.m2.1.2">subscript</csymbol><ci id="S2.Ex5.m2.1.2.2.cmml" xref="S2.Ex5.m2.1.2.2">𝑖</ci><ci id="S2.Ex5.m2.1.2.3.cmml" xref="S2.Ex5.m2.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="S2.Ex5.m2.1.3.cmml" xref="S2.Ex5.m2.1.3">direct-product</csymbol><apply id="S2.Ex5.m2.1.4.cmml" xref="S2.Ex5.m2.1.4"><csymbol cd="ambiguous" id="S2.Ex5.m2.1.4.1.cmml" xref="S2.Ex5.m2.1.4">subscript</csymbol><apply id="S2.Ex5.m2.1.4.2.cmml" xref="S2.Ex5.m2.1.4.2"><ci id="S2.Ex5.m2.1.4.2.1.cmml" xref="S2.Ex5.m2.1.4.2.1">~</ci><ci id="S2.Ex5.m2.1.4.2.2.cmml" xref="S2.Ex5.m2.1.4.2.2">𝑐</ci></apply><ci id="S2.Ex5.m2.1.4.3.cmml" xref="S2.Ex5.m2.1.4.3">𝑡</ci></apply><plus id="S2.Ex5.m2.1.5.cmml" xref="S2.Ex5.m2.1.5"></plus><apply id="S2.Ex5.m2.1.6.cmml" xref="S2.Ex5.m2.1.6"><csymbol cd="ambiguous" id="S2.Ex5.m2.1.6.1.cmml" xref="S2.Ex5.m2.1.6">subscript</csymbol><ci id="S2.Ex5.m2.1.6.2.cmml" xref="S2.Ex5.m2.1.6.2">𝑓</ci><ci id="S2.Ex5.m2.1.6.3.cmml" xref="S2.Ex5.m2.1.6.3">𝑡</ci></apply><csymbol cd="latexml" id="S2.Ex5.m2.1.7.cmml" xref="S2.Ex5.m2.1.7">direct-product</csymbol><plus id="S2.Ex5.m2.1.8.cmml" xref="S2.Ex5.m2.1.8"></plus><apply id="S2.Ex5.m2.1.9.cmml" xref="S2.Ex5.m2.1.9"><csymbol cd="ambiguous" id="S2.Ex5.m2.1.9.1.cmml" xref="S2.Ex5.m2.1.9">subscript</csymbol><apply id="S2.Ex5.m2.1.9.2.cmml" xref="S2.Ex5.m2.1.9.2"><ci id="S2.Ex5.m2.1.9.2.1.cmml" xref="S2.Ex5.m2.1.9.2.1">~</ci><ci id="S2.Ex5.m2.1.9.2.2.cmml" xref="S2.Ex5.m2.1.9.2.2">𝑐</ci></apply><apply id="S2.Ex5.m2.1.9.3.cmml" xref="S2.Ex5.m2.1.9.3"><minus id="S2.Ex5.m2.1.9.3.1.cmml" xref="S2.Ex5.m2.1.9.3.1"></minus><ci id="S2.Ex5.m2.1.9.3.2.cmml" xref="S2.Ex5.m2.1.9.3.2">𝑡</ci><cn type="integer" id="S2.Ex5.m2.1.9.3.3.cmml" xref="S2.Ex5.m2.1.9.3.3">1</cn></apply></apply></cerror></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m2.1f">\displaystyle=i_{t}\odot\tilde{c}_{t}+f_{t}\odot+\tilde{c}_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m2.1g">= italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ + over~ start_ARG italic_c end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex6.m1.1" class="ltx_Math" alttext="\displaystyle h_{t}" display="inline"><semantics id="S2.Ex6.m1.1a"><msub id="S2.Ex6.m1.1.1" xref="S2.Ex6.m1.1.1.cmml"><mi id="S2.Ex6.m1.1.1.2" xref="S2.Ex6.m1.1.1.2.cmml">h</mi><mi id="S2.Ex6.m1.1.1.3" xref="S2.Ex6.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex6.m1.1b"><apply id="S2.Ex6.m1.1.1.cmml" xref="S2.Ex6.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex6.m1.1.1.1.cmml" xref="S2.Ex6.m1.1.1">subscript</csymbol><ci id="S2.Ex6.m1.1.1.2.cmml" xref="S2.Ex6.m1.1.1.2">ℎ</ci><ci id="S2.Ex6.m1.1.1.3.cmml" xref="S2.Ex6.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6.m1.1c">\displaystyle h_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex6.m2.1" class="ltx_Math" alttext="\displaystyle=o_{t}\odot\text{tanh}(c_{t})" display="inline"><semantics id="S2.Ex6.m2.1a"><mrow id="S2.Ex6.m2.1.1" xref="S2.Ex6.m2.1.1.cmml"><mi id="S2.Ex6.m2.1.1.3" xref="S2.Ex6.m2.1.1.3.cmml"></mi><mo id="S2.Ex6.m2.1.1.2" xref="S2.Ex6.m2.1.1.2.cmml">=</mo><mrow id="S2.Ex6.m2.1.1.1" xref="S2.Ex6.m2.1.1.1.cmml"><mrow id="S2.Ex6.m2.1.1.1.3" xref="S2.Ex6.m2.1.1.1.3.cmml"><msub id="S2.Ex6.m2.1.1.1.3.2" xref="S2.Ex6.m2.1.1.1.3.2.cmml"><mi id="S2.Ex6.m2.1.1.1.3.2.2" xref="S2.Ex6.m2.1.1.1.3.2.2.cmml">o</mi><mi id="S2.Ex6.m2.1.1.1.3.2.3" xref="S2.Ex6.m2.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S2.Ex6.m2.1.1.1.3.1" xref="S2.Ex6.m2.1.1.1.3.1.cmml">⊙</mo><mtext id="S2.Ex6.m2.1.1.1.3.3" xref="S2.Ex6.m2.1.1.1.3.3a.cmml">tanh</mtext></mrow><mo id="S2.Ex6.m2.1.1.1.2" xref="S2.Ex6.m2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex6.m2.1.1.1.1.1" xref="S2.Ex6.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex6.m2.1.1.1.1.1.2" xref="S2.Ex6.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex6.m2.1.1.1.1.1.1" xref="S2.Ex6.m2.1.1.1.1.1.1.cmml"><mi id="S2.Ex6.m2.1.1.1.1.1.1.2" xref="S2.Ex6.m2.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.Ex6.m2.1.1.1.1.1.1.3" xref="S2.Ex6.m2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S2.Ex6.m2.1.1.1.1.1.3" xref="S2.Ex6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex6.m2.1b"><apply id="S2.Ex6.m2.1.1.cmml" xref="S2.Ex6.m2.1.1"><eq id="S2.Ex6.m2.1.1.2.cmml" xref="S2.Ex6.m2.1.1.2"></eq><csymbol cd="latexml" id="S2.Ex6.m2.1.1.3.cmml" xref="S2.Ex6.m2.1.1.3">absent</csymbol><apply id="S2.Ex6.m2.1.1.1.cmml" xref="S2.Ex6.m2.1.1.1"><times id="S2.Ex6.m2.1.1.1.2.cmml" xref="S2.Ex6.m2.1.1.1.2"></times><apply id="S2.Ex6.m2.1.1.1.3.cmml" xref="S2.Ex6.m2.1.1.1.3"><csymbol cd="latexml" id="S2.Ex6.m2.1.1.1.3.1.cmml" xref="S2.Ex6.m2.1.1.1.3.1">direct-product</csymbol><apply id="S2.Ex6.m2.1.1.1.3.2.cmml" xref="S2.Ex6.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex6.m2.1.1.1.3.2.1.cmml" xref="S2.Ex6.m2.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex6.m2.1.1.1.3.2.2.cmml" xref="S2.Ex6.m2.1.1.1.3.2.2">𝑜</ci><ci id="S2.Ex6.m2.1.1.1.3.2.3.cmml" xref="S2.Ex6.m2.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.Ex6.m2.1.1.1.3.3a.cmml" xref="S2.Ex6.m2.1.1.1.3.3"><mtext id="S2.Ex6.m2.1.1.1.3.3.cmml" xref="S2.Ex6.m2.1.1.1.3.3">tanh</mtext></ci></apply><apply id="S2.Ex6.m2.1.1.1.1.1.1.cmml" xref="S2.Ex6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex6.m2.1.1.1.1.1.1.1.cmml" xref="S2.Ex6.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex6.m2.1.1.1.1.1.1.2.cmml" xref="S2.Ex6.m2.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.Ex6.m2.1.1.1.1.1.1.3.cmml" xref="S2.Ex6.m2.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex6.m2.1c">\displaystyle=o_{t}\odot\text{tanh}(c_{t})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex6.m2.1d">= italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ tanh ( italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.6" class="ltx_p">where <math id="S2.p2.1.m1.6" class="ltx_Math" alttext="[W^{i},W^{f},W^{o},U^{i},U^{f},U^{o}]" display="inline"><semantics id="S2.p2.1.m1.6a"><mrow id="S2.p2.1.m1.6.6.6" xref="S2.p2.1.m1.6.6.7.cmml"><mo stretchy="false" id="S2.p2.1.m1.6.6.6.7" xref="S2.p2.1.m1.6.6.7.cmml">[</mo><msup id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.2.cmml">W</mi><mi id="S2.p2.1.m1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.3.cmml">i</mi></msup><mo id="S2.p2.1.m1.6.6.6.8" xref="S2.p2.1.m1.6.6.7.cmml">,</mo><msup id="S2.p2.1.m1.2.2.2.2" xref="S2.p2.1.m1.2.2.2.2.cmml"><mi id="S2.p2.1.m1.2.2.2.2.2" xref="S2.p2.1.m1.2.2.2.2.2.cmml">W</mi><mi id="S2.p2.1.m1.2.2.2.2.3" xref="S2.p2.1.m1.2.2.2.2.3.cmml">f</mi></msup><mo id="S2.p2.1.m1.6.6.6.9" xref="S2.p2.1.m1.6.6.7.cmml">,</mo><msup id="S2.p2.1.m1.3.3.3.3" xref="S2.p2.1.m1.3.3.3.3.cmml"><mi id="S2.p2.1.m1.3.3.3.3.2" xref="S2.p2.1.m1.3.3.3.3.2.cmml">W</mi><mi id="S2.p2.1.m1.3.3.3.3.3" xref="S2.p2.1.m1.3.3.3.3.3.cmml">o</mi></msup><mo id="S2.p2.1.m1.6.6.6.10" xref="S2.p2.1.m1.6.6.7.cmml">,</mo><msup id="S2.p2.1.m1.4.4.4.4" xref="S2.p2.1.m1.4.4.4.4.cmml"><mi id="S2.p2.1.m1.4.4.4.4.2" xref="S2.p2.1.m1.4.4.4.4.2.cmml">U</mi><mi id="S2.p2.1.m1.4.4.4.4.3" xref="S2.p2.1.m1.4.4.4.4.3.cmml">i</mi></msup><mo id="S2.p2.1.m1.6.6.6.11" xref="S2.p2.1.m1.6.6.7.cmml">,</mo><msup id="S2.p2.1.m1.5.5.5.5" xref="S2.p2.1.m1.5.5.5.5.cmml"><mi id="S2.p2.1.m1.5.5.5.5.2" xref="S2.p2.1.m1.5.5.5.5.2.cmml">U</mi><mi id="S2.p2.1.m1.5.5.5.5.3" xref="S2.p2.1.m1.5.5.5.5.3.cmml">f</mi></msup><mo id="S2.p2.1.m1.6.6.6.12" xref="S2.p2.1.m1.6.6.7.cmml">,</mo><msup id="S2.p2.1.m1.6.6.6.6" xref="S2.p2.1.m1.6.6.6.6.cmml"><mi id="S2.p2.1.m1.6.6.6.6.2" xref="S2.p2.1.m1.6.6.6.6.2.cmml">U</mi><mi id="S2.p2.1.m1.6.6.6.6.3" xref="S2.p2.1.m1.6.6.6.6.3.cmml">o</mi></msup><mo stretchy="false" id="S2.p2.1.m1.6.6.6.13" xref="S2.p2.1.m1.6.6.7.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.6b"><list id="S2.p2.1.m1.6.6.7.cmml" xref="S2.p2.1.m1.6.6.6"><apply id="S2.p2.1.m1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.p2.1.m1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.2">𝑊</ci><ci id="S2.p2.1.m1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p2.1.m1.2.2.2.2.cmml" xref="S2.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.2.2.2.2.1.cmml" xref="S2.p2.1.m1.2.2.2.2">superscript</csymbol><ci id="S2.p2.1.m1.2.2.2.2.2.cmml" xref="S2.p2.1.m1.2.2.2.2.2">𝑊</ci><ci id="S2.p2.1.m1.2.2.2.2.3.cmml" xref="S2.p2.1.m1.2.2.2.2.3">𝑓</ci></apply><apply id="S2.p2.1.m1.3.3.3.3.cmml" xref="S2.p2.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.3.3.3.3.1.cmml" xref="S2.p2.1.m1.3.3.3.3">superscript</csymbol><ci id="S2.p2.1.m1.3.3.3.3.2.cmml" xref="S2.p2.1.m1.3.3.3.3.2">𝑊</ci><ci id="S2.p2.1.m1.3.3.3.3.3.cmml" xref="S2.p2.1.m1.3.3.3.3.3">𝑜</ci></apply><apply id="S2.p2.1.m1.4.4.4.4.cmml" xref="S2.p2.1.m1.4.4.4.4"><csymbol cd="ambiguous" id="S2.p2.1.m1.4.4.4.4.1.cmml" xref="S2.p2.1.m1.4.4.4.4">superscript</csymbol><ci id="S2.p2.1.m1.4.4.4.4.2.cmml" xref="S2.p2.1.m1.4.4.4.4.2">𝑈</ci><ci id="S2.p2.1.m1.4.4.4.4.3.cmml" xref="S2.p2.1.m1.4.4.4.4.3">𝑖</ci></apply><apply id="S2.p2.1.m1.5.5.5.5.cmml" xref="S2.p2.1.m1.5.5.5.5"><csymbol cd="ambiguous" id="S2.p2.1.m1.5.5.5.5.1.cmml" xref="S2.p2.1.m1.5.5.5.5">superscript</csymbol><ci id="S2.p2.1.m1.5.5.5.5.2.cmml" xref="S2.p2.1.m1.5.5.5.5.2">𝑈</ci><ci id="S2.p2.1.m1.5.5.5.5.3.cmml" xref="S2.p2.1.m1.5.5.5.5.3">𝑓</ci></apply><apply id="S2.p2.1.m1.6.6.6.6.cmml" xref="S2.p2.1.m1.6.6.6.6"><csymbol cd="ambiguous" id="S2.p2.1.m1.6.6.6.6.1.cmml" xref="S2.p2.1.m1.6.6.6.6">superscript</csymbol><ci id="S2.p2.1.m1.6.6.6.6.2.cmml" xref="S2.p2.1.m1.6.6.6.6.2">𝑈</ci><ci id="S2.p2.1.m1.6.6.6.6.3.cmml" xref="S2.p2.1.m1.6.6.6.6.3">𝑜</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.6c">[W^{i},W^{f},W^{o},U^{i},U^{f},U^{o}]</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.6d">[ italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT , italic_U start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_U start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , italic_U start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ]</annotation></semantics></math> are weight matrices, <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">x</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑥</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the vector input to the timestep <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_t</annotation></semantics></math>, <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S2.p2.4.m4.1a"><msub id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">h</mi><mi id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">ℎ</ci><ci id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the current exposed hidden state, <math id="S2.p2.5.m5.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.p2.5.m5.1a"><msub id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">c</mi><mi id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝑐</ci><ci id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the memory cell state, and <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S2.p2.6.m6.1a"><mo id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><csymbol cd="latexml" id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.1d">⊙</annotation></semantics></math> is element-wise multiplication.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.2" class="ltx_p">Preventing overfitting within the recurrent connections of an RNN has been an area of extensive research in language modeling.
The majority of previous recurrent regularization techniques have acted on the hidden state vector <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="h_{t-1}" display="inline"><semantics id="S2.p3.1.m1.1a"><msub id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">h</mi><mrow id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml"><mi id="S2.p3.1.m1.1.1.3.2" xref="S2.p3.1.m1.1.1.3.2.cmml">t</mi><mo id="S2.p3.1.m1.1.1.3.1" xref="S2.p3.1.m1.1.1.3.1.cmml">-</mo><mn id="S2.p3.1.m1.1.1.3.3" xref="S2.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.1.1.1.cmml" xref="S2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2">ℎ</ci><apply id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3"><minus id="S2.p3.1.m1.1.1.3.1.cmml" xref="S2.p3.1.m1.1.1.3.1"></minus><ci id="S2.p3.1.m1.1.1.3.2.cmml" xref="S2.p3.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S2.p3.1.m1.1.1.3.3.cmml" xref="S2.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">h_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, most frequently introducing a dropout operation between timesteps, or performing dropout on the update to the memory state <math id="S2.p3.2.m2.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S2.p3.2.m2.1a"><msub id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">c</mi><mi id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1">subscript</csymbol><ci id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">𝑐</ci><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">c_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
These modifications to a standard LSTM prevent the use of black box RNN implementations that may be many times faster due to low-level hardware-specific optimizations.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">We propose the use of DropConnect <cite class="ltx_cite ltx_citemacro_citep">(Wan et al., <a href="#bib.bib39" title="" class="ltx_ref">2013</a>)</cite> on the recurrent hidden to hidden weight matrices which does not require any modifications to an RNN’s formulation.
As the dropout operation is applied once to the weight matrices, before the forward and backward pass, the impact on training speed is minimal and any standard RNN implementation can be used, including inflexible but highly optimized black box LSTM implementations such as NVIDIA’s cuDNN LSTM.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">By performing DropConnect on the hidden-to-hidden weight matrices <math id="S2.p5.1.m1.4" class="ltx_Math" alttext="[U^{i},U^{f},U^{o},U^{c}]" display="inline"><semantics id="S2.p5.1.m1.4a"><mrow id="S2.p5.1.m1.4.4.4" xref="S2.p5.1.m1.4.4.5.cmml"><mo stretchy="false" id="S2.p5.1.m1.4.4.4.5" xref="S2.p5.1.m1.4.4.5.cmml">[</mo><msup id="S2.p5.1.m1.1.1.1.1" xref="S2.p5.1.m1.1.1.1.1.cmml"><mi id="S2.p5.1.m1.1.1.1.1.2" xref="S2.p5.1.m1.1.1.1.1.2.cmml">U</mi><mi id="S2.p5.1.m1.1.1.1.1.3" xref="S2.p5.1.m1.1.1.1.1.3.cmml">i</mi></msup><mo id="S2.p5.1.m1.4.4.4.6" xref="S2.p5.1.m1.4.4.5.cmml">,</mo><msup id="S2.p5.1.m1.2.2.2.2" xref="S2.p5.1.m1.2.2.2.2.cmml"><mi id="S2.p5.1.m1.2.2.2.2.2" xref="S2.p5.1.m1.2.2.2.2.2.cmml">U</mi><mi id="S2.p5.1.m1.2.2.2.2.3" xref="S2.p5.1.m1.2.2.2.2.3.cmml">f</mi></msup><mo id="S2.p5.1.m1.4.4.4.7" xref="S2.p5.1.m1.4.4.5.cmml">,</mo><msup id="S2.p5.1.m1.3.3.3.3" xref="S2.p5.1.m1.3.3.3.3.cmml"><mi id="S2.p5.1.m1.3.3.3.3.2" xref="S2.p5.1.m1.3.3.3.3.2.cmml">U</mi><mi id="S2.p5.1.m1.3.3.3.3.3" xref="S2.p5.1.m1.3.3.3.3.3.cmml">o</mi></msup><mo id="S2.p5.1.m1.4.4.4.8" xref="S2.p5.1.m1.4.4.5.cmml">,</mo><msup id="S2.p5.1.m1.4.4.4.4" xref="S2.p5.1.m1.4.4.4.4.cmml"><mi id="S2.p5.1.m1.4.4.4.4.2" xref="S2.p5.1.m1.4.4.4.4.2.cmml">U</mi><mi id="S2.p5.1.m1.4.4.4.4.3" xref="S2.p5.1.m1.4.4.4.4.3.cmml">c</mi></msup><mo stretchy="false" id="S2.p5.1.m1.4.4.4.9" xref="S2.p5.1.m1.4.4.5.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.4b"><list id="S2.p5.1.m1.4.4.5.cmml" xref="S2.p5.1.m1.4.4.4"><apply id="S2.p5.1.m1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.1.1.1.1.cmml" xref="S2.p5.1.m1.1.1.1.1">superscript</csymbol><ci id="S2.p5.1.m1.1.1.1.1.2.cmml" xref="S2.p5.1.m1.1.1.1.1.2">𝑈</ci><ci id="S2.p5.1.m1.1.1.1.1.3.cmml" xref="S2.p5.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p5.1.m1.2.2.2.2.cmml" xref="S2.p5.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.p5.1.m1.2.2.2.2.1.cmml" xref="S2.p5.1.m1.2.2.2.2">superscript</csymbol><ci id="S2.p5.1.m1.2.2.2.2.2.cmml" xref="S2.p5.1.m1.2.2.2.2.2">𝑈</ci><ci id="S2.p5.1.m1.2.2.2.2.3.cmml" xref="S2.p5.1.m1.2.2.2.2.3">𝑓</ci></apply><apply id="S2.p5.1.m1.3.3.3.3.cmml" xref="S2.p5.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S2.p5.1.m1.3.3.3.3.1.cmml" xref="S2.p5.1.m1.3.3.3.3">superscript</csymbol><ci id="S2.p5.1.m1.3.3.3.3.2.cmml" xref="S2.p5.1.m1.3.3.3.3.2">𝑈</ci><ci id="S2.p5.1.m1.3.3.3.3.3.cmml" xref="S2.p5.1.m1.3.3.3.3.3">𝑜</ci></apply><apply id="S2.p5.1.m1.4.4.4.4.cmml" xref="S2.p5.1.m1.4.4.4.4"><csymbol cd="ambiguous" id="S2.p5.1.m1.4.4.4.4.1.cmml" xref="S2.p5.1.m1.4.4.4.4">superscript</csymbol><ci id="S2.p5.1.m1.4.4.4.4.2.cmml" xref="S2.p5.1.m1.4.4.4.4.2">𝑈</ci><ci id="S2.p5.1.m1.4.4.4.4.3.cmml" xref="S2.p5.1.m1.4.4.4.4.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.4c">[U^{i},U^{f},U^{o},U^{c}]</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.4d">[ italic_U start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_U start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , italic_U start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT , italic_U start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ]</annotation></semantics></math> within the LSTM, we can prevent overfitting from occurring on the recurrent connections of the LSTM.
This regularization technique would also be applicable to preventing overfitting on the recurrent weight matrices of other RNN cells.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.2" class="ltx_p">As the same weights are reused over multiple timesteps, the same individual dropped weights remain dropped for the entirety of the forward and backward pass.
The result is similar to variational dropout, which applies the same dropout mask to recurrent connections within the LSTM by performing dropout on <math id="S2.p6.1.m1.1" class="ltx_Math" alttext="h_{t-1}" display="inline"><semantics id="S2.p6.1.m1.1a"><msub id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml"><mi id="S2.p6.1.m1.1.1.2" xref="S2.p6.1.m1.1.1.2.cmml">h</mi><mrow id="S2.p6.1.m1.1.1.3" xref="S2.p6.1.m1.1.1.3.cmml"><mi id="S2.p6.1.m1.1.1.3.2" xref="S2.p6.1.m1.1.1.3.2.cmml">t</mi><mo id="S2.p6.1.m1.1.1.3.1" xref="S2.p6.1.m1.1.1.3.1.cmml">-</mo><mn id="S2.p6.1.m1.1.1.3.3" xref="S2.p6.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.1.cmml" xref="S2.p6.1.m1.1.1">subscript</csymbol><ci id="S2.p6.1.m1.1.1.2.cmml" xref="S2.p6.1.m1.1.1.2">ℎ</ci><apply id="S2.p6.1.m1.1.1.3.cmml" xref="S2.p6.1.m1.1.1.3"><minus id="S2.p6.1.m1.1.1.3.1.cmml" xref="S2.p6.1.m1.1.1.3.1"></minus><ci id="S2.p6.1.m1.1.1.3.2.cmml" xref="S2.p6.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S2.p6.1.m1.1.1.3.3.cmml" xref="S2.p6.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">h_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>, except that the dropout is applied to the recurrent weights.
DropConnect could also be used on the non-recurrent weights of the LSTM <math id="S2.p6.2.m2.3" class="ltx_Math" alttext="[W^{i},W^{f},W^{o}]" display="inline"><semantics id="S2.p6.2.m2.3a"><mrow id="S2.p6.2.m2.3.3.3" xref="S2.p6.2.m2.3.3.4.cmml"><mo stretchy="false" id="S2.p6.2.m2.3.3.3.4" xref="S2.p6.2.m2.3.3.4.cmml">[</mo><msup id="S2.p6.2.m2.1.1.1.1" xref="S2.p6.2.m2.1.1.1.1.cmml"><mi id="S2.p6.2.m2.1.1.1.1.2" xref="S2.p6.2.m2.1.1.1.1.2.cmml">W</mi><mi id="S2.p6.2.m2.1.1.1.1.3" xref="S2.p6.2.m2.1.1.1.1.3.cmml">i</mi></msup><mo id="S2.p6.2.m2.3.3.3.5" xref="S2.p6.2.m2.3.3.4.cmml">,</mo><msup id="S2.p6.2.m2.2.2.2.2" xref="S2.p6.2.m2.2.2.2.2.cmml"><mi id="S2.p6.2.m2.2.2.2.2.2" xref="S2.p6.2.m2.2.2.2.2.2.cmml">W</mi><mi id="S2.p6.2.m2.2.2.2.2.3" xref="S2.p6.2.m2.2.2.2.2.3.cmml">f</mi></msup><mo id="S2.p6.2.m2.3.3.3.6" xref="S2.p6.2.m2.3.3.4.cmml">,</mo><msup id="S2.p6.2.m2.3.3.3.3" xref="S2.p6.2.m2.3.3.3.3.cmml"><mi id="S2.p6.2.m2.3.3.3.3.2" xref="S2.p6.2.m2.3.3.3.3.2.cmml">W</mi><mi id="S2.p6.2.m2.3.3.3.3.3" xref="S2.p6.2.m2.3.3.3.3.3.cmml">o</mi></msup><mo stretchy="false" id="S2.p6.2.m2.3.3.3.7" xref="S2.p6.2.m2.3.3.4.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.3b"><list id="S2.p6.2.m2.3.3.4.cmml" xref="S2.p6.2.m2.3.3.3"><apply id="S2.p6.2.m2.1.1.1.1.cmml" xref="S2.p6.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.p6.2.m2.1.1.1.1.1.cmml" xref="S2.p6.2.m2.1.1.1.1">superscript</csymbol><ci id="S2.p6.2.m2.1.1.1.1.2.cmml" xref="S2.p6.2.m2.1.1.1.1.2">𝑊</ci><ci id="S2.p6.2.m2.1.1.1.1.3.cmml" xref="S2.p6.2.m2.1.1.1.1.3">𝑖</ci></apply><apply id="S2.p6.2.m2.2.2.2.2.cmml" xref="S2.p6.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p6.2.m2.2.2.2.2.1.cmml" xref="S2.p6.2.m2.2.2.2.2">superscript</csymbol><ci id="S2.p6.2.m2.2.2.2.2.2.cmml" xref="S2.p6.2.m2.2.2.2.2.2">𝑊</ci><ci id="S2.p6.2.m2.2.2.2.2.3.cmml" xref="S2.p6.2.m2.2.2.2.2.3">𝑓</ci></apply><apply id="S2.p6.2.m2.3.3.3.3.cmml" xref="S2.p6.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S2.p6.2.m2.3.3.3.3.1.cmml" xref="S2.p6.2.m2.3.3.3.3">superscript</csymbol><ci id="S2.p6.2.m2.3.3.3.3.2.cmml" xref="S2.p6.2.m2.3.3.3.3.2">𝑊</ci><ci id="S2.p6.2.m2.3.3.3.3.3.cmml" xref="S2.p6.2.m2.3.3.3.3.3">𝑜</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.3c">[W^{i},W^{f},W^{o}]</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m2.3d">[ italic_W start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT , italic_W start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ]</annotation></semantics></math> though our focus was on preventing overfitting on the recurrent connection.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Optimization</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.6" class="ltx_p">SGD is among the most popular methods for training deep learning models across various modalities including computer vision, natural language processing, and reinforcement learning. The training of deep networks can be posed as a non-convex optimization problem</p>
<table id="S9.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex7.m1.2" class="ltx_Math" alttext="\displaystyle\min_{w}\quad\frac{1}{N}\sum_{i=1}^{N}f_{i}(w)," display="inline"><semantics id="S3.Ex7.m1.2a"><mrow id="S3.Ex7.m1.2.2.1"><mrow id="S3.Ex7.m1.2.2.1.1.2" xref="S3.Ex7.m1.2.2.1.1.3.cmml"><munder id="S3.Ex7.m1.2.2.1.1.1.1" xref="S3.Ex7.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex7.m1.2.2.1.1.1.1.2" xref="S3.Ex7.m1.2.2.1.1.1.1.2.cmml">min</mi><mi id="S3.Ex7.m1.2.2.1.1.1.1.3" xref="S3.Ex7.m1.2.2.1.1.1.1.3.cmml">w</mi></munder><mo mathvariant="italic" separator="true" id="S3.Ex7.m1.2.2.1.1.2.3" xref="S3.Ex7.m1.2.2.1.1.3.cmml"> </mo><mrow id="S3.Ex7.m1.2.2.1.1.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.Ex7.m1.2.2.1.1.2.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.2.cmml"><mfrac id="S3.Ex7.m1.2.2.1.1.2.2.2a" xref="S3.Ex7.m1.2.2.1.1.2.2.2.cmml"><mn id="S3.Ex7.m1.2.2.1.1.2.2.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.2.2.cmml">1</mn><mi id="S3.Ex7.m1.2.2.1.1.2.2.2.3" xref="S3.Ex7.m1.2.2.1.1.2.2.2.3.cmml">N</mi></mfrac></mstyle><mo id="S3.Ex7.m1.2.2.1.1.2.2.1" xref="S3.Ex7.m1.2.2.1.1.2.2.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.2.2.1.1.2.2.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.cmml"><mstyle displaystyle="true" id="S3.Ex7.m1.2.2.1.1.2.2.3.1" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.cmml"><munderover id="S3.Ex7.m1.2.2.1.1.2.2.3.1a" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.cmml"><mi id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.1" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex7.m1.2.2.1.1.2.2.3.1.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="S3.Ex7.m1.2.2.1.1.2.2.3.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml"><msub id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.cmml"><mi id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.2.cmml">f</mi><mi id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.3" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.3.cmml">i</mi></msub><mo id="S3.Ex7.m1.2.2.1.1.2.2.3.2.1" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.2.2.1.1.2.2.3.2.3.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml"><mo stretchy="false" id="S3.Ex7.m1.2.2.1.1.2.2.3.2.3.2.1" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml">(</mo><mi id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.Ex7.m1.2.2.1.1.2.2.3.2.3.2.2" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex7.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.2b"><list id="S3.Ex7.m1.2.2.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2"><apply id="S3.Ex7.m1.2.2.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1">subscript</csymbol><min id="S3.Ex7.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.2"></min><ci id="S3.Ex7.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.1.1.3">𝑤</ci></apply><apply id="S3.Ex7.m1.2.2.1.1.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2"><times id="S3.Ex7.m1.2.2.1.1.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.1"></times><apply id="S3.Ex7.m1.2.2.1.1.2.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.2"><divide id="S3.Ex7.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.2"></divide><cn type="integer" id="S3.Ex7.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.2.2">1</cn><ci id="S3.Ex7.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.2.3">𝑁</ci></apply><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3"><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.2.2.3.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1">superscript</csymbol><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1">subscript</csymbol><sum id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.2"></sum><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3"><eq id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.1"></eq><ci id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex7.m1.2.2.1.1.2.2.3.1.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.1.3">𝑁</ci></apply><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2"><times id="S3.Ex7.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.1"></times><apply id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.1.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2">subscript</csymbol><ci id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.2.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.2">𝑓</ci><ci id="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.3.cmml" xref="S3.Ex7.m1.2.2.1.1.2.2.3.2.2.3">𝑖</ci></apply><ci id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1">𝑤</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.2c">\displaystyle\min_{w}\quad\frac{1}{N}\sum_{i=1}^{N}f_{i}(w),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.2d">roman_min start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_w ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p1.4" class="ltx_p">where <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">f_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the loss function for the <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.p1.2.m2.1a"><msup id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">i</mi><mrow id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.p1.2.m2.1.1.3.1" xref="S3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑖</ci><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><times id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3.1"></times><ci id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">𝑡</ci><ci id="S3.p1.2.m2.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> data point, <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_w</annotation></semantics></math> are the weights of the network, and the expectation is taken over the data. Given a sequence of learning rates, <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\gamma_{k}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">γ</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝛾</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\gamma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_γ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, SGD iteratively takes steps of the form</p>
<table id="S9.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle w_{k+1}=w_{k}-\gamma_{k}\hat{\nabla}f(w_{k})," display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">w</mi><mrow id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S3.E1.m1.1.1.1.1.3.3.1" xref="S3.E1.m1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">-</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">γ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mover accent="true" id="S3.E1.m1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.4.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.1.1.4.2.cmml">∇</mo><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.4.1" xref="S3.E1.m1.1.1.1.1.1.1.4.1.cmml">^</mo></mover><mo id="S3.E1.m1.1.1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.1.1.1.1.1.1.5" xref="S3.E1.m1.1.1.1.1.1.1.5.cmml">f</mi><mo id="S3.E1.m1.1.1.1.1.1.1.2b" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝑤</ci><apply id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3"><plus id="S3.E1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.3.1"></plus><ci id="S3.E1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></minus><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.2">𝑤</ci><ci id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝛾</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4"><ci id="S3.E1.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.1">^</ci><ci id="S3.E1.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2">∇</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.5.cmml" xref="S3.E1.m1.1.1.1.1.1.1.5">𝑓</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle w_{k+1}=w_{k}-\gamma_{k}\hat{\nabla}f(w_{k}),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_w start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT = italic_w start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_γ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT over^ start_ARG ∇ end_ARG italic_f ( italic_w start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.5" class="ltx_p">where the subscript denotes the iteration number and the <math id="S3.p1.5.m1.1" class="ltx_Math" alttext="\hat{\nabla}" display="inline"><semantics id="S3.p1.5.m1.1a"><mover accent="true" id="S3.p1.5.m1.1.1" xref="S3.p1.5.m1.1.1.cmml"><mo id="S3.p1.5.m1.1.1.2" xref="S3.p1.5.m1.1.1.2.cmml">∇</mo><mo stretchy="false" id="S3.p1.5.m1.1.1.1" xref="S3.p1.5.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p1.5.m1.1b"><apply id="S3.p1.5.m1.1.1.cmml" xref="S3.p1.5.m1.1.1"><ci id="S3.p1.5.m1.1.1.1.cmml" xref="S3.p1.5.m1.1.1.1">^</ci><ci id="S3.p1.5.m1.1.1.2.cmml" xref="S3.p1.5.m1.1.1.2">∇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m1.1c">\hat{\nabla}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m1.1d">over^ start_ARG ∇ end_ARG</annotation></semantics></math> denotes a stochastic gradient that may be computed on a minibatch of data points. SGD demonstrably performs well in practice and also possesses several attractive theoretical properties such as linear convergence <cite class="ltx_cite ltx_citemacro_citep">(Bottou et al., <a href="#bib.bib4" title="" class="ltx_ref">2016</a>)</cite>, saddle point avoidance <cite class="ltx_cite ltx_citemacro_citep">(Panageas &amp; Piliouras, <a href="#bib.bib30" title="" class="ltx_ref">2016</a>)</cite> and better generalization performance <cite class="ltx_cite ltx_citemacro_citep">(Hardt et al., <a href="#bib.bib12" title="" class="ltx_ref">2015</a>)</cite>.
For the specific task of neural language modeling, traditionally SGD without momentum has been found to outperform other algorithms such as momentum SGD <cite class="ltx_cite ltx_citemacro_citep">(Sutskever et al., <a href="#bib.bib36" title="" class="ltx_ref">2013</a>)</cite>, Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib20" title="" class="ltx_ref">2014</a>)</cite>, Adagrad <cite class="ltx_cite ltx_citemacro_citep">(Duchi et al., <a href="#bib.bib7" title="" class="ltx_ref">2011</a>)</cite> and RMSProp <cite class="ltx_cite ltx_citemacro_citep">(Tieleman &amp; Hinton, <a href="#bib.bib38" title="" class="ltx_ref">2012</a>)</cite> by a statistically significant margin.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.3" class="ltx_p">Motivated by this observation, we investigate averaged SGD (ASGD) to further improve the training process. ASGD has been analyzed in depth theoretically and many surprising results have been shown including its asymptotic second-order convergence <cite class="ltx_cite ltx_citemacro_citep">(Polyak &amp; Juditsky, <a href="#bib.bib31" title="" class="ltx_ref">1992</a>; Mandt et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite>. ASGD takes steps identical to equation (<a href="#S3.E1" title="(1) ‣ 3 Optimization ‣ Regularizing and Optimizing LSTM Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) but instead of returning the last iterate as the solution, returns <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\frac{1}{(K-T+1)}\sum_{i=T}^{K}w_{i}" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.2" xref="S3.p2.1.m1.1.2.cmml"><mfrac id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mn id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">1</mn><mrow id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.1.m1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mrow id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2.2" xref="S3.p2.1.m1.1.1.1.1.1.2.2.cmml">K</mi><mo id="S3.p2.1.m1.1.1.1.1.1.2.1" xref="S3.p2.1.m1.1.1.1.1.1.2.1.cmml">-</mo><mi id="S3.p2.1.m1.1.1.1.1.1.2.3" xref="S3.p2.1.m1.1.1.1.1.1.2.3.cmml">T</mi></mrow><mo id="S3.p2.1.m1.1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.p2.1.m1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.p2.1.m1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mfrac><mo id="S3.p2.1.m1.1.2.1" xref="S3.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p2.1.m1.1.2.2" xref="S3.p2.1.m1.1.2.2.cmml"><msubsup id="S3.p2.1.m1.1.2.2.1" xref="S3.p2.1.m1.1.2.2.1.cmml"><mo largeop="true" symmetric="true" id="S3.p2.1.m1.1.2.2.1.2.2" xref="S3.p2.1.m1.1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.p2.1.m1.1.2.2.1.2.3" xref="S3.p2.1.m1.1.2.2.1.2.3.cmml"><mi id="S3.p2.1.m1.1.2.2.1.2.3.2" xref="S3.p2.1.m1.1.2.2.1.2.3.2.cmml">i</mi><mo id="S3.p2.1.m1.1.2.2.1.2.3.1" xref="S3.p2.1.m1.1.2.2.1.2.3.1.cmml">=</mo><mi id="S3.p2.1.m1.1.2.2.1.2.3.3" xref="S3.p2.1.m1.1.2.2.1.2.3.3.cmml">T</mi></mrow><mi id="S3.p2.1.m1.1.2.2.1.3" xref="S3.p2.1.m1.1.2.2.1.3.cmml">K</mi></msubsup><msub id="S3.p2.1.m1.1.2.2.2" xref="S3.p2.1.m1.1.2.2.2.cmml"><mi id="S3.p2.1.m1.1.2.2.2.2" xref="S3.p2.1.m1.1.2.2.2.2.cmml">w</mi><mi id="S3.p2.1.m1.1.2.2.2.3" xref="S3.p2.1.m1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.2.cmml" xref="S3.p2.1.m1.1.2"><times id="S3.p2.1.m1.1.2.1.cmml" xref="S3.p2.1.m1.1.2.1"></times><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><divide id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1"></divide><cn type="integer" id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">1</cn><apply id="S3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1"><plus id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1"></plus><apply id="S3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2"><minus id="S3.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.1"></minus><ci id="S3.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2">𝐾</ci><ci id="S3.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.3">𝑇</ci></apply><cn type="integer" id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.p2.1.m1.1.2.2.cmml" xref="S3.p2.1.m1.1.2.2"><apply id="S3.p2.1.m1.1.2.2.1.cmml" xref="S3.p2.1.m1.1.2.2.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.2.1.1.cmml" xref="S3.p2.1.m1.1.2.2.1">superscript</csymbol><apply id="S3.p2.1.m1.1.2.2.1.2.cmml" xref="S3.p2.1.m1.1.2.2.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.2.1.2.1.cmml" xref="S3.p2.1.m1.1.2.2.1">subscript</csymbol><sum id="S3.p2.1.m1.1.2.2.1.2.2.cmml" xref="S3.p2.1.m1.1.2.2.1.2.2"></sum><apply id="S3.p2.1.m1.1.2.2.1.2.3.cmml" xref="S3.p2.1.m1.1.2.2.1.2.3"><eq id="S3.p2.1.m1.1.2.2.1.2.3.1.cmml" xref="S3.p2.1.m1.1.2.2.1.2.3.1"></eq><ci id="S3.p2.1.m1.1.2.2.1.2.3.2.cmml" xref="S3.p2.1.m1.1.2.2.1.2.3.2">𝑖</ci><ci id="S3.p2.1.m1.1.2.2.1.2.3.3.cmml" xref="S3.p2.1.m1.1.2.2.1.2.3.3">𝑇</ci></apply></apply><ci id="S3.p2.1.m1.1.2.2.1.3.cmml" xref="S3.p2.1.m1.1.2.2.1.3">𝐾</ci></apply><apply id="S3.p2.1.m1.1.2.2.2.cmml" xref="S3.p2.1.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.2.2.1.cmml" xref="S3.p2.1.m1.1.2.2.2">subscript</csymbol><ci id="S3.p2.1.m1.1.2.2.2.2.cmml" xref="S3.p2.1.m1.1.2.2.2.2">𝑤</ci><ci id="S3.p2.1.m1.1.2.2.2.3.cmml" xref="S3.p2.1.m1.1.2.2.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\frac{1}{(K-T+1)}\sum_{i=T}^{K}w_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">divide start_ARG 1 end_ARG start_ARG ( italic_K - italic_T + 1 ) end_ARG ∑ start_POSTSUBSCRIPT italic_i = italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_K</annotation></semantics></math> is the total number of iterations and <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="T&lt;K" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">T</mi><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">&lt;</mo><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><lt id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></lt><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑇</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">T&lt;K</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_T &lt; italic_K</annotation></semantics></math> is a user-specified averaging trigger.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.7.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Non-monotonically Triggered ASGD (NT-ASGD)</figcaption><div class="ltx_flex_figure">

<div class="ltx_flex_cell 
                  ">
<p id="alg1.4" class="ltx_p"><span id="alg1.4.1" class="ltx_text ltx_font_bold">Inputs:</span> Initial point <math id="alg1.1.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="alg1.1.m1.1a"><msub id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml"><mi id="alg1.1.m1.1.1.2" xref="alg1.1.m1.1.1.2.cmml">w</mi><mn id="alg1.1.m1.1.1.3" xref="alg1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><apply id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.m1.1.1.1.cmml" xref="alg1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.m1.1.1.2.cmml" xref="alg1.1.m1.1.1.2">𝑤</ci><cn type="integer" id="alg1.1.m1.1.1.3.cmml" xref="alg1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">w_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.m1.1d">italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, learning rate <math id="alg1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="alg1.2.m2.1d">italic_γ</annotation></semantics></math>, logging interval <math id="alg1.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.3.m3.1d">italic_L</annotation></semantics></math>, non-monotone interval <math id="alg1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.4.m4.1a"><mi id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><ci id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg1.4.m4.1d">italic_n</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_cell 
                  ">
<div id="alg1.8" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize <math id="alg1.l1.m1.1" class="ltx_Math" alttext="k\leftarrow 0" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">k</mi><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">k\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_k ← 0</annotation></semantics></math>, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="t\leftarrow 0" display="inline"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">t</mi><mo id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">←</mo><mn id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><ci id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1">←</ci><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑡</ci><cn type="integer" id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">t\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_t ← 0</annotation></semantics></math>, <math id="alg1.l1.m3.1" class="ltx_Math" alttext="T\leftarrow 0" display="inline"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">T</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">←</mo><mn id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><ci id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1">←</ci><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑇</ci><cn type="integer" id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">T\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_T ← 0</annotation></semantics></math>, <span id="alg1.l1.2" class="ltx_text ltx_font_typewriter">logs</span> <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l1.m4.1a"><mo id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">←</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_typewriter">[]</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">while</span> stopping criterion not met <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Compute stochastic gradient <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\hat{\nabla}f(w_{k})" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mover accent="true" id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mo id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">∇</mo><mo stretchy="false" id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">^</mo></mover><mo id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.4" xref="alg1.l3.m1.1.1.4.cmml">f</mi><mo id="alg1.l3.m1.1.1.2a" xref="alg1.l3.m1.1.1.2.cmml">⁢</mo><mrow id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.l3.m1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l3.m1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><times id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"></times><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><ci id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1">^</ci><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">∇</ci></apply><ci id="alg1.l3.m1.1.1.4.cmml" xref="alg1.l3.m1.1.1.4">𝑓</ci><apply id="alg1.l3.m1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.l3.m1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\hat{\nabla}f(w_{k})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">over^ start_ARG ∇ end_ARG italic_f ( italic_w start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> and take SGD step (<a href="#S3.E1" title="(1) ‣ 3 Optimization ‣ Regularizing and Optimizing LSTM Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.2.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.3" class="ltx_text ltx_font_bold">if</span>  <span id="alg1.l4.1" class="ltx_text ltx_font_typewriter">mod<math id="alg1.l4.1.m1.2" class="ltx_Math" alttext="(k,L)=0" display="inline"><semantics id="alg1.l4.1.m1.2a"><mrow id="alg1.l4.1.m1.2.3" xref="alg1.l4.1.m1.2.3.cmml"><mrow id="alg1.l4.1.m1.2.3.2.2" xref="alg1.l4.1.m1.2.3.2.1.cmml"><mo mathvariant="normal" stretchy="false" id="alg1.l4.1.m1.2.3.2.2.1" xref="alg1.l4.1.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">k</mi><mo mathvariant="normal" id="alg1.l4.1.m1.2.3.2.2.2" xref="alg1.l4.1.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l4.1.m1.2.2" xref="alg1.l4.1.m1.2.2.cmml">L</mi><mo mathvariant="normal" stretchy="false" id="alg1.l4.1.m1.2.3.2.2.3" xref="alg1.l4.1.m1.2.3.2.1.cmml">)</mo></mrow><mo mathvariant="normal" id="alg1.l4.1.m1.2.3.1" xref="alg1.l4.1.m1.2.3.1.cmml">=</mo><mn mathvariant="normal" id="alg1.l4.1.m1.2.3.3" xref="alg1.l4.1.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.2b"><apply id="alg1.l4.1.m1.2.3.cmml" xref="alg1.l4.1.m1.2.3"><eq id="alg1.l4.1.m1.2.3.1.cmml" xref="alg1.l4.1.m1.2.3.1"></eq><interval closure="open" id="alg1.l4.1.m1.2.3.2.1.cmml" xref="alg1.l4.1.m1.2.3.2.2"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">𝑘</ci><ci id="alg1.l4.1.m1.2.2.cmml" xref="alg1.l4.1.m1.2.2">𝐿</ci></interval><cn type="integer" id="alg1.l4.1.m1.2.3.3.cmml" xref="alg1.l4.1.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.2c">(k,L)=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.2d">( italic_k , italic_L ) = 0</annotation></semantics></math></span> and <math id="alg1.l4.m1.1" class="ltx_Math" alttext="T=0" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">T</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">T=0</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_T = 0</annotation></semantics></math> <span id="alg1.l4.4" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Compute validation perplexity <math id="alg1.l5.m1.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_v</annotation></semantics></math>.

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <span id="alg1.l6.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l6.m1.1" class="ltx_Math" alttext="t&gt;n" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">t</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">&gt;</mo><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><gt id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></gt><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑡</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">t&gt;n</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_t &gt; italic_n</annotation></semantics></math> and <math id="alg1.l6.m2.3" class="ltx_Math" alttext="\displaystyle v&gt;\min_{l\in\{t-n,\cdots,t\}}" display="inline"><semantics id="alg1.l6.m2.3a"><mrow id="alg1.l6.m2.3.4" xref="alg1.l6.m2.3.4.cmml"><mi id="alg1.l6.m2.3.4.2" xref="alg1.l6.m2.3.4.2.cmml">v</mi><mo id="alg1.l6.m2.3.4.1" xref="alg1.l6.m2.3.4.1.cmml">&gt;</mo><munder id="alg1.l6.m2.3.4.3" xref="alg1.l6.m2.3.4.3.cmml"><mi id="alg1.l6.m2.3.4.3.2" xref="alg1.l6.m2.3.4.3.2.cmml">min</mi><mrow id="alg1.l6.m2.3.3.3" xref="alg1.l6.m2.3.3.3.cmml"><mi id="alg1.l6.m2.3.3.3.5" xref="alg1.l6.m2.3.3.3.5.cmml">l</mi><mo id="alg1.l6.m2.3.3.3.4" xref="alg1.l6.m2.3.3.3.4.cmml">∈</mo><mrow id="alg1.l6.m2.3.3.3.3.1" xref="alg1.l6.m2.3.3.3.3.2.cmml"><mo stretchy="false" id="alg1.l6.m2.3.3.3.3.1.2" xref="alg1.l6.m2.3.3.3.3.2.cmml">{</mo><mrow id="alg1.l6.m2.3.3.3.3.1.1" xref="alg1.l6.m2.3.3.3.3.1.1.cmml"><mi id="alg1.l6.m2.3.3.3.3.1.1.2" xref="alg1.l6.m2.3.3.3.3.1.1.2.cmml">t</mi><mo id="alg1.l6.m2.3.3.3.3.1.1.1" xref="alg1.l6.m2.3.3.3.3.1.1.1.cmml">-</mo><mi id="alg1.l6.m2.3.3.3.3.1.1.3" xref="alg1.l6.m2.3.3.3.3.1.1.3.cmml">n</mi></mrow><mo id="alg1.l6.m2.3.3.3.3.1.3" xref="alg1.l6.m2.3.3.3.3.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m2.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.cmml">⋯</mi><mo id="alg1.l6.m2.3.3.3.3.1.4" xref="alg1.l6.m2.3.3.3.3.2.cmml">,</mo><mi id="alg1.l6.m2.2.2.2.2" xref="alg1.l6.m2.2.2.2.2.cmml">t</mi><mo stretchy="false" id="alg1.l6.m2.3.3.3.3.1.5" xref="alg1.l6.m2.3.3.3.3.2.cmml">}</mo></mrow></mrow></munder></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.3b"><apply id="alg1.l6.m2.3.4.cmml" xref="alg1.l6.m2.3.4"><gt id="alg1.l6.m2.3.4.1.cmml" xref="alg1.l6.m2.3.4.1"></gt><ci id="alg1.l6.m2.3.4.2.cmml" xref="alg1.l6.m2.3.4.2">𝑣</ci><apply id="alg1.l6.m2.3.4.3.cmml" xref="alg1.l6.m2.3.4.3"><csymbol cd="ambiguous" id="alg1.l6.m2.3.4.3.1.cmml" xref="alg1.l6.m2.3.4.3">subscript</csymbol><min id="alg1.l6.m2.3.4.3.2.cmml" xref="alg1.l6.m2.3.4.3.2"></min><apply id="alg1.l6.m2.3.3.3.cmml" xref="alg1.l6.m2.3.3.3"><in id="alg1.l6.m2.3.3.3.4.cmml" xref="alg1.l6.m2.3.3.3.4"></in><ci id="alg1.l6.m2.3.3.3.5.cmml" xref="alg1.l6.m2.3.3.3.5">𝑙</ci><set id="alg1.l6.m2.3.3.3.3.2.cmml" xref="alg1.l6.m2.3.3.3.3.1"><apply id="alg1.l6.m2.3.3.3.3.1.1.cmml" xref="alg1.l6.m2.3.3.3.3.1.1"><minus id="alg1.l6.m2.3.3.3.3.1.1.1.cmml" xref="alg1.l6.m2.3.3.3.3.1.1.1"></minus><ci id="alg1.l6.m2.3.3.3.3.1.1.2.cmml" xref="alg1.l6.m2.3.3.3.3.1.1.2">𝑡</ci><ci id="alg1.l6.m2.3.3.3.3.1.1.3.cmml" xref="alg1.l6.m2.3.3.3.3.1.1.3">𝑛</ci></apply><ci id="alg1.l6.m2.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1">⋯</ci><ci id="alg1.l6.m2.2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2.2">𝑡</ci></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.3c">\displaystyle v&gt;\min_{l\in\{t-n,\cdots,t\}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.3d">italic_v &gt; roman_min start_POSTSUBSCRIPT italic_l ∈ { italic_t - italic_n , ⋯ , italic_t } end_POSTSUBSCRIPT</annotation></semantics></math> <span id="alg1.l6.3" class="ltx_text ltx_font_typewriter">logs[l]</span> <span id="alg1.l6.4" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           Set <math id="alg1.l7.m1.1" class="ltx_Math" alttext="T\leftarrow k" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">T</mi><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑇</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">T\leftarrow k</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_T ← italic_k</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        <span id="alg1.l8.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        Append <math id="alg1.l9.m1.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_v</annotation></semantics></math> to <span id="alg1.l9.2" class="ltx_text ltx_font_typewriter">logs</span>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        <math id="alg1.l10.m1.1" class="ltx_Math" alttext="t\leftarrow t+1" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑡</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><plus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></plus><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">t\leftarrow t+1</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_t ← italic_t + 1</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</div>
<div class="ltx_flex_cell 
                  ">
<p id="alg1.5" class="ltx_p"><span id="alg1.5.1" class="ltx_text ltx_font_bold">return </span> <math id="alg1.5.m1.1" class="ltx_Math" alttext="\frac{\sum_{i=T}^{k}w_{i}}{(k-T+1)}" display="inline"><semantics id="alg1.5.m1.1a"><mfrac id="alg1.5.m1.1.1" xref="alg1.5.m1.1.1.cmml"><mrow id="alg1.5.m1.1.1.3" xref="alg1.5.m1.1.1.3.cmml"><mstyle displaystyle="false" id="alg1.5.m1.1.1.3.1" xref="alg1.5.m1.1.1.3.1.cmml"><msubsup id="alg1.5.m1.1.1.3.1a" xref="alg1.5.m1.1.1.3.1.cmml"><mo largeop="true" symmetric="true" id="alg1.5.m1.1.1.3.1.2.2" xref="alg1.5.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.5.m1.1.1.3.1.2.3" xref="alg1.5.m1.1.1.3.1.2.3.cmml"><mi id="alg1.5.m1.1.1.3.1.2.3.2" xref="alg1.5.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="alg1.5.m1.1.1.3.1.2.3.1" xref="alg1.5.m1.1.1.3.1.2.3.1.cmml">=</mo><mi id="alg1.5.m1.1.1.3.1.2.3.3" xref="alg1.5.m1.1.1.3.1.2.3.3.cmml">T</mi></mrow><mi id="alg1.5.m1.1.1.3.1.3" xref="alg1.5.m1.1.1.3.1.3.cmml">k</mi></msubsup></mstyle><msub id="alg1.5.m1.1.1.3.2" xref="alg1.5.m1.1.1.3.2.cmml"><mi id="alg1.5.m1.1.1.3.2.2" xref="alg1.5.m1.1.1.3.2.2.cmml">w</mi><mi id="alg1.5.m1.1.1.3.2.3" xref="alg1.5.m1.1.1.3.2.3.cmml">i</mi></msub></mrow><mrow id="alg1.5.m1.1.1.1.1" xref="alg1.5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.5.m1.1.1.1.1.2" xref="alg1.5.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.5.m1.1.1.1.1.1" xref="alg1.5.m1.1.1.1.1.1.cmml"><mrow id="alg1.5.m1.1.1.1.1.1.2" xref="alg1.5.m1.1.1.1.1.1.2.cmml"><mi id="alg1.5.m1.1.1.1.1.1.2.2" xref="alg1.5.m1.1.1.1.1.1.2.2.cmml">k</mi><mo id="alg1.5.m1.1.1.1.1.1.2.1" xref="alg1.5.m1.1.1.1.1.1.2.1.cmml">-</mo><mi id="alg1.5.m1.1.1.1.1.1.2.3" xref="alg1.5.m1.1.1.1.1.1.2.3.cmml">T</mi></mrow><mo id="alg1.5.m1.1.1.1.1.1.1" xref="alg1.5.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.5.m1.1.1.1.1.1.3" xref="alg1.5.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.5.m1.1.1.1.1.3" xref="alg1.5.m1.1.1.1.1.1.cmml">)</mo></mrow></mfrac><annotation-xml encoding="MathML-Content" id="alg1.5.m1.1b"><apply id="alg1.5.m1.1.1.cmml" xref="alg1.5.m1.1.1"><divide id="alg1.5.m1.1.1.2.cmml" xref="alg1.5.m1.1.1"></divide><apply id="alg1.5.m1.1.1.3.cmml" xref="alg1.5.m1.1.1.3"><apply id="alg1.5.m1.1.1.3.1.cmml" xref="alg1.5.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.5.m1.1.1.3.1.1.cmml" xref="alg1.5.m1.1.1.3.1">superscript</csymbol><apply id="alg1.5.m1.1.1.3.1.2.cmml" xref="alg1.5.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.5.m1.1.1.3.1.2.1.cmml" xref="alg1.5.m1.1.1.3.1">subscript</csymbol><sum id="alg1.5.m1.1.1.3.1.2.2.cmml" xref="alg1.5.m1.1.1.3.1.2.2"></sum><apply id="alg1.5.m1.1.1.3.1.2.3.cmml" xref="alg1.5.m1.1.1.3.1.2.3"><eq id="alg1.5.m1.1.1.3.1.2.3.1.cmml" xref="alg1.5.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.5.m1.1.1.3.1.2.3.2.cmml" xref="alg1.5.m1.1.1.3.1.2.3.2">𝑖</ci><ci id="alg1.5.m1.1.1.3.1.2.3.3.cmml" xref="alg1.5.m1.1.1.3.1.2.3.3">𝑇</ci></apply></apply><ci id="alg1.5.m1.1.1.3.1.3.cmml" xref="alg1.5.m1.1.1.3.1.3">𝑘</ci></apply><apply id="alg1.5.m1.1.1.3.2.cmml" xref="alg1.5.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.5.m1.1.1.3.2.1.cmml" xref="alg1.5.m1.1.1.3.2">subscript</csymbol><ci id="alg1.5.m1.1.1.3.2.2.cmml" xref="alg1.5.m1.1.1.3.2.2">𝑤</ci><ci id="alg1.5.m1.1.1.3.2.3.cmml" xref="alg1.5.m1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="alg1.5.m1.1.1.1.1.1.cmml" xref="alg1.5.m1.1.1.1.1"><plus id="alg1.5.m1.1.1.1.1.1.1.cmml" xref="alg1.5.m1.1.1.1.1.1.1"></plus><apply id="alg1.5.m1.1.1.1.1.1.2.cmml" xref="alg1.5.m1.1.1.1.1.1.2"><minus id="alg1.5.m1.1.1.1.1.1.2.1.cmml" xref="alg1.5.m1.1.1.1.1.1.2.1"></minus><ci id="alg1.5.m1.1.1.1.1.1.2.2.cmml" xref="alg1.5.m1.1.1.1.1.1.2.2">𝑘</ci><ci id="alg1.5.m1.1.1.1.1.1.2.3.cmml" xref="alg1.5.m1.1.1.1.1.1.2.3">𝑇</ci></apply><cn type="integer" id="alg1.5.m1.1.1.1.1.1.3.cmml" xref="alg1.5.m1.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m1.1c">\frac{\sum_{i=T}^{k}w_{i}}{(k-T+1)}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.m1.1d">divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ( italic_k - italic_T + 1 ) end_ARG</annotation></semantics></math>
</p>
</div>
</div>
</figure>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.3" class="ltx_p">Despite its theoretical appeal, ASGD has found limited practical use in training of deep networks.
This may be in part due to unclear tuning guidelines for the learning-rate schedule <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\gamma_{k}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">γ</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝛾</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\gamma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_γ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and averaging trigger <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_T</annotation></semantics></math>.
If the averaging is triggered too soon, the efficacy of the method is impacted, and if it is triggered too late, many additional iterations may be needed to converge to the solution.
In this section, we describe a non-monotonically triggered variant of ASGD (NT-ASGD), which obviates the need for tuning <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p3.3.m3.1a"><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_T</annotation></semantics></math>. Further, the algorithm uses a constant learning rate throughout the experiment and hence no further tuning is necessary for the decay scheduling.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Ideally, averaging needs to be triggered when the SGD iterates converge to a steady-state distribution <cite class="ltx_cite ltx_citemacro_citep">(Mandt et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite>. This is roughly equivalent to the convergence of SGD to a neighborhood around a solution. In the case of SGD, certain learning-rate reduction strategies such as the step-wise strategy analogously reduce the learning rate by a fixed quantity at such a point. A common strategy employed in language modeling is to reduce the learning rates by a fixed proportion when the performance of the model’s primary metric (such as perplexity) worsens or stagnates. Along the same lines, one could make a triggering decision based on the performance of the model on the validation set. However, instead of averaging immediately after the validation metric worsens, we propose a non-monotonic criterion that conservatively triggers the averaging when the validation metric fails to improve for multiple cycles; see Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3 Optimization ‣ Regularizing and Optimizing LSTM Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Given that the choice of triggering is irreversible, this conservatism ensures that the randomness of training does not play a major role in the decision. Analogous strategies have also been proposed for learning-rate reduction in SGD <cite class="ltx_cite ltx_citemacro_citep">(Keskar &amp; Saon, <a href="#bib.bib18" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.4" class="ltx_p">While the algorithm introduces two additional hyperparameters, the logging interval <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_L</annotation></semantics></math> and non-monotone interval <math id="S3.p5.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.p5.2.m2.1a"><mi id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><ci id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">italic_n</annotation></semantics></math>, we found that setting <math id="S3.p5.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p5.3.m3.1a"><mi id="S3.p5.3.m3.1.1" xref="S3.p5.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m3.1b"><ci id="S3.p5.3.m3.1.1.cmml" xref="S3.p5.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m3.1d">italic_L</annotation></semantics></math> to be the number of iterations in an epoch and <math id="S3.p5.4.m4.1" class="ltx_Math" alttext="n=5" display="inline"><semantics id="S3.p5.4.m4.1a"><mrow id="S3.p5.4.m4.1.1" xref="S3.p5.4.m4.1.1.cmml"><mi id="S3.p5.4.m4.1.1.2" xref="S3.p5.4.m4.1.1.2.cmml">n</mi><mo id="S3.p5.4.m4.1.1.1" xref="S3.p5.4.m4.1.1.1.cmml">=</mo><mn id="S3.p5.4.m4.1.1.3" xref="S3.p5.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.4.m4.1b"><apply id="S3.p5.4.m4.1.1.cmml" xref="S3.p5.4.m4.1.1"><eq id="S3.p5.4.m4.1.1.1.cmml" xref="S3.p5.4.m4.1.1.1"></eq><ci id="S3.p5.4.m4.1.1.2.cmml" xref="S3.p5.4.m4.1.1.2">𝑛</ci><cn type="integer" id="S3.p5.4.m4.1.1.3.cmml" xref="S3.p5.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.4.m4.1c">n=5</annotation><annotation encoding="application/x-llamapun" id="S3.p5.4.m4.1d">italic_n = 5</annotation></semantics></math> worked well across various models and data sets. As such, we use this setting in all of our NT-ASGD experiments in the following section and demonstrate that it achieves better training outcomes as compared to SGD.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Extended regularization techniques</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In addition to the regularization and optimization techniques above, we explored additional regularization techniques that aimed to improve data efficiency during training and to prevent overfitting of the RNN model.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Variable length backpropagation sequences</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.8" class="ltx_p">Given a fixed sequence length that is used to break a data set into fixed length batches, the data set is not efficiently used.
To illustrate this, imagine being given <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mn id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">100</annotation></semantics></math> elements to perform backpropagation through with a fixed backpropagation through time (BPTT) window of <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn type="integer" id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">10</annotation></semantics></math>.
Any element divisible by <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">10</annotation></semantics></math> will never have any elements to backprop into, no matter how many times you may traverse the data set.
Indeed, the backpropagation window that each element receives is equal to <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="i\bmod 10" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">i</mi><mo lspace="2.5pt" rspace="2.5pt" id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">mod</mo><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1">modulo</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑖</ci><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">i\bmod 10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_i roman_mod 10</annotation></semantics></math> where <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_i</annotation></semantics></math> is the element’s index.
This is data inefficient, preventing <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\frac{1}{10}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mfrac id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mn id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">1</mn><mn id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">10</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><divide id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"></divide><cn type="integer" id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">1</cn><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\frac{1}{10}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">divide start_ARG 1 end_ARG start_ARG 10 end_ARG</annotation></semantics></math> of the data set from ever being able to improve itself in a recurrent fashion, and resulting in <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\frac{8}{10}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mfrac id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mn id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">8</mn><mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">10</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><divide id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"></divide><cn type="integer" id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">8</cn><cn type="integer" id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\frac{8}{10}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">divide start_ARG 8 end_ARG start_ARG 10 end_ARG</annotation></semantics></math> of the remaining elements receiving only a partial backpropagation window compared to the full possible backpropagation window of length <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mn id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><cn type="integer" id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">10</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">10</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.11" class="ltx_p">To prevent such inefficient data usage, we randomly select the sequence length for the forward and backward pass in two steps.
First, we select the base sequence length to be <span id="S4.SS1.p2.11.1" class="ltx_text ltx_markedasmath">seq</span> with probability <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">italic_p</annotation></semantics></math> and <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\frac{\text{seq}}{2}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mfrac id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mtext id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2a.cmml">seq</mtext><mn id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><divide id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"></divide><ci id="S4.SS1.p2.3.m3.1.1.2a.cmml" xref="S4.SS1.p2.3.m3.1.1.2"><mtext mathsize="70%" id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">seq</mtext></ci><cn type="integer" id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\frac{\text{seq}}{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">divide start_ARG seq end_ARG start_ARG 2 end_ARG</annotation></semantics></math> with probability <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="1-p" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mn id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">1</mn><mo id="S4.SS1.p2.4.m4.1.1.1" xref="S4.SS1.p2.4.m4.1.1.1.cmml">-</mo><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><minus id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"></minus><cn type="integer" id="S4.SS1.p2.4.m4.1.1.2.cmml" xref="S4.SS1.p2.4.m4.1.1.2">1</cn><ci id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">1-p</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">1 - italic_p</annotation></semantics></math>, where <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">italic_p</annotation></semantics></math> is a high value approaching <math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><mn id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><cn type="integer" id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">1</annotation></semantics></math>.
This spreads the starting point for the BPTT window beyond the base sequence length.
We then select the sequence length according to <math id="S4.SS1.p2.7.m7.2" class="ltx_Math" alttext="\mathcal{N}(\text{seq},s)" display="inline"><semantics id="S4.SS1.p2.7.m7.2a"><mrow id="S4.SS1.p2.7.m7.2.3" xref="S4.SS1.p2.7.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.7.m7.2.3.2" xref="S4.SS1.p2.7.m7.2.3.2.cmml">𝒩</mi><mo id="S4.SS1.p2.7.m7.2.3.1" xref="S4.SS1.p2.7.m7.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.p2.7.m7.2.3.3.2" xref="S4.SS1.p2.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.7.m7.2.3.3.2.1" xref="S4.SS1.p2.7.m7.2.3.3.1.cmml">(</mo><mtext id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1a.cmml">seq</mtext><mo id="S4.SS1.p2.7.m7.2.3.3.2.2" xref="S4.SS1.p2.7.m7.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p2.7.m7.2.2" xref="S4.SS1.p2.7.m7.2.2.cmml">s</mi><mo stretchy="false" id="S4.SS1.p2.7.m7.2.3.3.2.3" xref="S4.SS1.p2.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.2b"><apply id="S4.SS1.p2.7.m7.2.3.cmml" xref="S4.SS1.p2.7.m7.2.3"><times id="S4.SS1.p2.7.m7.2.3.1.cmml" xref="S4.SS1.p2.7.m7.2.3.1"></times><ci id="S4.SS1.p2.7.m7.2.3.2.cmml" xref="S4.SS1.p2.7.m7.2.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p2.7.m7.2.3.3.1.cmml" xref="S4.SS1.p2.7.m7.2.3.3.2"><ci id="S4.SS1.p2.7.m7.1.1a.cmml" xref="S4.SS1.p2.7.m7.1.1"><mtext id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">seq</mtext></ci><ci id="S4.SS1.p2.7.m7.2.2.cmml" xref="S4.SS1.p2.7.m7.2.2">𝑠</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.2c">\mathcal{N}(\text{seq},s)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m7.2d">caligraphic_N ( seq , italic_s )</annotation></semantics></math>, where <span id="S4.SS1.p2.11.2" class="ltx_text ltx_markedasmath">seq</span> is the base sequence length and <math id="S4.SS1.p2.9.m9.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p2.9.m9.1a"><mi id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.1b"><ci id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.9.m9.1d">italic_s</annotation></semantics></math> is the standard deviation.
This jitters the starting point such that it doesn’t always fall on a specific word divisible by <span id="S4.SS1.p2.11.3" class="ltx_text ltx_markedasmath">seq</span> or <math id="S4.SS1.p2.11.m11.1" class="ltx_Math" alttext="\frac{\text{seq}}{2}" display="inline"><semantics id="S4.SS1.p2.11.m11.1a"><mfrac id="S4.SS1.p2.11.m11.1.1" xref="S4.SS1.p2.11.m11.1.1.cmml"><mtext id="S4.SS1.p2.11.m11.1.1.2" xref="S4.SS1.p2.11.m11.1.1.2a.cmml">seq</mtext><mn id="S4.SS1.p2.11.m11.1.1.3" xref="S4.SS1.p2.11.m11.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m11.1b"><apply id="S4.SS1.p2.11.m11.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1"><divide id="S4.SS1.p2.11.m11.1.1.1.cmml" xref="S4.SS1.p2.11.m11.1.1"></divide><ci id="S4.SS1.p2.11.m11.1.1.2a.cmml" xref="S4.SS1.p2.11.m11.1.1.2"><mtext mathsize="70%" id="S4.SS1.p2.11.m11.1.1.2.cmml" xref="S4.SS1.p2.11.m11.1.1.2">seq</mtext></ci><cn type="integer" id="S4.SS1.p2.11.m11.1.1.3.cmml" xref="S4.SS1.p2.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m11.1c">\frac{\text{seq}}{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.11.m11.1d">divide start_ARG seq end_ARG start_ARG 2 end_ARG</annotation></semantics></math>.
From these, the sequence length more efficiently uses the data set, ensuring that when given enough epochs all the elements in the data set experience a full BPTT window, while ensuring the average sequence length remains around the base sequence length for computational efficiency.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">During training, we rescale the learning rate depending on the length of the resulting sequence compared to the original specified sequence length.
The rescaling step is necessary as sampling arbitrary sequence lengths with a fixed learning rate favors short sequences over longer ones.
This linear scaling rule has been noted as important for training large scale minibatch SGD without loss of accuracy <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a href="#bib.bib10" title="" class="ltx_ref">2017</a>)</cite> and is a component of unbiased truncated backpropagation through time <cite class="ltx_cite ltx_citemacro_citep">(Tallec &amp; Ollivier, <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Variational dropout</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p">In standard dropout, a new binary dropout mask is sampled each and every time the dropout function is called.
New dropout masks are sampled even if the given connection is repeated, such as the input <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="x_{0}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">x</mi><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑥</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to an LSTM at timestep <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">t</mi><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><eq id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></eq><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">t=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_t = 0</annotation></semantics></math> receiving a different dropout mask than the input <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msub id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">x</mi><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑥</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> fed to the same LSTM at <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">t</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑡</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">t=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_t = 1</annotation></semantics></math>.
A variant of this, variational dropout <cite class="ltx_cite ltx_citemacro_citep">(Gal &amp; Ghahramani, <a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite>, samples a binary dropout mask only once upon the first call and then to repeatedly use that locked dropout mask for all repeated connections within the forward and backward pass.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">While we propose using DropConnect rather than variational dropout to regularize the hidden-to-hidden transition within an RNN, we use variational dropout for all other dropout operations, specifically using the same dropout mask for all inputs and outputs of the LSTM within a given forward and backward pass.
Each example within the minibatch uses a unique dropout mask, rather than a single dropout mask being used over all examples, ensuring diversity in the elements dropped out.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Embedding dropout</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.2" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_citet">Gal &amp; Ghahramani (<a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite>, we employ embedding dropout.
This is equivalent to performing dropout on the embedding matrix at a word level, where the dropout is broadcast across all the word vector’s embedding.
The remaining non-dropped-out word embeddings are scaled by <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\frac{1}{1-p_{e}}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mfrac id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mn id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">1</mn><mrow id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mn id="S4.SS3.p1.1.m1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">1</mn><mo id="S4.SS3.p1.1.m1.1.1.3.1" xref="S4.SS3.p1.1.m1.1.1.3.1.cmml">-</mo><msub id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3.3.2" xref="S4.SS3.p1.1.m1.1.1.3.3.2.cmml">p</mi><mi id="S4.SS3.p1.1.m1.1.1.3.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.3.cmml">e</mi></msub></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><divide id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"></divide><cn type="integer" id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">1</cn><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><minus id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3.1"></minus><cn type="integer" id="S4.SS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.2">1</cn><apply id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3.2">𝑝</ci><ci id="S4.SS3.p1.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\frac{1}{1-p_{e}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">divide start_ARG 1 end_ARG start_ARG 1 - italic_p start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> where <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="p_{e}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">p</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝑝</ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">p_{e}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is the probability of embedding dropout.
As the dropout occurs on the embedding matrix that is used for a full forward and backward pass, this means that all occurrences of a specific word will disappear within that pass, equivalent to performing variational dropout on the connection between the one-hot embedding and the embedding lookup.
</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Weight tying</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Weight tying <cite class="ltx_cite ltx_citemacro_citep">(Inan et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Press &amp; Wolf, <a href="#bib.bib32" title="" class="ltx_ref">2016</a>)</cite> shares the weights between the embedding and softmax layer, substantially reducing the total parameter count in the model.
The technique has theoretical motivation <cite class="ltx_cite ltx_citemacro_citep">(Inan et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite> and prevents the model from having to learn a one-to-one correspondence between the input and output, resulting in substantial improvements to the standard LSTM language model.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Independent embedding size and hidden size</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">In most natural language processing tasks, both pre-trained and trained word vectors are of relatively low dimensionality—frequently between 100 and 400 dimensions in size.
Most previous LSTM language models tie the dimensionality of the word vectors to the dimensionality of the LSTM’s hidden state.
Even if reducing the word embedding size was not beneficial in preventing overfitting, the easiest reduction in total parameters for a language model is reducing the word vector size.
To achieve this, the first and last LSTM layers are modified such that their input and output dimensionality respectively are equal to the reduced embedding size.</p>
</div>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6 </span>Activation Regularization (AR) and Temporal Activation Regularization (TAR)</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.3" class="ltx_p"><math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><msub id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mi id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">L</mi><mn id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S4.SS6.p1.1.m1.1.1.3.cmml" xref="S4.SS6.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>-regularization is often used on the weights of the network to control the norm of the resulting model and reduce overfitting. In addition, <math id="S4.SS6.p1.2.m2.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S4.SS6.p1.2.m2.1a"><msub id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">L</mi><mn id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">𝐿</ci><cn type="integer" id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">L_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> decay can be used on the individual unit activations and on the difference in outputs of an RNN at different time steps; these strategies labeled as activation regularization (AR) and temporal activation regularization (TAR) respectively <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a href="#bib.bib27" title="" class="ltx_ref">2017</a>)</cite>.
AR penalizes activations that are significantly larger than <math id="S4.SS6.p1.3.m3.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.SS6.p1.3.m3.1a"><mn id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><cn type="integer" id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1">0</cn></annotation-xml></semantics></math> as a means of regularizing the network. Concretely, AR is defined as</p>
<table id="S4.Ex8" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex8.m1.1" class="ltx_Math" alttext="\alpha\,L_{2}(m\odot h_{t})" display="block"><semantics id="S4.Ex8.m1.1a"><mrow id="S4.Ex8.m1.1.1" xref="S4.Ex8.m1.1.1.cmml"><mpadded width="+1.7pt" id="S4.Ex8.m1.1.1.3" xref="S4.Ex8.m1.1.1.3.cmml"><mi id="S4.Ex8.m1.1.1.3a" xref="S4.Ex8.m1.1.1.3.cmml">α</mi></mpadded><mo id="S4.Ex8.m1.1.1.2" xref="S4.Ex8.m1.1.1.2.cmml">⁢</mo><msub id="S4.Ex8.m1.1.1.4" xref="S4.Ex8.m1.1.1.4.cmml"><mi id="S4.Ex8.m1.1.1.4.2" xref="S4.Ex8.m1.1.1.4.2.cmml">L</mi><mn id="S4.Ex8.m1.1.1.4.3" xref="S4.Ex8.m1.1.1.4.3.cmml">2</mn></msub><mo id="S4.Ex8.m1.1.1.2a" xref="S4.Ex8.m1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex8.m1.1.1.1.1" xref="S4.Ex8.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex8.m1.1.1.1.1.2" xref="S4.Ex8.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex8.m1.1.1.1.1.1" xref="S4.Ex8.m1.1.1.1.1.1.cmml"><mi id="S4.Ex8.m1.1.1.1.1.1.2" xref="S4.Ex8.m1.1.1.1.1.1.2.cmml">m</mi><mo id="S4.Ex8.m1.1.1.1.1.1.1" xref="S4.Ex8.m1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S4.Ex8.m1.1.1.1.1.1.3" xref="S4.Ex8.m1.1.1.1.1.1.3.cmml"><mi id="S4.Ex8.m1.1.1.1.1.1.3.2" xref="S4.Ex8.m1.1.1.1.1.1.3.2.cmml">h</mi><mi id="S4.Ex8.m1.1.1.1.1.1.3.3" xref="S4.Ex8.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.Ex8.m1.1.1.1.1.3" xref="S4.Ex8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex8.m1.1b"><apply id="S4.Ex8.m1.1.1.cmml" xref="S4.Ex8.m1.1.1"><times id="S4.Ex8.m1.1.1.2.cmml" xref="S4.Ex8.m1.1.1.2"></times><ci id="S4.Ex8.m1.1.1.3.cmml" xref="S4.Ex8.m1.1.1.3">𝛼</ci><apply id="S4.Ex8.m1.1.1.4.cmml" xref="S4.Ex8.m1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex8.m1.1.1.4.1.cmml" xref="S4.Ex8.m1.1.1.4">subscript</csymbol><ci id="S4.Ex8.m1.1.1.4.2.cmml" xref="S4.Ex8.m1.1.1.4.2">𝐿</ci><cn type="integer" id="S4.Ex8.m1.1.1.4.3.cmml" xref="S4.Ex8.m1.1.1.4.3">2</cn></apply><apply id="S4.Ex8.m1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex8.m1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.1.1.1.1.1.1">direct-product</csymbol><ci id="S4.Ex8.m1.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.1.1.1.1.1.2">𝑚</ci><apply id="S4.Ex8.m1.1.1.1.1.1.3.cmml" xref="S4.Ex8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex8.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex8.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex8.m1.1.1.1.1.1.3.2.cmml" xref="S4.Ex8.m1.1.1.1.1.1.3.2">ℎ</ci><ci id="S4.Ex8.m1.1.1.1.1.1.3.3.cmml" xref="S4.Ex8.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex8.m1.1c">\alpha\,L_{2}(m\odot h_{t})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex8.m1.1d">italic_α italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_m ⊙ italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
<p id="S4.SS6.p1.8" class="ltx_p">where <math id="S4.SS6.p1.4.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS6.p1.4.m1.1a"><mi id="S4.SS6.p1.4.m1.1.1" xref="S4.SS6.p1.4.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.4.m1.1b"><ci id="S4.SS6.p1.4.m1.1.1.cmml" xref="S4.SS6.p1.4.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.4.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.4.m1.1d">italic_m</annotation></semantics></math> is the dropout mask, <math id="S4.SS6.p1.5.m2.2" class="ltx_Math" alttext="L_{2}(\cdot)=\lVert\cdot\rVert_{2}" display="inline"><semantics id="S4.SS6.p1.5.m2.2a"><mrow id="S4.SS6.p1.5.m2.2.3" xref="S4.SS6.p1.5.m2.2.3.cmml"><mrow id="S4.SS6.p1.5.m2.2.3.2" xref="S4.SS6.p1.5.m2.2.3.2.cmml"><msub id="S4.SS6.p1.5.m2.2.3.2.2" xref="S4.SS6.p1.5.m2.2.3.2.2.cmml"><mi id="S4.SS6.p1.5.m2.2.3.2.2.2" xref="S4.SS6.p1.5.m2.2.3.2.2.2.cmml">L</mi><mn id="S4.SS6.p1.5.m2.2.3.2.2.3" xref="S4.SS6.p1.5.m2.2.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS6.p1.5.m2.2.3.2.1" xref="S4.SS6.p1.5.m2.2.3.2.1.cmml">⁢</mo><mrow id="S4.SS6.p1.5.m2.2.3.2.3.2" xref="S4.SS6.p1.5.m2.2.3.2.cmml"><mo stretchy="false" id="S4.SS6.p1.5.m2.2.3.2.3.2.1" xref="S4.SS6.p1.5.m2.2.3.2.cmml">(</mo><mo id="S4.SS6.p1.5.m2.1.1" xref="S4.SS6.p1.5.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS6.p1.5.m2.2.3.2.3.2.2" xref="S4.SS6.p1.5.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="S4.SS6.p1.5.m2.2.3.1" xref="S4.SS6.p1.5.m2.2.3.1.cmml">=</mo><msub id="S4.SS6.p1.5.m2.2.3.3" xref="S4.SS6.p1.5.m2.2.3.3.cmml"><mrow id="S4.SS6.p1.5.m2.2.3.3.2.2" xref="S4.SS6.p1.5.m2.2.3.3.2.1.cmml"><mo fence="true" stretchy="false" id="S4.SS6.p1.5.m2.2.3.3.2.2.1" xref="S4.SS6.p1.5.m2.2.3.3.2.1.1.cmml">∥</mo><mo id="S4.SS6.p1.5.m2.2.2" xref="S4.SS6.p1.5.m2.2.2.cmml">⋅</mo><mo fence="true" stretchy="false" id="S4.SS6.p1.5.m2.2.3.3.2.2.2" xref="S4.SS6.p1.5.m2.2.3.3.2.1.1.cmml">∥</mo></mrow><mn id="S4.SS6.p1.5.m2.2.3.3.3" xref="S4.SS6.p1.5.m2.2.3.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.5.m2.2b"><apply id="S4.SS6.p1.5.m2.2.3.cmml" xref="S4.SS6.p1.5.m2.2.3"><eq id="S4.SS6.p1.5.m2.2.3.1.cmml" xref="S4.SS6.p1.5.m2.2.3.1"></eq><apply id="S4.SS6.p1.5.m2.2.3.2.cmml" xref="S4.SS6.p1.5.m2.2.3.2"><times id="S4.SS6.p1.5.m2.2.3.2.1.cmml" xref="S4.SS6.p1.5.m2.2.3.2.1"></times><apply id="S4.SS6.p1.5.m2.2.3.2.2.cmml" xref="S4.SS6.p1.5.m2.2.3.2.2"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m2.2.3.2.2.1.cmml" xref="S4.SS6.p1.5.m2.2.3.2.2">subscript</csymbol><ci id="S4.SS6.p1.5.m2.2.3.2.2.2.cmml" xref="S4.SS6.p1.5.m2.2.3.2.2.2">𝐿</ci><cn type="integer" id="S4.SS6.p1.5.m2.2.3.2.2.3.cmml" xref="S4.SS6.p1.5.m2.2.3.2.2.3">2</cn></apply><ci id="S4.SS6.p1.5.m2.1.1.cmml" xref="S4.SS6.p1.5.m2.1.1">⋅</ci></apply><apply id="S4.SS6.p1.5.m2.2.3.3.cmml" xref="S4.SS6.p1.5.m2.2.3.3"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m2.2.3.3.1.cmml" xref="S4.SS6.p1.5.m2.2.3.3">subscript</csymbol><apply id="S4.SS6.p1.5.m2.2.3.3.2.1.cmml" xref="S4.SS6.p1.5.m2.2.3.3.2.2"><csymbol cd="latexml" id="S4.SS6.p1.5.m2.2.3.3.2.1.1.cmml" xref="S4.SS6.p1.5.m2.2.3.3.2.2.1">norm</csymbol><ci id="S4.SS6.p1.5.m2.2.2.cmml" xref="S4.SS6.p1.5.m2.2.2">⋅</ci></apply><cn type="integer" id="S4.SS6.p1.5.m2.2.3.3.3.cmml" xref="S4.SS6.p1.5.m2.2.3.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.5.m2.2c">L_{2}(\cdot)=\lVert\cdot\rVert_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.5.m2.2d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( ⋅ ) = ∥ ⋅ ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, <math id="S4.SS6.p1.6.m3.1" class="ltx_Math" alttext="h_{t}" display="inline"><semantics id="S4.SS6.p1.6.m3.1a"><msub id="S4.SS6.p1.6.m3.1.1" xref="S4.SS6.p1.6.m3.1.1.cmml"><mi id="S4.SS6.p1.6.m3.1.1.2" xref="S4.SS6.p1.6.m3.1.1.2.cmml">h</mi><mi id="S4.SS6.p1.6.m3.1.1.3" xref="S4.SS6.p1.6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.6.m3.1b"><apply id="S4.SS6.p1.6.m3.1.1.cmml" xref="S4.SS6.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.6.m3.1.1.1.cmml" xref="S4.SS6.p1.6.m3.1.1">subscript</csymbol><ci id="S4.SS6.p1.6.m3.1.1.2.cmml" xref="S4.SS6.p1.6.m3.1.1.2">ℎ</ci><ci id="S4.SS6.p1.6.m3.1.1.3.cmml" xref="S4.SS6.p1.6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.6.m3.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.6.m3.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the output of the RNN at timestep <math id="S4.SS6.p1.7.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS6.p1.7.m4.1a"><mi id="S4.SS6.p1.7.m4.1.1" xref="S4.SS6.p1.7.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.7.m4.1b"><ci id="S4.SS6.p1.7.m4.1.1.cmml" xref="S4.SS6.p1.7.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.7.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.7.m4.1d">italic_t</annotation></semantics></math>, and <math id="S4.SS6.p1.8.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS6.p1.8.m5.1a"><mi id="S4.SS6.p1.8.m5.1.1" xref="S4.SS6.p1.8.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.8.m5.1b"><ci id="S4.SS6.p1.8.m5.1.1.cmml" xref="S4.SS6.p1.8.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.8.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.8.m5.1d">italic_α</annotation></semantics></math> is a scaling coefficient. TAR falls under the broad category of <span id="S4.SS6.p1.8.1" class="ltx_text ltx_font_italic">slowness</span> regularizers <cite class="ltx_cite ltx_citemacro_citep">(Hinton, <a href="#bib.bib13" title="" class="ltx_ref">1989</a>; Földiák, <a href="#bib.bib8" title="" class="ltx_ref">1991</a>; Luciw &amp; Schmidhuber, <a href="#bib.bib23" title="" class="ltx_ref">2012</a>; Jonschkowski &amp; Brock, <a href="#bib.bib17" title="" class="ltx_ref">2015</a>)</cite> which penalize the model from producing large changes in the hidden state. Using the notation from AR, TAR is defined as</p>
<table id="S4.Ex9" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex9.m1.1" class="ltx_Math" alttext="\beta\,L_{2}(h_{t}-h_{t+1})" display="block"><semantics id="S4.Ex9.m1.1a"><mrow id="S4.Ex9.m1.1.1" xref="S4.Ex9.m1.1.1.cmml"><mpadded width="+1.7pt" id="S4.Ex9.m1.1.1.3" xref="S4.Ex9.m1.1.1.3.cmml"><mi id="S4.Ex9.m1.1.1.3a" xref="S4.Ex9.m1.1.1.3.cmml">β</mi></mpadded><mo id="S4.Ex9.m1.1.1.2" xref="S4.Ex9.m1.1.1.2.cmml">⁢</mo><msub id="S4.Ex9.m1.1.1.4" xref="S4.Ex9.m1.1.1.4.cmml"><mi id="S4.Ex9.m1.1.1.4.2" xref="S4.Ex9.m1.1.1.4.2.cmml">L</mi><mn id="S4.Ex9.m1.1.1.4.3" xref="S4.Ex9.m1.1.1.4.3.cmml">2</mn></msub><mo id="S4.Ex9.m1.1.1.2a" xref="S4.Ex9.m1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex9.m1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex9.m1.1.1.1.1.2" xref="S4.Ex9.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex9.m1.1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.1.cmml"><msub id="S4.Ex9.m1.1.1.1.1.1.2" xref="S4.Ex9.m1.1.1.1.1.1.2.cmml"><mi id="S4.Ex9.m1.1.1.1.1.1.2.2" xref="S4.Ex9.m1.1.1.1.1.1.2.2.cmml">h</mi><mi id="S4.Ex9.m1.1.1.1.1.1.2.3" xref="S4.Ex9.m1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.Ex9.m1.1.1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.1.1.cmml">-</mo><msub id="S4.Ex9.m1.1.1.1.1.1.3" xref="S4.Ex9.m1.1.1.1.1.1.3.cmml"><mi id="S4.Ex9.m1.1.1.1.1.1.3.2" xref="S4.Ex9.m1.1.1.1.1.1.3.2.cmml">h</mi><mrow id="S4.Ex9.m1.1.1.1.1.1.3.3" xref="S4.Ex9.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex9.m1.1.1.1.1.1.3.3.2" xref="S4.Ex9.m1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.Ex9.m1.1.1.1.1.1.3.3.1" xref="S4.Ex9.m1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="S4.Ex9.m1.1.1.1.1.1.3.3.3" xref="S4.Ex9.m1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.Ex9.m1.1.1.1.1.3" xref="S4.Ex9.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex9.m1.1b"><apply id="S4.Ex9.m1.1.1.cmml" xref="S4.Ex9.m1.1.1"><times id="S4.Ex9.m1.1.1.2.cmml" xref="S4.Ex9.m1.1.1.2"></times><ci id="S4.Ex9.m1.1.1.3.cmml" xref="S4.Ex9.m1.1.1.3">𝛽</ci><apply id="S4.Ex9.m1.1.1.4.cmml" xref="S4.Ex9.m1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.4.1.cmml" xref="S4.Ex9.m1.1.1.4">subscript</csymbol><ci id="S4.Ex9.m1.1.1.4.2.cmml" xref="S4.Ex9.m1.1.1.4.2">𝐿</ci><cn type="integer" id="S4.Ex9.m1.1.1.4.3.cmml" xref="S4.Ex9.m1.1.1.4.3">2</cn></apply><apply id="S4.Ex9.m1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1"><minus id="S4.Ex9.m1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1.1"></minus><apply id="S4.Ex9.m1.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.Ex9.m1.1.1.1.1.1.2.2.cmml" xref="S4.Ex9.m1.1.1.1.1.1.2.2">ℎ</ci><ci id="S4.Ex9.m1.1.1.1.1.1.2.3.cmml" xref="S4.Ex9.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.Ex9.m1.1.1.1.1.1.3.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex9.m1.1.1.1.1.1.3.2.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3.2">ℎ</ci><apply id="S4.Ex9.m1.1.1.1.1.1.3.3.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3.3"><plus id="S4.Ex9.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3.3.1"></plus><ci id="S4.Ex9.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.Ex9.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.Ex9.m1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex9.m1.1c">\beta\,L_{2}(h_{t}-h_{t+1})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex9.m1.1d">italic_β italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - italic_h start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
<p id="S4.SS6.p1.9" class="ltx_p">where <math id="S4.SS6.p1.9.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS6.p1.9.m1.1a"><mi id="S4.SS6.p1.9.m1.1.1" xref="S4.SS6.p1.9.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.9.m1.1b"><ci id="S4.SS6.p1.9.m1.1.1.cmml" xref="S4.SS6.p1.9.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.9.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.9.m1.1d">italic_β</annotation></semantics></math> is a scaling coefficient.
As in <cite class="ltx_cite ltx_citemacro_citet">Merity et al. (<a href="#bib.bib27" title="" class="ltx_ref">2017</a>)</cite>, the AR and TAR loss are only applied to the output of the final RNN layer as opposed to being applied to all layers.
</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiment Details</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">For evaluating the impact of these approaches, we perform language modeling over a preprocessed version of the Penn Treebank (PTB) <cite class="ltx_cite ltx_citemacro_citep">(Mikolov et al., <a href="#bib.bib29" title="" class="ltx_ref">2010</a>)</cite> and the WikiText-2 (WT2) data set <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">PTB:</span> The Penn Treebank data set has long been a central data set for experimenting with language modeling.
The data set is heavily preprocessed and does not contain capital letters, numbers, or punctuation.
The vocabulary is also capped at 10,000 unique words, quite small in comparison to most modern datasets, which results in a large number of out of vocabulary (OoV) tokens.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">WT2:</span> WikiText-2 is sourced from curated Wikipedia articles and is approximately twice the size of the PTB data set.
The text is tokenized and processed using the Moses tokenizer <cite class="ltx_cite ltx_citemacro_citep">(Koehn et al., <a href="#bib.bib21" title="" class="ltx_ref">2007</a>)</cite>, frequently used for machine translation, and features a vocabulary of over 30,000 words.
Capitalization, punctuation, and numbers are retained in this data set.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.5" class="ltx_p">All experiments use a three-layer LSTM model with <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="1150" display="inline"><semantics id="S5.p4.1.m1.1a"><mn id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">1150</mn><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><cn type="integer" id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">1150</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">1150</annotation><annotation encoding="application/x-llamapun" id="S5.p4.1.m1.1d">1150</annotation></semantics></math> units in the hidden layer and
an embedding of size <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="400" display="inline"><semantics id="S5.p4.2.m2.1a"><mn id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><cn type="integer" id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">400</annotation><annotation encoding="application/x-llamapun" id="S5.p4.2.m2.1d">400</annotation></semantics></math>. The loss was averaged over all examples and timesteps.
All embedding weights were uniformly initialized in the interval <math id="S5.p4.3.m3.2" class="ltx_Math" alttext="[-0.1,0.1]" display="inline"><semantics id="S5.p4.3.m3.2a"><mrow id="S5.p4.3.m3.2.2.1" xref="S5.p4.3.m3.2.2.2.cmml"><mo stretchy="false" id="S5.p4.3.m3.2.2.1.2" xref="S5.p4.3.m3.2.2.2.cmml">[</mo><mrow id="S5.p4.3.m3.2.2.1.1" xref="S5.p4.3.m3.2.2.1.1.cmml"><mo id="S5.p4.3.m3.2.2.1.1.1" xref="S5.p4.3.m3.2.2.1.1.1.cmml">-</mo><mn id="S5.p4.3.m3.2.2.1.1.2" xref="S5.p4.3.m3.2.2.1.1.2.cmml">0.1</mn></mrow><mo id="S5.p4.3.m3.2.2.1.3" xref="S5.p4.3.m3.2.2.2.cmml">,</mo><mn id="S5.p4.3.m3.1.1" xref="S5.p4.3.m3.1.1.cmml">0.1</mn><mo stretchy="false" id="S5.p4.3.m3.2.2.1.4" xref="S5.p4.3.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.3.m3.2b"><interval closure="closed" id="S5.p4.3.m3.2.2.2.cmml" xref="S5.p4.3.m3.2.2.1"><apply id="S5.p4.3.m3.2.2.1.1.cmml" xref="S5.p4.3.m3.2.2.1.1"><minus id="S5.p4.3.m3.2.2.1.1.1.cmml" xref="S5.p4.3.m3.2.2.1.1.1"></minus><cn type="float" id="S5.p4.3.m3.2.2.1.1.2.cmml" xref="S5.p4.3.m3.2.2.1.1.2">0.1</cn></apply><cn type="float" id="S5.p4.3.m3.1.1.cmml" xref="S5.p4.3.m3.1.1">0.1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.3.m3.2c">[-0.1,0.1]</annotation><annotation encoding="application/x-llamapun" id="S5.p4.3.m3.2d">[ - 0.1 , 0.1 ]</annotation></semantics></math> and all other weights were initialized between <math id="S5.p4.4.m4.2" class="ltx_Math" alttext="[-\frac{1}{\sqrt{H}},\frac{1}{\sqrt{H}}]" display="inline"><semantics id="S5.p4.4.m4.2a"><mrow id="S5.p4.4.m4.2.2.1" xref="S5.p4.4.m4.2.2.2.cmml"><mo stretchy="false" id="S5.p4.4.m4.2.2.1.2" xref="S5.p4.4.m4.2.2.2.cmml">[</mo><mrow id="S5.p4.4.m4.2.2.1.1" xref="S5.p4.4.m4.2.2.1.1.cmml"><mo id="S5.p4.4.m4.2.2.1.1.1" xref="S5.p4.4.m4.2.2.1.1.1.cmml">-</mo><mfrac id="S5.p4.4.m4.2.2.1.1.2" xref="S5.p4.4.m4.2.2.1.1.2.cmml"><mn id="S5.p4.4.m4.2.2.1.1.2.2" xref="S5.p4.4.m4.2.2.1.1.2.2.cmml">1</mn><msqrt id="S5.p4.4.m4.2.2.1.1.2.3" xref="S5.p4.4.m4.2.2.1.1.2.3.cmml"><mi id="S5.p4.4.m4.2.2.1.1.2.3.2" xref="S5.p4.4.m4.2.2.1.1.2.3.2.cmml">H</mi></msqrt></mfrac></mrow><mo id="S5.p4.4.m4.2.2.1.3" xref="S5.p4.4.m4.2.2.2.cmml">,</mo><mfrac id="S5.p4.4.m4.1.1" xref="S5.p4.4.m4.1.1.cmml"><mn id="S5.p4.4.m4.1.1.2" xref="S5.p4.4.m4.1.1.2.cmml">1</mn><msqrt id="S5.p4.4.m4.1.1.3" xref="S5.p4.4.m4.1.1.3.cmml"><mi id="S5.p4.4.m4.1.1.3.2" xref="S5.p4.4.m4.1.1.3.2.cmml">H</mi></msqrt></mfrac><mo stretchy="false" id="S5.p4.4.m4.2.2.1.4" xref="S5.p4.4.m4.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.4.m4.2b"><interval closure="closed" id="S5.p4.4.m4.2.2.2.cmml" xref="S5.p4.4.m4.2.2.1"><apply id="S5.p4.4.m4.2.2.1.1.cmml" xref="S5.p4.4.m4.2.2.1.1"><minus id="S5.p4.4.m4.2.2.1.1.1.cmml" xref="S5.p4.4.m4.2.2.1.1.1"></minus><apply id="S5.p4.4.m4.2.2.1.1.2.cmml" xref="S5.p4.4.m4.2.2.1.1.2"><divide id="S5.p4.4.m4.2.2.1.1.2.1.cmml" xref="S5.p4.4.m4.2.2.1.1.2"></divide><cn type="integer" id="S5.p4.4.m4.2.2.1.1.2.2.cmml" xref="S5.p4.4.m4.2.2.1.1.2.2">1</cn><apply id="S5.p4.4.m4.2.2.1.1.2.3.cmml" xref="S5.p4.4.m4.2.2.1.1.2.3"><root id="S5.p4.4.m4.2.2.1.1.2.3a.cmml" xref="S5.p4.4.m4.2.2.1.1.2.3"></root><ci id="S5.p4.4.m4.2.2.1.1.2.3.2.cmml" xref="S5.p4.4.m4.2.2.1.1.2.3.2">𝐻</ci></apply></apply></apply><apply id="S5.p4.4.m4.1.1.cmml" xref="S5.p4.4.m4.1.1"><divide id="S5.p4.4.m4.1.1.1.cmml" xref="S5.p4.4.m4.1.1"></divide><cn type="integer" id="S5.p4.4.m4.1.1.2.cmml" xref="S5.p4.4.m4.1.1.2">1</cn><apply id="S5.p4.4.m4.1.1.3.cmml" xref="S5.p4.4.m4.1.1.3"><root id="S5.p4.4.m4.1.1.3a.cmml" xref="S5.p4.4.m4.1.1.3"></root><ci id="S5.p4.4.m4.1.1.3.2.cmml" xref="S5.p4.4.m4.1.1.3.2">𝐻</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.4.m4.2c">[-\frac{1}{\sqrt{H}},\frac{1}{\sqrt{H}}]</annotation><annotation encoding="application/x-llamapun" id="S5.p4.4.m4.2d">[ - divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_H end_ARG end_ARG , divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_H end_ARG end_ARG ]</annotation></semantics></math>, where <math id="S5.p4.5.m5.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S5.p4.5.m5.1a"><mi id="S5.p4.5.m5.1.1" xref="S5.p4.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S5.p4.5.m5.1b"><ci id="S5.p4.5.m5.1.1.cmml" xref="S5.p4.5.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.5.m5.1c">H</annotation><annotation encoding="application/x-llamapun" id="S5.p4.5.m5.1d">italic_H</annotation></semantics></math> is the hidden size.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.11" class="ltx_p">For training the models, we use the NT-ASGD algorithm discussed in the previous section for <math id="S5.p5.1.m1.1" class="ltx_Math" alttext="750" display="inline"><semantics id="S5.p5.1.m1.1a"><mn id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">750</mn><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><cn type="integer" id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">750</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">750</annotation><annotation encoding="application/x-llamapun" id="S5.p5.1.m1.1d">750</annotation></semantics></math> epochs with <math id="S5.p5.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S5.p5.2.m2.1a"><mi id="S5.p5.2.m2.1.1" xref="S5.p5.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.p5.2.m2.1b"><ci id="S5.p5.2.m2.1.1.cmml" xref="S5.p5.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S5.p5.2.m2.1d">italic_L</annotation></semantics></math> equivalent to one epoch and <math id="S5.p5.3.m3.1" class="ltx_Math" alttext="n=5" display="inline"><semantics id="S5.p5.3.m3.1a"><mrow id="S5.p5.3.m3.1.1" xref="S5.p5.3.m3.1.1.cmml"><mi id="S5.p5.3.m3.1.1.2" xref="S5.p5.3.m3.1.1.2.cmml">n</mi><mo id="S5.p5.3.m3.1.1.1" xref="S5.p5.3.m3.1.1.1.cmml">=</mo><mn id="S5.p5.3.m3.1.1.3" xref="S5.p5.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.3.m3.1b"><apply id="S5.p5.3.m3.1.1.cmml" xref="S5.p5.3.m3.1.1"><eq id="S5.p5.3.m3.1.1.1.cmml" xref="S5.p5.3.m3.1.1.1"></eq><ci id="S5.p5.3.m3.1.1.2.cmml" xref="S5.p5.3.m3.1.1.2">𝑛</ci><cn type="integer" id="S5.p5.3.m3.1.1.3.cmml" xref="S5.p5.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.3.m3.1c">n=5</annotation><annotation encoding="application/x-llamapun" id="S5.p5.3.m3.1d">italic_n = 5</annotation></semantics></math>. We use a batch size of <math id="S5.p5.4.m4.1" class="ltx_Math" alttext="80" display="inline"><semantics id="S5.p5.4.m4.1a"><mn id="S5.p5.4.m4.1.1" xref="S5.p5.4.m4.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S5.p5.4.m4.1b"><cn type="integer" id="S5.p5.4.m4.1.1.cmml" xref="S5.p5.4.m4.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.4.m4.1c">80</annotation><annotation encoding="application/x-llamapun" id="S5.p5.4.m4.1d">80</annotation></semantics></math> for WT2 and <math id="S5.p5.5.m5.1" class="ltx_Math" alttext="40" display="inline"><semantics id="S5.p5.5.m5.1a"><mn id="S5.p5.5.m5.1.1" xref="S5.p5.5.m5.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S5.p5.5.m5.1b"><cn type="integer" id="S5.p5.5.m5.1.1.cmml" xref="S5.p5.5.m5.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.5.m5.1c">40</annotation><annotation encoding="application/x-llamapun" id="S5.p5.5.m5.1d">40</annotation></semantics></math> for PTB. Empirically, we found relatively large batch sizes (e.g., <math id="S5.p5.6.m6.1" class="ltx_Math" alttext="40" display="inline"><semantics id="S5.p5.6.m6.1a"><mn id="S5.p5.6.m6.1.1" xref="S5.p5.6.m6.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S5.p5.6.m6.1b"><cn type="integer" id="S5.p5.6.m6.1.1.cmml" xref="S5.p5.6.m6.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.6.m6.1c">40</annotation><annotation encoding="application/x-llamapun" id="S5.p5.6.m6.1d">40</annotation></semantics></math>-<math id="S5.p5.7.m7.1" class="ltx_Math" alttext="80" display="inline"><semantics id="S5.p5.7.m7.1a"><mn id="S5.p5.7.m7.1.1" xref="S5.p5.7.m7.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="S5.p5.7.m7.1b"><cn type="integer" id="S5.p5.7.m7.1.1.cmml" xref="S5.p5.7.m7.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.7.m7.1c">80</annotation><annotation encoding="application/x-llamapun" id="S5.p5.7.m7.1d">80</annotation></semantics></math>) performed better than smaller sizes (e.g., <math id="S5.p5.8.m8.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.p5.8.m8.1a"><mn id="S5.p5.8.m8.1.1" xref="S5.p5.8.m8.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.p5.8.m8.1b"><cn type="integer" id="S5.p5.8.m8.1.1.cmml" xref="S5.p5.8.m8.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.8.m8.1c">10</annotation><annotation encoding="application/x-llamapun" id="S5.p5.8.m8.1d">10</annotation></semantics></math>-<math id="S5.p5.9.m9.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S5.p5.9.m9.1a"><mn id="S5.p5.9.m9.1.1" xref="S5.p5.9.m9.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S5.p5.9.m9.1b"><cn type="integer" id="S5.p5.9.m9.1.1.cmml" xref="S5.p5.9.m9.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.9.m9.1c">20</annotation><annotation encoding="application/x-llamapun" id="S5.p5.9.m9.1d">20</annotation></semantics></math>) for NT-ASGD. After completion, we run ASGD with <math id="S5.p5.10.m10.1" class="ltx_Math" alttext="T=0" display="inline"><semantics id="S5.p5.10.m10.1a"><mrow id="S5.p5.10.m10.1.1" xref="S5.p5.10.m10.1.1.cmml"><mi id="S5.p5.10.m10.1.1.2" xref="S5.p5.10.m10.1.1.2.cmml">T</mi><mo id="S5.p5.10.m10.1.1.1" xref="S5.p5.10.m10.1.1.1.cmml">=</mo><mn id="S5.p5.10.m10.1.1.3" xref="S5.p5.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.10.m10.1b"><apply id="S5.p5.10.m10.1.1.cmml" xref="S5.p5.10.m10.1.1"><eq id="S5.p5.10.m10.1.1.1.cmml" xref="S5.p5.10.m10.1.1.1"></eq><ci id="S5.p5.10.m10.1.1.2.cmml" xref="S5.p5.10.m10.1.1.2">𝑇</ci><cn type="integer" id="S5.p5.10.m10.1.1.3.cmml" xref="S5.p5.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.10.m10.1c">T=0</annotation><annotation encoding="application/x-llamapun" id="S5.p5.10.m10.1d">italic_T = 0</annotation></semantics></math> and hot-started <math id="S5.p5.11.m11.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="S5.p5.11.m11.1a"><msub id="S5.p5.11.m11.1.1" xref="S5.p5.11.m11.1.1.cmml"><mi id="S5.p5.11.m11.1.1.2" xref="S5.p5.11.m11.1.1.2.cmml">w</mi><mn id="S5.p5.11.m11.1.1.3" xref="S5.p5.11.m11.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p5.11.m11.1b"><apply id="S5.p5.11.m11.1.1.cmml" xref="S5.p5.11.m11.1.1"><csymbol cd="ambiguous" id="S5.p5.11.m11.1.1.1.cmml" xref="S5.p5.11.m11.1.1">subscript</csymbol><ci id="S5.p5.11.m11.1.1.2.cmml" xref="S5.p5.11.m11.1.1.2">𝑤</ci><cn type="integer" id="S5.p5.11.m11.1.1.3.cmml" xref="S5.p5.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.11.m11.1c">w_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.p5.11.m11.1d">italic_w start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> as a fine-tuning step to further improve the solution. For this fine-tuning step, we terminate the run using the same non-monotonic criterion detailed in Algorithm 1.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.11" class="ltx_p">We carry out gradient clipping with maximum norm <math id="S5.p6.1.m1.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="S5.p6.1.m1.1a"><mn id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.1b"><cn type="float" id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.m1.1c">0.25</annotation><annotation encoding="application/x-llamapun" id="S5.p6.1.m1.1d">0.25</annotation></semantics></math> and use an initial learning rate of <math id="S5.p6.2.m2.1" class="ltx_Math" alttext="30" display="inline"><semantics id="S5.p6.2.m2.1a"><mn id="S5.p6.2.m2.1.1" xref="S5.p6.2.m2.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S5.p6.2.m2.1b"><cn type="integer" id="S5.p6.2.m2.1.1.cmml" xref="S5.p6.2.m2.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.2.m2.1c">30</annotation><annotation encoding="application/x-llamapun" id="S5.p6.2.m2.1d">30</annotation></semantics></math> for all experiments.
We use a random BPTT length which is <math id="S5.p6.3.m3.2" class="ltx_Math" alttext="\mathcal{N}(70,5)" display="inline"><semantics id="S5.p6.3.m3.2a"><mrow id="S5.p6.3.m3.2.3" xref="S5.p6.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p6.3.m3.2.3.2" xref="S5.p6.3.m3.2.3.2.cmml">𝒩</mi><mo id="S5.p6.3.m3.2.3.1" xref="S5.p6.3.m3.2.3.1.cmml">⁢</mo><mrow id="S5.p6.3.m3.2.3.3.2" xref="S5.p6.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S5.p6.3.m3.2.3.3.2.1" xref="S5.p6.3.m3.2.3.3.1.cmml">(</mo><mn id="S5.p6.3.m3.1.1" xref="S5.p6.3.m3.1.1.cmml">70</mn><mo id="S5.p6.3.m3.2.3.3.2.2" xref="S5.p6.3.m3.2.3.3.1.cmml">,</mo><mn id="S5.p6.3.m3.2.2" xref="S5.p6.3.m3.2.2.cmml">5</mn><mo stretchy="false" id="S5.p6.3.m3.2.3.3.2.3" xref="S5.p6.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.3.m3.2b"><apply id="S5.p6.3.m3.2.3.cmml" xref="S5.p6.3.m3.2.3"><times id="S5.p6.3.m3.2.3.1.cmml" xref="S5.p6.3.m3.2.3.1"></times><ci id="S5.p6.3.m3.2.3.2.cmml" xref="S5.p6.3.m3.2.3.2">𝒩</ci><interval closure="open" id="S5.p6.3.m3.2.3.3.1.cmml" xref="S5.p6.3.m3.2.3.3.2"><cn type="integer" id="S5.p6.3.m3.1.1.cmml" xref="S5.p6.3.m3.1.1">70</cn><cn type="integer" id="S5.p6.3.m3.2.2.cmml" xref="S5.p6.3.m3.2.2">5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.3.m3.2c">\mathcal{N}(70,5)</annotation><annotation encoding="application/x-llamapun" id="S5.p6.3.m3.2d">caligraphic_N ( 70 , 5 )</annotation></semantics></math> with probability <math id="S5.p6.4.m4.1" class="ltx_Math" alttext="0.95" display="inline"><semantics id="S5.p6.4.m4.1a"><mn id="S5.p6.4.m4.1.1" xref="S5.p6.4.m4.1.1.cmml">0.95</mn><annotation-xml encoding="MathML-Content" id="S5.p6.4.m4.1b"><cn type="float" id="S5.p6.4.m4.1.1.cmml" xref="S5.p6.4.m4.1.1">0.95</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.4.m4.1c">0.95</annotation><annotation encoding="application/x-llamapun" id="S5.p6.4.m4.1d">0.95</annotation></semantics></math> and <math id="S5.p6.5.m5.2" class="ltx_Math" alttext="\mathcal{N}(35,5)" display="inline"><semantics id="S5.p6.5.m5.2a"><mrow id="S5.p6.5.m5.2.3" xref="S5.p6.5.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p6.5.m5.2.3.2" xref="S5.p6.5.m5.2.3.2.cmml">𝒩</mi><mo id="S5.p6.5.m5.2.3.1" xref="S5.p6.5.m5.2.3.1.cmml">⁢</mo><mrow id="S5.p6.5.m5.2.3.3.2" xref="S5.p6.5.m5.2.3.3.1.cmml"><mo stretchy="false" id="S5.p6.5.m5.2.3.3.2.1" xref="S5.p6.5.m5.2.3.3.1.cmml">(</mo><mn id="S5.p6.5.m5.1.1" xref="S5.p6.5.m5.1.1.cmml">35</mn><mo id="S5.p6.5.m5.2.3.3.2.2" xref="S5.p6.5.m5.2.3.3.1.cmml">,</mo><mn id="S5.p6.5.m5.2.2" xref="S5.p6.5.m5.2.2.cmml">5</mn><mo stretchy="false" id="S5.p6.5.m5.2.3.3.2.3" xref="S5.p6.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.5.m5.2b"><apply id="S5.p6.5.m5.2.3.cmml" xref="S5.p6.5.m5.2.3"><times id="S5.p6.5.m5.2.3.1.cmml" xref="S5.p6.5.m5.2.3.1"></times><ci id="S5.p6.5.m5.2.3.2.cmml" xref="S5.p6.5.m5.2.3.2">𝒩</ci><interval closure="open" id="S5.p6.5.m5.2.3.3.1.cmml" xref="S5.p6.5.m5.2.3.3.2"><cn type="integer" id="S5.p6.5.m5.1.1.cmml" xref="S5.p6.5.m5.1.1">35</cn><cn type="integer" id="S5.p6.5.m5.2.2.cmml" xref="S5.p6.5.m5.2.2">5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.5.m5.2c">\mathcal{N}(35,5)</annotation><annotation encoding="application/x-llamapun" id="S5.p6.5.m5.2d">caligraphic_N ( 35 , 5 )</annotation></semantics></math> with probability <math id="S5.p6.6.m6.1" class="ltx_Math" alttext="0.05" display="inline"><semantics id="S5.p6.6.m6.1a"><mn id="S5.p6.6.m6.1.1" xref="S5.p6.6.m6.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S5.p6.6.m6.1b"><cn type="float" id="S5.p6.6.m6.1.1.cmml" xref="S5.p6.6.m6.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.6.m6.1c">0.05</annotation><annotation encoding="application/x-llamapun" id="S5.p6.6.m6.1d">0.05</annotation></semantics></math>.
The values used for dropout on the word vectors, the output between LSTM layers, the output of the final LSTM layer, and embedding dropout where <math id="S5.p6.7.m7.4" class="ltx_Math" alttext="(0.4,0.3,0.4,0.1)" display="inline"><semantics id="S5.p6.7.m7.4a"><mrow id="S5.p6.7.m7.4.5.2" xref="S5.p6.7.m7.4.5.1.cmml"><mo stretchy="false" id="S5.p6.7.m7.4.5.2.1" xref="S5.p6.7.m7.4.5.1.cmml">(</mo><mn id="S5.p6.7.m7.1.1" xref="S5.p6.7.m7.1.1.cmml">0.4</mn><mo id="S5.p6.7.m7.4.5.2.2" xref="S5.p6.7.m7.4.5.1.cmml">,</mo><mn id="S5.p6.7.m7.2.2" xref="S5.p6.7.m7.2.2.cmml">0.3</mn><mo id="S5.p6.7.m7.4.5.2.3" xref="S5.p6.7.m7.4.5.1.cmml">,</mo><mn id="S5.p6.7.m7.3.3" xref="S5.p6.7.m7.3.3.cmml">0.4</mn><mo id="S5.p6.7.m7.4.5.2.4" xref="S5.p6.7.m7.4.5.1.cmml">,</mo><mn id="S5.p6.7.m7.4.4" xref="S5.p6.7.m7.4.4.cmml">0.1</mn><mo stretchy="false" id="S5.p6.7.m7.4.5.2.5" xref="S5.p6.7.m7.4.5.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p6.7.m7.4b"><vector id="S5.p6.7.m7.4.5.1.cmml" xref="S5.p6.7.m7.4.5.2"><cn type="float" id="S5.p6.7.m7.1.1.cmml" xref="S5.p6.7.m7.1.1">0.4</cn><cn type="float" id="S5.p6.7.m7.2.2.cmml" xref="S5.p6.7.m7.2.2">0.3</cn><cn type="float" id="S5.p6.7.m7.3.3.cmml" xref="S5.p6.7.m7.3.3">0.4</cn><cn type="float" id="S5.p6.7.m7.4.4.cmml" xref="S5.p6.7.m7.4.4">0.1</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.7.m7.4c">(0.4,0.3,0.4,0.1)</annotation><annotation encoding="application/x-llamapun" id="S5.p6.7.m7.4d">( 0.4 , 0.3 , 0.4 , 0.1 )</annotation></semantics></math> respectively.
For the weight-dropped LSTM, a dropout of <math id="S5.p6.8.m8.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S5.p6.8.m8.1a"><mn id="S5.p6.8.m8.1.1" xref="S5.p6.8.m8.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S5.p6.8.m8.1b"><cn type="float" id="S5.p6.8.m8.1.1.cmml" xref="S5.p6.8.m8.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.8.m8.1c">0.5</annotation><annotation encoding="application/x-llamapun" id="S5.p6.8.m8.1d">0.5</annotation></semantics></math> was applied to the recurrent weight matrices.
For WT2, we increase the input dropout to <math id="S5.p6.9.m9.1" class="ltx_Math" alttext="0.65" display="inline"><semantics id="S5.p6.9.m9.1a"><mn id="S5.p6.9.m9.1.1" xref="S5.p6.9.m9.1.1.cmml">0.65</mn><annotation-xml encoding="MathML-Content" id="S5.p6.9.m9.1b"><cn type="float" id="S5.p6.9.m9.1.1.cmml" xref="S5.p6.9.m9.1.1">0.65</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.9.m9.1c">0.65</annotation><annotation encoding="application/x-llamapun" id="S5.p6.9.m9.1d">0.65</annotation></semantics></math> to account for the increased vocabulary size.
For all experiments, we use AR and TAR values of <math id="S5.p6.10.m10.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S5.p6.10.m10.1a"><mn id="S5.p6.10.m10.1.1" xref="S5.p6.10.m10.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S5.p6.10.m10.1b"><cn type="integer" id="S5.p6.10.m10.1.1.cmml" xref="S5.p6.10.m10.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.10.m10.1c">2</annotation><annotation encoding="application/x-llamapun" id="S5.p6.10.m10.1d">2</annotation></semantics></math> and <math id="S5.p6.11.m11.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.p6.11.m11.1a"><mn id="S5.p6.11.m11.1.1" xref="S5.p6.11.m11.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.p6.11.m11.1b"><cn type="integer" id="S5.p6.11.m11.1.1.cmml" xref="S5.p6.11.m11.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.11.m11.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.p6.11.m11.1d">1</annotation></semantics></math> respectively, and tie the embedding and softmax weights.
These hyperparameters were chosen through trial and error and we expect further improvements may be possible if a fine-grained hyperparameter search were to be conducted.
In the results, we abbreviate our approach as AWD-LSTM for ASGD Weight-Dropped LSTM.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.53" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.53.54.1" class="ltx_tr">
<th id="S5.T1.53.54.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="S5.T1.53.54.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S5.T1.53.54.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.53.54.1.2.1" class="ltx_text ltx_font_bold">Parameters</span></th>
<th id="S5.T1.53.54.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.53.54.1.3.1" class="ltx_text ltx_font_bold">Validation</span></th>
<th id="S5.T1.53.54.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T1.53.54.1.4.1" class="ltx_text ltx_font_bold">Test</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.3.3" class="ltx_tr">
<td id="S5.T1.3.3.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<cite class="ltx_cite ltx_citemacro_citet">Mikolov &amp; Zweig (<a href="#bib.bib28" title="" class="ltx_ref">2012</a>)</cite> - KN-5</td>
<td id="S5.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">2M<math id="S5.T1.1.1.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S5.T1.1.1.1.m1.1a"><msup id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml"><mi id="S5.T1.1.1.1.m1.1.1a" xref="S5.T1.1.1.1.m1.1.1.cmml"></mi><mo id="S5.T1.1.1.1.m1.1.1.1" xref="S5.T1.1.1.1.m1.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><apply id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1"><ci id="S5.T1.1.1.1.m1.1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.1.1.1.m1.1d">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S5.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.2.2.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.2.2.2.m1.1a"><mo id="S5.T1.2.2.2.m1.1.1" xref="S5.T1.2.2.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.m1.1b"><minus id="S5.T1.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.2.2.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.3.3.3.m1.1" class="ltx_Math" alttext="141.2" display="inline"><semantics id="S5.T1.3.3.3.m1.1a"><mn id="S5.T1.3.3.3.m1.1.1" xref="S5.T1.3.3.3.m1.1.1.cmml">141.2</mn><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.m1.1b"><cn type="float" id="S5.T1.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.m1.1.1">141.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.m1.1c">141.2</annotation><annotation encoding="application/x-llamapun" id="S5.T1.3.3.3.m1.1d">141.2</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.6.6" class="ltx_tr">
<td id="S5.T1.6.6.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Mikolov &amp; Zweig (<a href="#bib.bib28" title="" class="ltx_ref">2012</a>)</cite> - KN5 + cache</td>
<td id="S5.T1.4.4.1" class="ltx_td ltx_align_center">2M<math id="S5.T1.4.4.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S5.T1.4.4.1.m1.1a"><msup id="S5.T1.4.4.1.m1.1.1" xref="S5.T1.4.4.1.m1.1.1.cmml"><mi id="S5.T1.4.4.1.m1.1.1a" xref="S5.T1.4.4.1.m1.1.1.cmml"></mi><mo id="S5.T1.4.4.1.m1.1.1.1" xref="S5.T1.4.4.1.m1.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.1.m1.1b"><apply id="S5.T1.4.4.1.m1.1.1.cmml" xref="S5.T1.4.4.1.m1.1.1"><ci id="S5.T1.4.4.1.m1.1.1.1.cmml" xref="S5.T1.4.4.1.m1.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.1.m1.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.4.4.1.m1.1d">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S5.T1.5.5.2" class="ltx_td ltx_align_center"><math id="S5.T1.5.5.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.5.5.2.m1.1a"><mo id="S5.T1.5.5.2.m1.1.1" xref="S5.T1.5.5.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.2.m1.1b"><minus id="S5.T1.5.5.2.m1.1.1.cmml" xref="S5.T1.5.5.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.5.5.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.6.6.3" class="ltx_td ltx_align_center"><math id="S5.T1.6.6.3.m1.1" class="ltx_Math" alttext="125.7" display="inline"><semantics id="S5.T1.6.6.3.m1.1a"><mn id="S5.T1.6.6.3.m1.1.1" xref="S5.T1.6.6.3.m1.1.1.cmml">125.7</mn><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.3.m1.1b"><cn type="float" id="S5.T1.6.6.3.m1.1.1.cmml" xref="S5.T1.6.6.3.m1.1.1">125.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.3.m1.1c">125.7</annotation><annotation encoding="application/x-llamapun" id="S5.T1.6.6.3.m1.1d">125.7</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.9.9" class="ltx_tr">
<td id="S5.T1.9.9.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Mikolov &amp; Zweig (<a href="#bib.bib28" title="" class="ltx_ref">2012</a>)</cite> - RNN</td>
<td id="S5.T1.7.7.1" class="ltx_td ltx_align_center">6M<math id="S5.T1.7.7.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S5.T1.7.7.1.m1.1a"><msup id="S5.T1.7.7.1.m1.1.1" xref="S5.T1.7.7.1.m1.1.1.cmml"><mi id="S5.T1.7.7.1.m1.1.1a" xref="S5.T1.7.7.1.m1.1.1.cmml"></mi><mo id="S5.T1.7.7.1.m1.1.1.1" xref="S5.T1.7.7.1.m1.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.1.m1.1b"><apply id="S5.T1.7.7.1.m1.1.1.cmml" xref="S5.T1.7.7.1.m1.1.1"><ci id="S5.T1.7.7.1.m1.1.1.1.cmml" xref="S5.T1.7.7.1.m1.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.1.m1.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.7.7.1.m1.1d">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S5.T1.8.8.2" class="ltx_td ltx_align_center"><math id="S5.T1.8.8.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.8.8.2.m1.1a"><mo id="S5.T1.8.8.2.m1.1.1" xref="S5.T1.8.8.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.2.m1.1b"><minus id="S5.T1.8.8.2.m1.1.1.cmml" xref="S5.T1.8.8.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.8.8.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.9.9.3" class="ltx_td ltx_align_center"><math id="S5.T1.9.9.3.m1.1" class="ltx_Math" alttext="124.7" display="inline"><semantics id="S5.T1.9.9.3.m1.1a"><mn id="S5.T1.9.9.3.m1.1.1" xref="S5.T1.9.9.3.m1.1.1.cmml">124.7</mn><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.3.m1.1b"><cn type="float" id="S5.T1.9.9.3.m1.1.1.cmml" xref="S5.T1.9.9.3.m1.1.1">124.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.3.m1.1c">124.7</annotation><annotation encoding="application/x-llamapun" id="S5.T1.9.9.3.m1.1d">124.7</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.12.12" class="ltx_tr">
<td id="S5.T1.12.12.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Mikolov &amp; Zweig (<a href="#bib.bib28" title="" class="ltx_ref">2012</a>)</cite> - RNN-LDA</td>
<td id="S5.T1.10.10.1" class="ltx_td ltx_align_center">7M<math id="S5.T1.10.10.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S5.T1.10.10.1.m1.1a"><msup id="S5.T1.10.10.1.m1.1.1" xref="S5.T1.10.10.1.m1.1.1.cmml"><mi id="S5.T1.10.10.1.m1.1.1a" xref="S5.T1.10.10.1.m1.1.1.cmml"></mi><mo id="S5.T1.10.10.1.m1.1.1.1" xref="S5.T1.10.10.1.m1.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T1.10.10.1.m1.1b"><apply id="S5.T1.10.10.1.m1.1.1.cmml" xref="S5.T1.10.10.1.m1.1.1"><ci id="S5.T1.10.10.1.m1.1.1.1.cmml" xref="S5.T1.10.10.1.m1.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.10.1.m1.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.10.10.1.m1.1d">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S5.T1.11.11.2" class="ltx_td ltx_align_center"><math id="S5.T1.11.11.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.11.11.2.m1.1a"><mo id="S5.T1.11.11.2.m1.1.1" xref="S5.T1.11.11.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.11.11.2.m1.1b"><minus id="S5.T1.11.11.2.m1.1.1.cmml" xref="S5.T1.11.11.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.11.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.11.11.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.12.12.3" class="ltx_td ltx_align_center"><math id="S5.T1.12.12.3.m1.1" class="ltx_Math" alttext="113.7" display="inline"><semantics id="S5.T1.12.12.3.m1.1a"><mn id="S5.T1.12.12.3.m1.1.1" xref="S5.T1.12.12.3.m1.1.1.cmml">113.7</mn><annotation-xml encoding="MathML-Content" id="S5.T1.12.12.3.m1.1b"><cn type="float" id="S5.T1.12.12.3.m1.1.1.cmml" xref="S5.T1.12.12.3.m1.1.1">113.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.12.3.m1.1c">113.7</annotation><annotation encoding="application/x-llamapun" id="S5.T1.12.12.3.m1.1d">113.7</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.15.15" class="ltx_tr">
<td id="S5.T1.15.15.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Mikolov &amp; Zweig (<a href="#bib.bib28" title="" class="ltx_ref">2012</a>)</cite> - RNN-LDA + KN-5 + cache</td>
<td id="S5.T1.13.13.1" class="ltx_td ltx_align_center">9M<math id="S5.T1.13.13.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="S5.T1.13.13.1.m1.1a"><msup id="S5.T1.13.13.1.m1.1.1" xref="S5.T1.13.13.1.m1.1.1.cmml"><mi id="S5.T1.13.13.1.m1.1.1a" xref="S5.T1.13.13.1.m1.1.1.cmml"></mi><mo id="S5.T1.13.13.1.m1.1.1.1" xref="S5.T1.13.13.1.m1.1.1.1.cmml">‡</mo></msup><annotation-xml encoding="MathML-Content" id="S5.T1.13.13.1.m1.1b"><apply id="S5.T1.13.13.1.m1.1.1.cmml" xref="S5.T1.13.13.1.m1.1.1"><ci id="S5.T1.13.13.1.m1.1.1.1.cmml" xref="S5.T1.13.13.1.m1.1.1.1">‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.13.1.m1.1c">{}^{\ddagger}</annotation><annotation encoding="application/x-llamapun" id="S5.T1.13.13.1.m1.1d">start_FLOATSUPERSCRIPT ‡ end_FLOATSUPERSCRIPT</annotation></semantics></math>
</td>
<td id="S5.T1.14.14.2" class="ltx_td ltx_align_center"><math id="S5.T1.14.14.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.14.14.2.m1.1a"><mo id="S5.T1.14.14.2.m1.1.1" xref="S5.T1.14.14.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.14.2.m1.1b"><minus id="S5.T1.14.14.2.m1.1.1.cmml" xref="S5.T1.14.14.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.14.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.14.14.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.15.15.3" class="ltx_td ltx_align_center"><math id="S5.T1.15.15.3.m1.1" class="ltx_Math" alttext="92.0" display="inline"><semantics id="S5.T1.15.15.3.m1.1a"><mn id="S5.T1.15.15.3.m1.1.1" xref="S5.T1.15.15.3.m1.1.1.cmml">92.0</mn><annotation-xml encoding="MathML-Content" id="S5.T1.15.15.3.m1.1b"><cn type="float" id="S5.T1.15.15.3.m1.1.1.cmml" xref="S5.T1.15.15.3.m1.1.1">92.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.15.3.m1.1c">92.0</annotation><annotation encoding="application/x-llamapun" id="S5.T1.15.15.3.m1.1d">92.0</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.17.17" class="ltx_tr">
<td id="S5.T1.17.17.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Zaremba et al. (<a href="#bib.bib42" title="" class="ltx_ref">2014</a>)</cite> - LSTM (medium)</td>
<td id="S5.T1.17.17.4" class="ltx_td ltx_align_center">20M</td>
<td id="S5.T1.16.16.1" class="ltx_td ltx_align_center"><math id="S5.T1.16.16.1.m1.1" class="ltx_Math" alttext="86.2" display="inline"><semantics id="S5.T1.16.16.1.m1.1a"><mn id="S5.T1.16.16.1.m1.1.1" xref="S5.T1.16.16.1.m1.1.1.cmml">86.2</mn><annotation-xml encoding="MathML-Content" id="S5.T1.16.16.1.m1.1b"><cn type="float" id="S5.T1.16.16.1.m1.1.1.cmml" xref="S5.T1.16.16.1.m1.1.1">86.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.16.1.m1.1c">86.2</annotation><annotation encoding="application/x-llamapun" id="S5.T1.16.16.1.m1.1d">86.2</annotation></semantics></math></td>
<td id="S5.T1.17.17.2" class="ltx_td ltx_align_center"><math id="S5.T1.17.17.2.m1.1" class="ltx_Math" alttext="82.7" display="inline"><semantics id="S5.T1.17.17.2.m1.1a"><mn id="S5.T1.17.17.2.m1.1.1" xref="S5.T1.17.17.2.m1.1.1.cmml">82.7</mn><annotation-xml encoding="MathML-Content" id="S5.T1.17.17.2.m1.1b"><cn type="float" id="S5.T1.17.17.2.m1.1.1.cmml" xref="S5.T1.17.17.2.m1.1.1">82.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.17.2.m1.1c">82.7</annotation><annotation encoding="application/x-llamapun" id="S5.T1.17.17.2.m1.1d">82.7</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.19.19" class="ltx_tr">
<td id="S5.T1.19.19.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Zaremba et al. (<a href="#bib.bib42" title="" class="ltx_ref">2014</a>)</cite> - LSTM (large)</td>
<td id="S5.T1.19.19.4" class="ltx_td ltx_align_center">66M</td>
<td id="S5.T1.18.18.1" class="ltx_td ltx_align_center"><math id="S5.T1.18.18.1.m1.1" class="ltx_Math" alttext="82.2" display="inline"><semantics id="S5.T1.18.18.1.m1.1a"><mn id="S5.T1.18.18.1.m1.1.1" xref="S5.T1.18.18.1.m1.1.1.cmml">82.2</mn><annotation-xml encoding="MathML-Content" id="S5.T1.18.18.1.m1.1b"><cn type="float" id="S5.T1.18.18.1.m1.1.1.cmml" xref="S5.T1.18.18.1.m1.1.1">82.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.18.1.m1.1c">82.2</annotation><annotation encoding="application/x-llamapun" id="S5.T1.18.18.1.m1.1d">82.2</annotation></semantics></math></td>
<td id="S5.T1.19.19.2" class="ltx_td ltx_align_center"><math id="S5.T1.19.19.2.m1.1" class="ltx_Math" alttext="78.4" display="inline"><semantics id="S5.T1.19.19.2.m1.1a"><mn id="S5.T1.19.19.2.m1.1.1" xref="S5.T1.19.19.2.m1.1.1.cmml">78.4</mn><annotation-xml encoding="MathML-Content" id="S5.T1.19.19.2.m1.1b"><cn type="float" id="S5.T1.19.19.2.m1.1.1.cmml" xref="S5.T1.19.19.2.m1.1.1">78.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.19.2.m1.1c">78.4</annotation><annotation encoding="application/x-llamapun" id="S5.T1.19.19.2.m1.1d">78.4</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.21.21" class="ltx_tr">
<td id="S5.T1.21.21.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Gal &amp; Ghahramani (<a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (medium)</td>
<td id="S5.T1.21.21.4" class="ltx_td ltx_align_center">20M</td>
<td id="S5.T1.20.20.1" class="ltx_td ltx_align_center"><math id="S5.T1.20.20.1.m1.1" class="ltx_Math" alttext="81.9\pm 0.2" display="inline"><semantics id="S5.T1.20.20.1.m1.1a"><mrow id="S5.T1.20.20.1.m1.1.1" xref="S5.T1.20.20.1.m1.1.1.cmml"><mn id="S5.T1.20.20.1.m1.1.1.2" xref="S5.T1.20.20.1.m1.1.1.2.cmml">81.9</mn><mo id="S5.T1.20.20.1.m1.1.1.1" xref="S5.T1.20.20.1.m1.1.1.1.cmml">±</mo><mn id="S5.T1.20.20.1.m1.1.1.3" xref="S5.T1.20.20.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.20.20.1.m1.1b"><apply id="S5.T1.20.20.1.m1.1.1.cmml" xref="S5.T1.20.20.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.20.20.1.m1.1.1.1.cmml" xref="S5.T1.20.20.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.20.20.1.m1.1.1.2.cmml" xref="S5.T1.20.20.1.m1.1.1.2">81.9</cn><cn type="float" id="S5.T1.20.20.1.m1.1.1.3.cmml" xref="S5.T1.20.20.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.20.1.m1.1c">81.9\pm 0.2</annotation><annotation encoding="application/x-llamapun" id="S5.T1.20.20.1.m1.1d">81.9 ± 0.2</annotation></semantics></math></td>
<td id="S5.T1.21.21.2" class="ltx_td ltx_align_center"><math id="S5.T1.21.21.2.m1.1" class="ltx_Math" alttext="79.7\pm 0.1" display="inline"><semantics id="S5.T1.21.21.2.m1.1a"><mrow id="S5.T1.21.21.2.m1.1.1" xref="S5.T1.21.21.2.m1.1.1.cmml"><mn id="S5.T1.21.21.2.m1.1.1.2" xref="S5.T1.21.21.2.m1.1.1.2.cmml">79.7</mn><mo id="S5.T1.21.21.2.m1.1.1.1" xref="S5.T1.21.21.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.21.21.2.m1.1.1.3" xref="S5.T1.21.21.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.21.21.2.m1.1b"><apply id="S5.T1.21.21.2.m1.1.1.cmml" xref="S5.T1.21.21.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.21.21.2.m1.1.1.1.cmml" xref="S5.T1.21.21.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.21.21.2.m1.1.1.2.cmml" xref="S5.T1.21.21.2.m1.1.1.2">79.7</cn><cn type="float" id="S5.T1.21.21.2.m1.1.1.3.cmml" xref="S5.T1.21.21.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.21.2.m1.1c">79.7\pm 0.1</annotation><annotation encoding="application/x-llamapun" id="S5.T1.21.21.2.m1.1d">79.7 ± 0.1</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.23.23" class="ltx_tr">
<td id="S5.T1.23.23.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Gal &amp; Ghahramani (<a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (medium, MC)</td>
<td id="S5.T1.23.23.4" class="ltx_td ltx_align_center">20M</td>
<td id="S5.T1.22.22.1" class="ltx_td ltx_align_center"><math id="S5.T1.22.22.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.22.22.1.m1.1a"><mo id="S5.T1.22.22.1.m1.1.1" xref="S5.T1.22.22.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.22.22.1.m1.1b"><minus id="S5.T1.22.22.1.m1.1.1.cmml" xref="S5.T1.22.22.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.22.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.22.22.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.23.23.2" class="ltx_td ltx_align_center"><math id="S5.T1.23.23.2.m1.1" class="ltx_Math" alttext="78.6\pm 0.1" display="inline"><semantics id="S5.T1.23.23.2.m1.1a"><mrow id="S5.T1.23.23.2.m1.1.1" xref="S5.T1.23.23.2.m1.1.1.cmml"><mn id="S5.T1.23.23.2.m1.1.1.2" xref="S5.T1.23.23.2.m1.1.1.2.cmml">78.6</mn><mo id="S5.T1.23.23.2.m1.1.1.1" xref="S5.T1.23.23.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.23.23.2.m1.1.1.3" xref="S5.T1.23.23.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.23.23.2.m1.1b"><apply id="S5.T1.23.23.2.m1.1.1.cmml" xref="S5.T1.23.23.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.23.23.2.m1.1.1.1.cmml" xref="S5.T1.23.23.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.23.23.2.m1.1.1.2.cmml" xref="S5.T1.23.23.2.m1.1.1.2">78.6</cn><cn type="float" id="S5.T1.23.23.2.m1.1.1.3.cmml" xref="S5.T1.23.23.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.23.2.m1.1c">78.6\pm 0.1</annotation><annotation encoding="application/x-llamapun" id="S5.T1.23.23.2.m1.1d">78.6 ± 0.1</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.25.25" class="ltx_tr">
<td id="S5.T1.25.25.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Gal &amp; Ghahramani (<a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (large)</td>
<td id="S5.T1.25.25.4" class="ltx_td ltx_align_center">66M</td>
<td id="S5.T1.24.24.1" class="ltx_td ltx_align_center"><math id="S5.T1.24.24.1.m1.1" class="ltx_Math" alttext="77.9\pm 0.3" display="inline"><semantics id="S5.T1.24.24.1.m1.1a"><mrow id="S5.T1.24.24.1.m1.1.1" xref="S5.T1.24.24.1.m1.1.1.cmml"><mn id="S5.T1.24.24.1.m1.1.1.2" xref="S5.T1.24.24.1.m1.1.1.2.cmml">77.9</mn><mo id="S5.T1.24.24.1.m1.1.1.1" xref="S5.T1.24.24.1.m1.1.1.1.cmml">±</mo><mn id="S5.T1.24.24.1.m1.1.1.3" xref="S5.T1.24.24.1.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.24.24.1.m1.1b"><apply id="S5.T1.24.24.1.m1.1.1.cmml" xref="S5.T1.24.24.1.m1.1.1"><csymbol cd="latexml" id="S5.T1.24.24.1.m1.1.1.1.cmml" xref="S5.T1.24.24.1.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.24.24.1.m1.1.1.2.cmml" xref="S5.T1.24.24.1.m1.1.1.2">77.9</cn><cn type="float" id="S5.T1.24.24.1.m1.1.1.3.cmml" xref="S5.T1.24.24.1.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.24.1.m1.1c">77.9\pm 0.3</annotation><annotation encoding="application/x-llamapun" id="S5.T1.24.24.1.m1.1d">77.9 ± 0.3</annotation></semantics></math></td>
<td id="S5.T1.25.25.2" class="ltx_td ltx_align_center"><math id="S5.T1.25.25.2.m1.1" class="ltx_Math" alttext="75.2\pm 0.2" display="inline"><semantics id="S5.T1.25.25.2.m1.1a"><mrow id="S5.T1.25.25.2.m1.1.1" xref="S5.T1.25.25.2.m1.1.1.cmml"><mn id="S5.T1.25.25.2.m1.1.1.2" xref="S5.T1.25.25.2.m1.1.1.2.cmml">75.2</mn><mo id="S5.T1.25.25.2.m1.1.1.1" xref="S5.T1.25.25.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.25.25.2.m1.1.1.3" xref="S5.T1.25.25.2.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.25.25.2.m1.1b"><apply id="S5.T1.25.25.2.m1.1.1.cmml" xref="S5.T1.25.25.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.25.25.2.m1.1.1.1.cmml" xref="S5.T1.25.25.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.25.25.2.m1.1.1.2.cmml" xref="S5.T1.25.25.2.m1.1.1.2">75.2</cn><cn type="float" id="S5.T1.25.25.2.m1.1.1.3.cmml" xref="S5.T1.25.25.2.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.25.2.m1.1c">75.2\pm 0.2</annotation><annotation encoding="application/x-llamapun" id="S5.T1.25.25.2.m1.1d">75.2 ± 0.2</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.27.27" class="ltx_tr">
<td id="S5.T1.27.27.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Gal &amp; Ghahramani (<a href="#bib.bib9" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (large, MC)</td>
<td id="S5.T1.27.27.4" class="ltx_td ltx_align_center">66M</td>
<td id="S5.T1.26.26.1" class="ltx_td ltx_align_center"><math id="S5.T1.26.26.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.26.26.1.m1.1a"><mo id="S5.T1.26.26.1.m1.1.1" xref="S5.T1.26.26.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.26.26.1.m1.1b"><minus id="S5.T1.26.26.1.m1.1.1.cmml" xref="S5.T1.26.26.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.26.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.26.26.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.27.27.2" class="ltx_td ltx_align_center"><math id="S5.T1.27.27.2.m1.1" class="ltx_Math" alttext="73.4\pm 0.0" display="inline"><semantics id="S5.T1.27.27.2.m1.1a"><mrow id="S5.T1.27.27.2.m1.1.1" xref="S5.T1.27.27.2.m1.1.1.cmml"><mn id="S5.T1.27.27.2.m1.1.1.2" xref="S5.T1.27.27.2.m1.1.1.2.cmml">73.4</mn><mo id="S5.T1.27.27.2.m1.1.1.1" xref="S5.T1.27.27.2.m1.1.1.1.cmml">±</mo><mn id="S5.T1.27.27.2.m1.1.1.3" xref="S5.T1.27.27.2.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.27.27.2.m1.1b"><apply id="S5.T1.27.27.2.m1.1.1.cmml" xref="S5.T1.27.27.2.m1.1.1"><csymbol cd="latexml" id="S5.T1.27.27.2.m1.1.1.1.cmml" xref="S5.T1.27.27.2.m1.1.1.1">plus-or-minus</csymbol><cn type="float" id="S5.T1.27.27.2.m1.1.1.2.cmml" xref="S5.T1.27.27.2.m1.1.1.2">73.4</cn><cn type="float" id="S5.T1.27.27.2.m1.1.1.3.cmml" xref="S5.T1.27.27.2.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.27.2.m1.1c">73.4\pm 0.0</annotation><annotation encoding="application/x-llamapun" id="S5.T1.27.27.2.m1.1d">73.4 ± 0.0</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.29.29" class="ltx_tr">
<td id="S5.T1.29.29.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Kim et al. (<a href="#bib.bib19" title="" class="ltx_ref">2016</a>)</cite> - CharCNN</td>
<td id="S5.T1.29.29.4" class="ltx_td ltx_align_center">19M</td>
<td id="S5.T1.28.28.1" class="ltx_td ltx_align_center"><math id="S5.T1.28.28.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.28.28.1.m1.1a"><mo id="S5.T1.28.28.1.m1.1.1" xref="S5.T1.28.28.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.28.28.1.m1.1b"><minus id="S5.T1.28.28.1.m1.1.1.cmml" xref="S5.T1.28.28.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.28.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.28.28.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.29.29.2" class="ltx_td ltx_align_center"><math id="S5.T1.29.29.2.m1.1" class="ltx_Math" alttext="78.9" display="inline"><semantics id="S5.T1.29.29.2.m1.1a"><mn id="S5.T1.29.29.2.m1.1.1" xref="S5.T1.29.29.2.m1.1.1.cmml">78.9</mn><annotation-xml encoding="MathML-Content" id="S5.T1.29.29.2.m1.1b"><cn type="float" id="S5.T1.29.29.2.m1.1.1.cmml" xref="S5.T1.29.29.2.m1.1.1">78.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.29.2.m1.1c">78.9</annotation><annotation encoding="application/x-llamapun" id="S5.T1.29.29.2.m1.1d">78.9</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.31.31" class="ltx_tr">
<td id="S5.T1.31.31.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Merity et al. (<a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite> - Pointer Sentinel-LSTM</td>
<td id="S5.T1.31.31.4" class="ltx_td ltx_align_center">21M</td>
<td id="S5.T1.30.30.1" class="ltx_td ltx_align_center"><math id="S5.T1.30.30.1.m1.1" class="ltx_Math" alttext="72.4" display="inline"><semantics id="S5.T1.30.30.1.m1.1a"><mn id="S5.T1.30.30.1.m1.1.1" xref="S5.T1.30.30.1.m1.1.1.cmml">72.4</mn><annotation-xml encoding="MathML-Content" id="S5.T1.30.30.1.m1.1b"><cn type="float" id="S5.T1.30.30.1.m1.1.1.cmml" xref="S5.T1.30.30.1.m1.1.1">72.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.30.1.m1.1c">72.4</annotation><annotation encoding="application/x-llamapun" id="S5.T1.30.30.1.m1.1d">72.4</annotation></semantics></math></td>
<td id="S5.T1.31.31.2" class="ltx_td ltx_align_center"><math id="S5.T1.31.31.2.m1.1" class="ltx_Math" alttext="70.9" display="inline"><semantics id="S5.T1.31.31.2.m1.1a"><mn id="S5.T1.31.31.2.m1.1.1" xref="S5.T1.31.31.2.m1.1.1.cmml">70.9</mn><annotation-xml encoding="MathML-Content" id="S5.T1.31.31.2.m1.1b"><cn type="float" id="S5.T1.31.31.2.m1.1.1.cmml" xref="S5.T1.31.31.2.m1.1.1">70.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.31.2.m1.1c">70.9</annotation><annotation encoding="application/x-llamapun" id="S5.T1.31.31.2.m1.1d">70.9</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.34.34" class="ltx_tr">
<td id="S5.T1.34.34.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Grave et al. (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> - LSTM</td>
<td id="S5.T1.32.32.1" class="ltx_td ltx_align_center"><math id="S5.T1.32.32.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.32.32.1.m1.1a"><mo id="S5.T1.32.32.1.m1.1.1" xref="S5.T1.32.32.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.32.32.1.m1.1b"><minus id="S5.T1.32.32.1.m1.1.1.cmml" xref="S5.T1.32.32.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.32.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.32.32.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.33.33.2" class="ltx_td ltx_align_center"><math id="S5.T1.33.33.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.33.33.2.m1.1a"><mo id="S5.T1.33.33.2.m1.1.1" xref="S5.T1.33.33.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.33.33.2.m1.1b"><minus id="S5.T1.33.33.2.m1.1.1.cmml" xref="S5.T1.33.33.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.33.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.33.33.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.34.34.3" class="ltx_td ltx_align_center"><math id="S5.T1.34.34.3.m1.1" class="ltx_Math" alttext="82.3" display="inline"><semantics id="S5.T1.34.34.3.m1.1a"><mn id="S5.T1.34.34.3.m1.1.1" xref="S5.T1.34.34.3.m1.1.1.cmml">82.3</mn><annotation-xml encoding="MathML-Content" id="S5.T1.34.34.3.m1.1b"><cn type="float" id="S5.T1.34.34.3.m1.1.1.cmml" xref="S5.T1.34.34.3.m1.1.1">82.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.34.3.m1.1c">82.3</annotation><annotation encoding="application/x-llamapun" id="S5.T1.34.34.3.m1.1d">82.3</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.37.37" class="ltx_tr">
<td id="S5.T1.37.37.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Grave et al. (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> - LSTM + continuous cache pointer</td>
<td id="S5.T1.35.35.1" class="ltx_td ltx_align_center"><math id="S5.T1.35.35.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.35.35.1.m1.1a"><mo id="S5.T1.35.35.1.m1.1.1" xref="S5.T1.35.35.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.35.35.1.m1.1b"><minus id="S5.T1.35.35.1.m1.1.1.cmml" xref="S5.T1.35.35.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.35.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.35.35.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.36.36.2" class="ltx_td ltx_align_center"><math id="S5.T1.36.36.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.36.36.2.m1.1a"><mo id="S5.T1.36.36.2.m1.1.1" xref="S5.T1.36.36.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.36.36.2.m1.1b"><minus id="S5.T1.36.36.2.m1.1.1.cmml" xref="S5.T1.36.36.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.36.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.36.36.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.37.37.3" class="ltx_td ltx_align_center"><math id="S5.T1.37.37.3.m1.1" class="ltx_Math" alttext="72.1" display="inline"><semantics id="S5.T1.37.37.3.m1.1a"><mn id="S5.T1.37.37.3.m1.1.1" xref="S5.T1.37.37.3.m1.1.1.cmml">72.1</mn><annotation-xml encoding="MathML-Content" id="S5.T1.37.37.3.m1.1b"><cn type="float" id="S5.T1.37.37.3.m1.1.1.cmml" xref="S5.T1.37.37.3.m1.1.1">72.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.37.3.m1.1c">72.1</annotation><annotation encoding="application/x-llamapun" id="S5.T1.37.37.3.m1.1d">72.1</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.39.39" class="ltx_tr">
<td id="S5.T1.39.39.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Inan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (tied) + augmented loss</td>
<td id="S5.T1.39.39.4" class="ltx_td ltx_align_center">24M</td>
<td id="S5.T1.38.38.1" class="ltx_td ltx_align_center"><math id="S5.T1.38.38.1.m1.1" class="ltx_Math" alttext="75.7" display="inline"><semantics id="S5.T1.38.38.1.m1.1a"><mn id="S5.T1.38.38.1.m1.1.1" xref="S5.T1.38.38.1.m1.1.1.cmml">75.7</mn><annotation-xml encoding="MathML-Content" id="S5.T1.38.38.1.m1.1b"><cn type="float" id="S5.T1.38.38.1.m1.1.1.cmml" xref="S5.T1.38.38.1.m1.1.1">75.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.38.38.1.m1.1c">75.7</annotation><annotation encoding="application/x-llamapun" id="S5.T1.38.38.1.m1.1d">75.7</annotation></semantics></math></td>
<td id="S5.T1.39.39.2" class="ltx_td ltx_align_center"><math id="S5.T1.39.39.2.m1.1" class="ltx_Math" alttext="73.2" display="inline"><semantics id="S5.T1.39.39.2.m1.1a"><mn id="S5.T1.39.39.2.m1.1.1" xref="S5.T1.39.39.2.m1.1.1.cmml">73.2</mn><annotation-xml encoding="MathML-Content" id="S5.T1.39.39.2.m1.1b"><cn type="float" id="S5.T1.39.39.2.m1.1.1.cmml" xref="S5.T1.39.39.2.m1.1.1">73.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.39.39.2.m1.1c">73.2</annotation><annotation encoding="application/x-llamapun" id="S5.T1.39.39.2.m1.1d">73.2</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.41.41" class="ltx_tr">
<td id="S5.T1.41.41.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Inan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (tied) + augmented loss</td>
<td id="S5.T1.41.41.4" class="ltx_td ltx_align_center">51M</td>
<td id="S5.T1.40.40.1" class="ltx_td ltx_align_center"><math id="S5.T1.40.40.1.m1.1" class="ltx_Math" alttext="71.1" display="inline"><semantics id="S5.T1.40.40.1.m1.1a"><mn id="S5.T1.40.40.1.m1.1.1" xref="S5.T1.40.40.1.m1.1.1.cmml">71.1</mn><annotation-xml encoding="MathML-Content" id="S5.T1.40.40.1.m1.1b"><cn type="float" id="S5.T1.40.40.1.m1.1.1.cmml" xref="S5.T1.40.40.1.m1.1.1">71.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.40.40.1.m1.1c">71.1</annotation><annotation encoding="application/x-llamapun" id="S5.T1.40.40.1.m1.1d">71.1</annotation></semantics></math></td>
<td id="S5.T1.41.41.2" class="ltx_td ltx_align_center"><math id="S5.T1.41.41.2.m1.1" class="ltx_Math" alttext="68.5" display="inline"><semantics id="S5.T1.41.41.2.m1.1a"><mn id="S5.T1.41.41.2.m1.1.1" xref="S5.T1.41.41.2.m1.1.1.cmml">68.5</mn><annotation-xml encoding="MathML-Content" id="S5.T1.41.41.2.m1.1b"><cn type="float" id="S5.T1.41.41.2.m1.1.1.cmml" xref="S5.T1.41.41.2.m1.1.1">68.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.41.41.2.m1.1c">68.5</annotation><annotation encoding="application/x-llamapun" id="S5.T1.41.41.2.m1.1d">68.5</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.43.43" class="ltx_tr">
<td id="S5.T1.43.43.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Zilly et al. (<a href="#bib.bib43" title="" class="ltx_ref">2016</a>)</cite> - Variational RHN (tied)</td>
<td id="S5.T1.43.43.4" class="ltx_td ltx_align_center">23M</td>
<td id="S5.T1.42.42.1" class="ltx_td ltx_align_center"><math id="S5.T1.42.42.1.m1.1" class="ltx_Math" alttext="67.9" display="inline"><semantics id="S5.T1.42.42.1.m1.1a"><mn id="S5.T1.42.42.1.m1.1.1" xref="S5.T1.42.42.1.m1.1.1.cmml">67.9</mn><annotation-xml encoding="MathML-Content" id="S5.T1.42.42.1.m1.1b"><cn type="float" id="S5.T1.42.42.1.m1.1.1.cmml" xref="S5.T1.42.42.1.m1.1.1">67.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.42.42.1.m1.1c">67.9</annotation><annotation encoding="application/x-llamapun" id="S5.T1.42.42.1.m1.1d">67.9</annotation></semantics></math></td>
<td id="S5.T1.43.43.2" class="ltx_td ltx_align_center"><math id="S5.T1.43.43.2.m1.1" class="ltx_Math" alttext="65.4" display="inline"><semantics id="S5.T1.43.43.2.m1.1a"><mn id="S5.T1.43.43.2.m1.1.1" xref="S5.T1.43.43.2.m1.1.1.cmml">65.4</mn><annotation-xml encoding="MathML-Content" id="S5.T1.43.43.2.m1.1b"><cn type="float" id="S5.T1.43.43.2.m1.1.1.cmml" xref="S5.T1.43.43.2.m1.1.1">65.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.43.43.2.m1.1c">65.4</annotation><annotation encoding="application/x-llamapun" id="S5.T1.43.43.2.m1.1d">65.4</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.45.45" class="ltx_tr">
<td id="S5.T1.45.45.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Zoph &amp; Le (<a href="#bib.bib44" title="" class="ltx_ref">2016</a>)</cite> - NAS Cell (tied)</td>
<td id="S5.T1.45.45.4" class="ltx_td ltx_align_center">25M</td>
<td id="S5.T1.44.44.1" class="ltx_td ltx_align_center"><math id="S5.T1.44.44.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.44.44.1.m1.1a"><mo id="S5.T1.44.44.1.m1.1.1" xref="S5.T1.44.44.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.44.44.1.m1.1b"><minus id="S5.T1.44.44.1.m1.1.1.cmml" xref="S5.T1.44.44.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.44.44.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.44.44.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.45.45.2" class="ltx_td ltx_align_center"><math id="S5.T1.45.45.2.m1.1" class="ltx_Math" alttext="64.0" display="inline"><semantics id="S5.T1.45.45.2.m1.1a"><mn id="S5.T1.45.45.2.m1.1.1" xref="S5.T1.45.45.2.m1.1.1.cmml">64.0</mn><annotation-xml encoding="MathML-Content" id="S5.T1.45.45.2.m1.1b"><cn type="float" id="S5.T1.45.45.2.m1.1.1.cmml" xref="S5.T1.45.45.2.m1.1.1">64.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.45.45.2.m1.1c">64.0</annotation><annotation encoding="application/x-llamapun" id="S5.T1.45.45.2.m1.1d">64.0</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.47.47" class="ltx_tr">
<td id="S5.T1.47.47.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Zoph &amp; Le (<a href="#bib.bib44" title="" class="ltx_ref">2016</a>)</cite> - NAS Cell (tied)</td>
<td id="S5.T1.47.47.4" class="ltx_td ltx_align_center">54M</td>
<td id="S5.T1.46.46.1" class="ltx_td ltx_align_center"><math id="S5.T1.46.46.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T1.46.46.1.m1.1a"><mo id="S5.T1.46.46.1.m1.1.1" xref="S5.T1.46.46.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T1.46.46.1.m1.1b"><minus id="S5.T1.46.46.1.m1.1.1.cmml" xref="S5.T1.46.46.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.46.46.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T1.46.46.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T1.47.47.2" class="ltx_td ltx_align_center"><math id="S5.T1.47.47.2.m1.1" class="ltx_Math" alttext="62.4" display="inline"><semantics id="S5.T1.47.47.2.m1.1a"><mn id="S5.T1.47.47.2.m1.1.1" xref="S5.T1.47.47.2.m1.1.1.cmml">62.4</mn><annotation-xml encoding="MathML-Content" id="S5.T1.47.47.2.m1.1b"><cn type="float" id="S5.T1.47.47.2.m1.1.1.cmml" xref="S5.T1.47.47.2.m1.1.1">62.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.47.47.2.m1.1c">62.4</annotation><annotation encoding="application/x-llamapun" id="S5.T1.47.47.2.m1.1d">62.4</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.49.49" class="ltx_tr">
<td id="S5.T1.49.49.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> - 4-layer skip connection LSTM (tied)</td>
<td id="S5.T1.49.49.4" class="ltx_td ltx_align_center">24M</td>
<td id="S5.T1.48.48.1" class="ltx_td ltx_align_center"><math id="S5.T1.48.48.1.m1.1" class="ltx_Math" alttext="60.9" display="inline"><semantics id="S5.T1.48.48.1.m1.1a"><mn id="S5.T1.48.48.1.m1.1.1" xref="S5.T1.48.48.1.m1.1.1.cmml">60.9</mn><annotation-xml encoding="MathML-Content" id="S5.T1.48.48.1.m1.1b"><cn type="float" id="S5.T1.48.48.1.m1.1.1.cmml" xref="S5.T1.48.48.1.m1.1.1">60.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.48.48.1.m1.1c">60.9</annotation><annotation encoding="application/x-llamapun" id="S5.T1.48.48.1.m1.1d">60.9</annotation></semantics></math></td>
<td id="S5.T1.49.49.2" class="ltx_td ltx_align_center"><math id="S5.T1.49.49.2.m1.1" class="ltx_Math" alttext="58.3" display="inline"><semantics id="S5.T1.49.49.2.m1.1a"><mn id="S5.T1.49.49.2.m1.1.1" xref="S5.T1.49.49.2.m1.1.1.cmml">58.3</mn><annotation-xml encoding="MathML-Content" id="S5.T1.49.49.2.m1.1b"><cn type="float" id="S5.T1.49.49.2.m1.1.1.cmml" xref="S5.T1.49.49.2.m1.1.1">58.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.49.49.2.m1.1c">58.3</annotation><annotation encoding="application/x-llamapun" id="S5.T1.49.49.2.m1.1d">58.3</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.51.51" class="ltx_tr">
<td id="S5.T1.51.51.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">AWD-LSTM - 3-layer LSTM (tied)</td>
<td id="S5.T1.51.51.4" class="ltx_td ltx_align_center ltx_border_t">24M</td>
<td id="S5.T1.50.50.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.50.50.1.m1.1" class="ltx_Math" alttext="60.0" display="inline"><semantics id="S5.T1.50.50.1.m1.1a"><mn id="S5.T1.50.50.1.m1.1.1" xref="S5.T1.50.50.1.m1.1.1.cmml">60.0</mn><annotation-xml encoding="MathML-Content" id="S5.T1.50.50.1.m1.1b"><cn type="float" id="S5.T1.50.50.1.m1.1.1.cmml" xref="S5.T1.50.50.1.m1.1.1">60.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.50.50.1.m1.1c">60.0</annotation><annotation encoding="application/x-llamapun" id="S5.T1.50.50.1.m1.1d">60.0</annotation></semantics></math></td>
<td id="S5.T1.51.51.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T1.51.51.2.m1.1" class="ltx_Math" alttext="57.3" display="inline"><semantics id="S5.T1.51.51.2.m1.1a"><mn id="S5.T1.51.51.2.m1.1.1" xref="S5.T1.51.51.2.m1.1.1.cmml">57.3</mn><annotation-xml encoding="MathML-Content" id="S5.T1.51.51.2.m1.1b"><cn type="float" id="S5.T1.51.51.2.m1.1.1.cmml" xref="S5.T1.51.51.2.m1.1.1">57.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.51.51.2.m1.1c">57.3</annotation><annotation encoding="application/x-llamapun" id="S5.T1.51.51.2.m1.1d">57.3</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.53.53" class="ltx_tr">
<td id="S5.T1.53.53.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">AWD-LSTM - 3-layer LSTM (tied) + continuous cache pointer</td>
<td id="S5.T1.53.53.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">24M</td>
<td id="S5.T1.52.52.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T1.52.52.1.m1.1" class="ltx_Math" alttext="53.9" display="inline"><semantics id="S5.T1.52.52.1.m1.1a"><mn id="S5.T1.52.52.1.m1.1.1" xref="S5.T1.52.52.1.m1.1.1.cmml">53.9</mn><annotation-xml encoding="MathML-Content" id="S5.T1.52.52.1.m1.1b"><cn type="float" id="S5.T1.52.52.1.m1.1.1.cmml" xref="S5.T1.52.52.1.m1.1.1">53.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.52.52.1.m1.1c">53.9</annotation><annotation encoding="application/x-llamapun" id="S5.T1.52.52.1.m1.1d">53.9</annotation></semantics></math></td>
<td id="S5.T1.53.53.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T1.53.53.2.m1.1" class="ltx_Math" alttext="52.8" display="inline"><semantics id="S5.T1.53.53.2.m1.1a"><mn id="S5.T1.53.53.2.m1.1.1" xref="S5.T1.53.53.2.m1.1.1.cmml">52.8</mn><annotation-xml encoding="MathML-Content" id="S5.T1.53.53.2.m1.1b"><cn type="float" id="S5.T1.53.53.2.m1.1.1.cmml" xref="S5.T1.53.53.2.m1.1.1">52.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.53.53.2.m1.1c">52.8</annotation><annotation encoding="application/x-llamapun" id="S5.T1.53.53.2.m1.1d">52.8</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>
Single model perplexity on validation and test sets for the Penn Treebank language modeling task.
Parameter numbers with <math id="S5.T1.55.m1.1" class="ltx_Math" alttext="\ddagger" display="inline"><semantics id="S5.T1.55.m1.1b"><mo id="S5.T1.55.m1.1.1" xref="S5.T1.55.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S5.T1.55.m1.1c"><ci id="S5.T1.55.m1.1.1.cmml" xref="S5.T1.55.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.55.m1.1d">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S5.T1.55.m1.1e">‡</annotation></semantics></math> are estimates based upon our understanding of the model and with reference to <cite class="ltx_cite ltx_citemacro_citet">Merity et al. (<a href="#bib.bib26" title="" class="ltx_ref">2016</a>)</cite>.
Models noting <span id="S5.T1.57.1" class="ltx_text ltx_font_italic">tied</span> use weight tying on the embedding and softmax weights.
Our model, AWD-LSTM, stands for ASGD Weight-Dropped LSTM.
</figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.20.21.1" class="ltx_tr">
<th id="S5.T2.20.21.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="S5.T2.20.21.1.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<th id="S5.T2.20.21.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.20.21.1.2.1" class="ltx_text ltx_font_bold">Parameters</span></th>
<th id="S5.T2.20.21.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.20.21.1.3.1" class="ltx_text ltx_font_bold">Validation</span></th>
<th id="S5.T2.20.21.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S5.T2.20.21.1.4.1" class="ltx_text ltx_font_bold">Test</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.3.3" class="ltx_tr">
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<cite class="ltx_cite ltx_citemacro_citet">Inan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (tied) (<math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="h=650" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mrow id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml"><mi id="S5.T2.1.1.1.m1.1.1.2" xref="S5.T2.1.1.1.m1.1.1.2.cmml">h</mi><mo id="S5.T2.1.1.1.m1.1.1.1" xref="S5.T2.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S5.T2.1.1.1.m1.1.1.3" xref="S5.T2.1.1.1.m1.1.1.3.cmml">650</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><apply id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1"><eq id="S5.T2.1.1.1.m1.1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1.1"></eq><ci id="S5.T2.1.1.1.m1.1.1.2.cmml" xref="S5.T2.1.1.1.m1.1.1.2">ℎ</ci><cn type="integer" id="S5.T2.1.1.1.m1.1.1.3.cmml" xref="S5.T2.1.1.1.m1.1.1.3">650</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">h=650</annotation><annotation encoding="application/x-llamapun" id="S5.T2.1.1.1.m1.1d">italic_h = 650</annotation></semantics></math>)</td>
<td id="S5.T2.3.3.4" class="ltx_td ltx_align_center ltx_border_t">28M</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="92.3" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mn id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">92.3</mn><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><cn type="float" id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">92.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">92.3</annotation><annotation encoding="application/x-llamapun" id="S5.T2.2.2.2.m1.1d">92.3</annotation></semantics></math></td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="87.7" display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mn id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">87.7</mn><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><cn type="float" id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">87.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">87.7</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.3.3.m1.1d">87.7</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.6.6" class="ltx_tr">
<td id="S5.T2.4.4.1" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Inan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite> - Variational LSTM (tied) (<math id="S5.T2.4.4.1.m1.1" class="ltx_Math" alttext="h=650" display="inline"><semantics id="S5.T2.4.4.1.m1.1a"><mrow id="S5.T2.4.4.1.m1.1.1" xref="S5.T2.4.4.1.m1.1.1.cmml"><mi id="S5.T2.4.4.1.m1.1.1.2" xref="S5.T2.4.4.1.m1.1.1.2.cmml">h</mi><mo id="S5.T2.4.4.1.m1.1.1.1" xref="S5.T2.4.4.1.m1.1.1.1.cmml">=</mo><mn id="S5.T2.4.4.1.m1.1.1.3" xref="S5.T2.4.4.1.m1.1.1.3.cmml">650</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.1.m1.1b"><apply id="S5.T2.4.4.1.m1.1.1.cmml" xref="S5.T2.4.4.1.m1.1.1"><eq id="S5.T2.4.4.1.m1.1.1.1.cmml" xref="S5.T2.4.4.1.m1.1.1.1"></eq><ci id="S5.T2.4.4.1.m1.1.1.2.cmml" xref="S5.T2.4.4.1.m1.1.1.2">ℎ</ci><cn type="integer" id="S5.T2.4.4.1.m1.1.1.3.cmml" xref="S5.T2.4.4.1.m1.1.1.3">650</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.1.m1.1c">h=650</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.4.1.m1.1d">italic_h = 650</annotation></semantics></math>) + augmented loss</td>
<td id="S5.T2.6.6.4" class="ltx_td ltx_align_center">28M</td>
<td id="S5.T2.5.5.2" class="ltx_td ltx_align_center"><math id="S5.T2.5.5.2.m1.1" class="ltx_Math" alttext="91.5" display="inline"><semantics id="S5.T2.5.5.2.m1.1a"><mn id="S5.T2.5.5.2.m1.1.1" xref="S5.T2.5.5.2.m1.1.1.cmml">91.5</mn><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.2.m1.1b"><cn type="float" id="S5.T2.5.5.2.m1.1.1.cmml" xref="S5.T2.5.5.2.m1.1.1">91.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.2.m1.1c">91.5</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.5.2.m1.1d">91.5</annotation></semantics></math></td>
<td id="S5.T2.6.6.3" class="ltx_td ltx_align_center"><math id="S5.T2.6.6.3.m1.1" class="ltx_Math" alttext="87.0" display="inline"><semantics id="S5.T2.6.6.3.m1.1a"><mn id="S5.T2.6.6.3.m1.1.1" xref="S5.T2.6.6.3.m1.1.1.cmml">87.0</mn><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.3.m1.1b"><cn type="float" id="S5.T2.6.6.3.m1.1.1.cmml" xref="S5.T2.6.6.3.m1.1.1">87.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.3.m1.1c">87.0</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.6.3.m1.1d">87.0</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.9.9" class="ltx_tr">
<td id="S5.T2.9.9.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Grave et al. (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> - LSTM</td>
<td id="S5.T2.7.7.1" class="ltx_td ltx_align_center"><math id="S5.T2.7.7.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T2.7.7.1.m1.1a"><mo id="S5.T2.7.7.1.m1.1.1" xref="S5.T2.7.7.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.1.m1.1b"><minus id="S5.T2.7.7.1.m1.1.1.cmml" xref="S5.T2.7.7.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.7.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T2.8.8.2" class="ltx_td ltx_align_center"><math id="S5.T2.8.8.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T2.8.8.2.m1.1a"><mo id="S5.T2.8.8.2.m1.1.1" xref="S5.T2.8.8.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.2.m1.1b"><minus id="S5.T2.8.8.2.m1.1.1.cmml" xref="S5.T2.8.8.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.8.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T2.9.9.3" class="ltx_td ltx_align_center"><math id="S5.T2.9.9.3.m1.1" class="ltx_Math" alttext="99.3" display="inline"><semantics id="S5.T2.9.9.3.m1.1a"><mn id="S5.T2.9.9.3.m1.1.1" xref="S5.T2.9.9.3.m1.1.1.cmml">99.3</mn><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.3.m1.1b"><cn type="float" id="S5.T2.9.9.3.m1.1.1.cmml" xref="S5.T2.9.9.3.m1.1.1">99.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.3.m1.1c">99.3</annotation><annotation encoding="application/x-llamapun" id="S5.T2.9.9.3.m1.1d">99.3</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.12.12" class="ltx_tr">
<td id="S5.T2.12.12.4" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Grave et al. (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> - LSTM + continuous cache pointer</td>
<td id="S5.T2.10.10.1" class="ltx_td ltx_align_center"><math id="S5.T2.10.10.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T2.10.10.1.m1.1a"><mo id="S5.T2.10.10.1.m1.1.1" xref="S5.T2.10.10.1.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.1.m1.1b"><minus id="S5.T2.10.10.1.m1.1.1.cmml" xref="S5.T2.10.10.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.1.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.10.10.1.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T2.11.11.2" class="ltx_td ltx_align_center"><math id="S5.T2.11.11.2.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="S5.T2.11.11.2.m1.1a"><mo id="S5.T2.11.11.2.m1.1.1" xref="S5.T2.11.11.2.m1.1.1.cmml">-</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.2.m1.1b"><minus id="S5.T2.11.11.2.m1.1.1.cmml" xref="S5.T2.11.11.2.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.2.m1.1c">-</annotation><annotation encoding="application/x-llamapun" id="S5.T2.11.11.2.m1.1d">-</annotation></semantics></math></td>
<td id="S5.T2.12.12.3" class="ltx_td ltx_align_center"><math id="S5.T2.12.12.3.m1.1" class="ltx_Math" alttext="68.9" display="inline"><semantics id="S5.T2.12.12.3.m1.1a"><mn id="S5.T2.12.12.3.m1.1.1" xref="S5.T2.12.12.3.m1.1.1.cmml">68.9</mn><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.3.m1.1b"><cn type="float" id="S5.T2.12.12.3.m1.1.1.cmml" xref="S5.T2.12.12.3.m1.1.1">68.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.3.m1.1c">68.9</annotation><annotation encoding="application/x-llamapun" id="S5.T2.12.12.3.m1.1d">68.9</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.14.14" class="ltx_tr">
<td id="S5.T2.14.14.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> - 1-layer LSTM (tied)</td>
<td id="S5.T2.14.14.4" class="ltx_td ltx_align_center">24M</td>
<td id="S5.T2.13.13.1" class="ltx_td ltx_align_center"><math id="S5.T2.13.13.1.m1.1" class="ltx_Math" alttext="69.3" display="inline"><semantics id="S5.T2.13.13.1.m1.1a"><mn id="S5.T2.13.13.1.m1.1.1" xref="S5.T2.13.13.1.m1.1.1.cmml">69.3</mn><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.1.m1.1b"><cn type="float" id="S5.T2.13.13.1.m1.1.1.cmml" xref="S5.T2.13.13.1.m1.1.1">69.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.1.m1.1c">69.3</annotation><annotation encoding="application/x-llamapun" id="S5.T2.13.13.1.m1.1d">69.3</annotation></semantics></math></td>
<td id="S5.T2.14.14.2" class="ltx_td ltx_align_center"><math id="S5.T2.14.14.2.m1.1" class="ltx_Math" alttext="65.9" display="inline"><semantics id="S5.T2.14.14.2.m1.1a"><mn id="S5.T2.14.14.2.m1.1.1" xref="S5.T2.14.14.2.m1.1.1.cmml">65.9</mn><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.2.m1.1b"><cn type="float" id="S5.T2.14.14.2.m1.1.1.cmml" xref="S5.T2.14.14.2.m1.1.1">65.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.2.m1.1c">65.9</annotation><annotation encoding="application/x-llamapun" id="S5.T2.14.14.2.m1.1d">65.9</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.16.16" class="ltx_tr">
<td id="S5.T2.16.16.3" class="ltx_td ltx_align_left ltx_border_r">
<cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> - 2-layer skip connection LSTM (tied)</td>
<td id="S5.T2.16.16.4" class="ltx_td ltx_align_center">24M</td>
<td id="S5.T2.15.15.1" class="ltx_td ltx_align_center"><math id="S5.T2.15.15.1.m1.1" class="ltx_Math" alttext="69.1" display="inline"><semantics id="S5.T2.15.15.1.m1.1a"><mn id="S5.T2.15.15.1.m1.1.1" xref="S5.T2.15.15.1.m1.1.1.cmml">69.1</mn><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.1.m1.1b"><cn type="float" id="S5.T2.15.15.1.m1.1.1.cmml" xref="S5.T2.15.15.1.m1.1.1">69.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.1.m1.1c">69.1</annotation><annotation encoding="application/x-llamapun" id="S5.T2.15.15.1.m1.1d">69.1</annotation></semantics></math></td>
<td id="S5.T2.16.16.2" class="ltx_td ltx_align_center"><math id="S5.T2.16.16.2.m1.1" class="ltx_Math" alttext="65.9" display="inline"><semantics id="S5.T2.16.16.2.m1.1a"><mn id="S5.T2.16.16.2.m1.1.1" xref="S5.T2.16.16.2.m1.1.1.cmml">65.9</mn><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.2.m1.1b"><cn type="float" id="S5.T2.16.16.2.m1.1.1.cmml" xref="S5.T2.16.16.2.m1.1.1">65.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.2.m1.1c">65.9</annotation><annotation encoding="application/x-llamapun" id="S5.T2.16.16.2.m1.1d">65.9</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.18.18" class="ltx_tr">
<td id="S5.T2.18.18.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">AWD-LSTM - 3-layer LSTM (tied)</td>
<td id="S5.T2.18.18.4" class="ltx_td ltx_align_center ltx_border_t">33M</td>
<td id="S5.T2.17.17.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.17.17.1.m1.1" class="ltx_Math" alttext="68.6" display="inline"><semantics id="S5.T2.17.17.1.m1.1a"><mn id="S5.T2.17.17.1.m1.1.1" xref="S5.T2.17.17.1.m1.1.1.cmml">68.6</mn><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.1.m1.1b"><cn type="float" id="S5.T2.17.17.1.m1.1.1.cmml" xref="S5.T2.17.17.1.m1.1.1">68.6</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.1.m1.1c">68.6</annotation><annotation encoding="application/x-llamapun" id="S5.T2.17.17.1.m1.1d">68.6</annotation></semantics></math></td>
<td id="S5.T2.18.18.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S5.T2.18.18.2.m1.1" class="ltx_Math" alttext="65.8" display="inline"><semantics id="S5.T2.18.18.2.m1.1a"><mn id="S5.T2.18.18.2.m1.1.1" xref="S5.T2.18.18.2.m1.1.1.cmml">65.8</mn><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.2.m1.1b"><cn type="float" id="S5.T2.18.18.2.m1.1.1.cmml" xref="S5.T2.18.18.2.m1.1.1">65.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.2.m1.1c">65.8</annotation><annotation encoding="application/x-llamapun" id="S5.T2.18.18.2.m1.1d">65.8</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.20.20" class="ltx_tr">
<td id="S5.T2.20.20.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">AWD-LSTM - 3-layer LSTM (tied) + continuous cache pointer</td>
<td id="S5.T2.20.20.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">33M</td>
<td id="S5.T2.19.19.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T2.19.19.1.m1.1" class="ltx_Math" alttext="53.8" display="inline"><semantics id="S5.T2.19.19.1.m1.1a"><mn id="S5.T2.19.19.1.m1.1.1" xref="S5.T2.19.19.1.m1.1.1.cmml">53.8</mn><annotation-xml encoding="MathML-Content" id="S5.T2.19.19.1.m1.1b"><cn type="float" id="S5.T2.19.19.1.m1.1.1.cmml" xref="S5.T2.19.19.1.m1.1.1">53.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.19.1.m1.1c">53.8</annotation><annotation encoding="application/x-llamapun" id="S5.T2.19.19.1.m1.1d">53.8</annotation></semantics></math></td>
<td id="S5.T2.20.20.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="S5.T2.20.20.2.m1.1" class="ltx_Math" alttext="52.0" display="inline"><semantics id="S5.T2.20.20.2.m1.1a"><mn id="S5.T2.20.20.2.m1.1.1" xref="S5.T2.20.20.2.m1.1.1.cmml">52.0</mn><annotation-xml encoding="MathML-Content" id="S5.T2.20.20.2.m1.1b"><cn type="float" id="S5.T2.20.20.2.m1.1.1.cmml" xref="S5.T2.20.20.2.m1.1.1">52.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.20.2.m1.1c">52.0</annotation><annotation encoding="application/x-llamapun" id="S5.T2.20.20.2.m1.1d">52.0</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Single model perplexity over WikiText-2.
Models noting <span id="S5.T2.22.1" class="ltx_text ltx_font_italic">tied</span> use weight tying on the embedding and softmax weights.
Our model, AWD-LSTM, stands for ASGD Weight-Dropped LSTM.
</figcaption>
</figure>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experimental Analysis</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We present the single-model perplexity results for both our models (AWD-LSTM) and other competitive models in Table <a href="#S5.T1" title="Table 1 ‣ 5 Experiment Details ‣ Regularizing and Optimizing LSTM Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S5.T2" title="Table 2 ‣ 5 Experiment Details ‣ Regularizing and Optimizing LSTM Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> for PTB and WT2 respectively.
On both data sets we improve the state-of-the-art, with our vanilla LSTM model beating the state of the art by approximately 1 unit on PTB and 0.1 units on WT2.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">In comparison to other recent state-of-the-art models, our model uses a vanilla LSTM.
<cite class="ltx_cite ltx_citemacro_citet">Zilly et al. (<a href="#bib.bib43" title="" class="ltx_ref">2016</a>)</cite> propose the recurrent highway network, which extends the LSTM to allow multiple hidden state updates per timestep.
<cite class="ltx_cite ltx_citemacro_citet">Zoph &amp; Le (<a href="#bib.bib44" title="" class="ltx_ref">2016</a>)</cite> use a reinforcement learning agent to generate an RNN cell tailored to the specific task of language modeling, with the cell far more complex than the LSTM.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.3" class="ltx_p">Independently of our work, <cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> apply extensive hyperparameter search to an LSTM based language modeling implementation, analyzing the sensitivity of RNN based language models to hyperparameters.
Unlike our work, they use a modified LSTM, which caps the input gate <math id="S6.p3.1.m1.1" class="ltx_Math" alttext="i_{t}" display="inline"><semantics id="S6.p3.1.m1.1a"><msub id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml"><mi id="S6.p3.1.m1.1.1.2" xref="S6.p3.1.m1.1.1.2.cmml">i</mi><mi id="S6.p3.1.m1.1.1.3" xref="S6.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><apply id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S6.p3.1.m1.1.1.1.cmml" xref="S6.p3.1.m1.1.1">subscript</csymbol><ci id="S6.p3.1.m1.1.1.2.cmml" xref="S6.p3.1.m1.1.1.2">𝑖</ci><ci id="S6.p3.1.m1.1.1.3.cmml" xref="S6.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S6.p3.1.m1.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to be <math id="S6.p3.2.m2.3" class="ltx_Math" alttext="\min(1-f_{t},i_{t})" display="inline"><semantics id="S6.p3.2.m2.3a"><mrow id="S6.p3.2.m2.3.3.2" xref="S6.p3.2.m2.3.3.3.cmml"><mi id="S6.p3.2.m2.1.1" xref="S6.p3.2.m2.1.1.cmml">min</mi><mo id="S6.p3.2.m2.3.3.2a" xref="S6.p3.2.m2.3.3.3.cmml">⁡</mo><mrow id="S6.p3.2.m2.3.3.2.2" xref="S6.p3.2.m2.3.3.3.cmml"><mo stretchy="false" id="S6.p3.2.m2.3.3.2.2.3" xref="S6.p3.2.m2.3.3.3.cmml">(</mo><mrow id="S6.p3.2.m2.2.2.1.1.1" xref="S6.p3.2.m2.2.2.1.1.1.cmml"><mn id="S6.p3.2.m2.2.2.1.1.1.2" xref="S6.p3.2.m2.2.2.1.1.1.2.cmml">1</mn><mo id="S6.p3.2.m2.2.2.1.1.1.1" xref="S6.p3.2.m2.2.2.1.1.1.1.cmml">-</mo><msub id="S6.p3.2.m2.2.2.1.1.1.3" xref="S6.p3.2.m2.2.2.1.1.1.3.cmml"><mi id="S6.p3.2.m2.2.2.1.1.1.3.2" xref="S6.p3.2.m2.2.2.1.1.1.3.2.cmml">f</mi><mi id="S6.p3.2.m2.2.2.1.1.1.3.3" xref="S6.p3.2.m2.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S6.p3.2.m2.3.3.2.2.4" xref="S6.p3.2.m2.3.3.3.cmml">,</mo><msub id="S6.p3.2.m2.3.3.2.2.2" xref="S6.p3.2.m2.3.3.2.2.2.cmml"><mi id="S6.p3.2.m2.3.3.2.2.2.2" xref="S6.p3.2.m2.3.3.2.2.2.2.cmml">i</mi><mi id="S6.p3.2.m2.3.3.2.2.2.3" xref="S6.p3.2.m2.3.3.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S6.p3.2.m2.3.3.2.2.5" xref="S6.p3.2.m2.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.2.m2.3b"><apply id="S6.p3.2.m2.3.3.3.cmml" xref="S6.p3.2.m2.3.3.2"><min id="S6.p3.2.m2.1.1.cmml" xref="S6.p3.2.m2.1.1"></min><apply id="S6.p3.2.m2.2.2.1.1.1.cmml" xref="S6.p3.2.m2.2.2.1.1.1"><minus id="S6.p3.2.m2.2.2.1.1.1.1.cmml" xref="S6.p3.2.m2.2.2.1.1.1.1"></minus><cn type="integer" id="S6.p3.2.m2.2.2.1.1.1.2.cmml" xref="S6.p3.2.m2.2.2.1.1.1.2">1</cn><apply id="S6.p3.2.m2.2.2.1.1.1.3.cmml" xref="S6.p3.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S6.p3.2.m2.2.2.1.1.1.3.1.cmml" xref="S6.p3.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S6.p3.2.m2.2.2.1.1.1.3.2.cmml" xref="S6.p3.2.m2.2.2.1.1.1.3.2">𝑓</ci><ci id="S6.p3.2.m2.2.2.1.1.1.3.3.cmml" xref="S6.p3.2.m2.2.2.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S6.p3.2.m2.3.3.2.2.2.cmml" xref="S6.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S6.p3.2.m2.3.3.2.2.2.1.cmml" xref="S6.p3.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S6.p3.2.m2.3.3.2.2.2.2.cmml" xref="S6.p3.2.m2.3.3.2.2.2.2">𝑖</ci><ci id="S6.p3.2.m2.3.3.2.2.2.3.cmml" xref="S6.p3.2.m2.3.3.2.2.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.2.m2.3c">\min(1-f_{t},i_{t})</annotation><annotation encoding="application/x-llamapun" id="S6.p3.2.m2.3d">roman_min ( 1 - italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, use Adam with <math id="S6.p3.3.m3.1" class="ltx_Math" alttext="\beta_{1}=0" display="inline"><semantics id="S6.p3.3.m3.1a"><mrow id="S6.p3.3.m3.1.1" xref="S6.p3.3.m3.1.1.cmml"><msub id="S6.p3.3.m3.1.1.2" xref="S6.p3.3.m3.1.1.2.cmml"><mi id="S6.p3.3.m3.1.1.2.2" xref="S6.p3.3.m3.1.1.2.2.cmml">β</mi><mn id="S6.p3.3.m3.1.1.2.3" xref="S6.p3.3.m3.1.1.2.3.cmml">1</mn></msub><mo id="S6.p3.3.m3.1.1.1" xref="S6.p3.3.m3.1.1.1.cmml">=</mo><mn id="S6.p3.3.m3.1.1.3" xref="S6.p3.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.3.m3.1b"><apply id="S6.p3.3.m3.1.1.cmml" xref="S6.p3.3.m3.1.1"><eq id="S6.p3.3.m3.1.1.1.cmml" xref="S6.p3.3.m3.1.1.1"></eq><apply id="S6.p3.3.m3.1.1.2.cmml" xref="S6.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S6.p3.3.m3.1.1.2.1.cmml" xref="S6.p3.3.m3.1.1.2">subscript</csymbol><ci id="S6.p3.3.m3.1.1.2.2.cmml" xref="S6.p3.3.m3.1.1.2.2">𝛽</ci><cn type="integer" id="S6.p3.3.m3.1.1.2.3.cmml" xref="S6.p3.3.m3.1.1.2.3">1</cn></apply><cn type="integer" id="S6.p3.3.m3.1.1.3.cmml" xref="S6.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.3.m3.1c">\beta_{1}=0</annotation><annotation encoding="application/x-llamapun" id="S6.p3.3.m3.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0</annotation></semantics></math> rather than SGD or ASGD, use skip connections between LSTM layers, and use a black box hyperparameter tuner for exploring models and settings.
Of particular interest is that their hyperparameters were tuned individually for each data set compared to our work which shared almost all hyperparameters between PTB and WT2, including the embedding and hidden size for both data sets.
Due to this, they used less model parameters than our model and found shallow LSTMs of one or two layers worked best for WT2.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">Like our work, <cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> find that the underlying LSTM architecture can be highly effective compared to complex custom architectures when well tuned hyperparameters are used.
The approaches used in our work and <cite class="ltx_cite ltx_citemacro_citet">Melis et al. (<a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> may be complementary and would be worth exploration.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Pointer models</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In past work, pointer based attention models have been shown to be highly effective in improving language modeling <cite class="ltx_cite ltx_citemacro_citep">(Merity et al., <a href="#bib.bib26" title="" class="ltx_ref">2016</a>; Grave et al., <a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite>.
Given such substantial improvements to the underlying neural language model, it remained an open question as to how effective pointer augmentation may be, especially when improvements such as weight tying may act in mutually exclusive ways.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.2" class="ltx_p">The neural cache model <cite class="ltx_cite ltx_citemacro_citep">(Grave et al., <a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite> can be added on top of a pre-trained language model at negligible cost.
The neural cache stores the previous hidden states in memory cells and then uses a simple convex combination of the probability distributions suggested by the cache and the language model for prediction.
The cache model has three hyperparameters: the memory size (window) for the cache, the coefficient of the combination (which determines how the two distributions are mixed), and the flatness of the cache distribution.
All of these are tuned on the validation set once a trained language model has been obtained and require no training by themselves, making it quite inexpensive to use. The tuned values for these hyperparameters were <math id="S7.p2.1.m1.3" class="ltx_Math" alttext="(2000,0.1,1.0)" display="inline"><semantics id="S7.p2.1.m1.3a"><mrow id="S7.p2.1.m1.3.4.2" xref="S7.p2.1.m1.3.4.1.cmml"><mo stretchy="false" id="S7.p2.1.m1.3.4.2.1" xref="S7.p2.1.m1.3.4.1.cmml">(</mo><mn id="S7.p2.1.m1.1.1" xref="S7.p2.1.m1.1.1.cmml">2000</mn><mo id="S7.p2.1.m1.3.4.2.2" xref="S7.p2.1.m1.3.4.1.cmml">,</mo><mn id="S7.p2.1.m1.2.2" xref="S7.p2.1.m1.2.2.cmml">0.1</mn><mo id="S7.p2.1.m1.3.4.2.3" xref="S7.p2.1.m1.3.4.1.cmml">,</mo><mn id="S7.p2.1.m1.3.3" xref="S7.p2.1.m1.3.3.cmml">1.0</mn><mo stretchy="false" id="S7.p2.1.m1.3.4.2.4" xref="S7.p2.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p2.1.m1.3b"><vector id="S7.p2.1.m1.3.4.1.cmml" xref="S7.p2.1.m1.3.4.2"><cn type="integer" id="S7.p2.1.m1.1.1.cmml" xref="S7.p2.1.m1.1.1">2000</cn><cn type="float" id="S7.p2.1.m1.2.2.cmml" xref="S7.p2.1.m1.2.2">0.1</cn><cn type="float" id="S7.p2.1.m1.3.3.cmml" xref="S7.p2.1.m1.3.3">1.0</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.1.m1.3c">(2000,0.1,1.0)</annotation><annotation encoding="application/x-llamapun" id="S7.p2.1.m1.3d">( 2000 , 0.1 , 1.0 )</annotation></semantics></math> for PTB and <math id="S7.p2.2.m2.3" class="ltx_Math" alttext="(3785,0.1279,0.662)" display="inline"><semantics id="S7.p2.2.m2.3a"><mrow id="S7.p2.2.m2.3.4.2" xref="S7.p2.2.m2.3.4.1.cmml"><mo stretchy="false" id="S7.p2.2.m2.3.4.2.1" xref="S7.p2.2.m2.3.4.1.cmml">(</mo><mn id="S7.p2.2.m2.1.1" xref="S7.p2.2.m2.1.1.cmml">3785</mn><mo id="S7.p2.2.m2.3.4.2.2" xref="S7.p2.2.m2.3.4.1.cmml">,</mo><mn id="S7.p2.2.m2.2.2" xref="S7.p2.2.m2.2.2.cmml">0.1279</mn><mo id="S7.p2.2.m2.3.4.2.3" xref="S7.p2.2.m2.3.4.1.cmml">,</mo><mn id="S7.p2.2.m2.3.3" xref="S7.p2.2.m2.3.3.cmml">0.662</mn><mo stretchy="false" id="S7.p2.2.m2.3.4.2.4" xref="S7.p2.2.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p2.2.m2.3b"><vector id="S7.p2.2.m2.3.4.1.cmml" xref="S7.p2.2.m2.3.4.2"><cn type="integer" id="S7.p2.2.m2.1.1.cmml" xref="S7.p2.2.m2.1.1">3785</cn><cn type="float" id="S7.p2.2.m2.2.2.cmml" xref="S7.p2.2.m2.2.2">0.1279</cn><cn type="float" id="S7.p2.2.m2.3.3.cmml" xref="S7.p2.2.m2.3.3">0.662</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="S7.p2.2.m2.3c">(3785,0.1279,0.662)</annotation><annotation encoding="application/x-llamapun" id="S7.p2.2.m2.3d">( 3785 , 0.1279 , 0.662 )</annotation></semantics></math> for WT2 respectively.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.2" class="ltx_p">In Tables 1 and 2, we show that the model further improves the perplexity of the language model by as much as <math id="S7.p3.1.m1.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S7.p3.1.m1.1a"><mn id="S7.p3.1.m1.1.1" xref="S7.p3.1.m1.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S7.p3.1.m1.1b"><cn type="integer" id="S7.p3.1.m1.1.1.cmml" xref="S7.p3.1.m1.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.1.m1.1c">6</annotation><annotation encoding="application/x-llamapun" id="S7.p3.1.m1.1d">6</annotation></semantics></math> perplexity points for PTB and <math id="S7.p3.2.m2.1" class="ltx_Math" alttext="11" display="inline"><semantics id="S7.p3.2.m2.1a"><mn id="S7.p3.2.m2.1.1" xref="S7.p3.2.m2.1.1.cmml">11</mn><annotation-xml encoding="MathML-Content" id="S7.p3.2.m2.1b"><cn type="integer" id="S7.p3.2.m2.1.1.cmml" xref="S7.p3.2.m2.1.1">11</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.2.m2.1c">11</annotation><annotation encoding="application/x-llamapun" id="S7.p3.2.m2.1d">11</annotation></semantics></math> points for WT2.
While this is smaller than the gains reported in <cite class="ltx_cite ltx_citemacro_citet">Grave et al. (<a href="#bib.bib11" title="" class="ltx_ref">2016</a>)</cite>, which used an LSTM without weight tying, this is still a substantial drop.
Given the simplicity of the neural cache model, and the lack of any trained components, these results suggest that existing neural language models remain fundamentally lacking, failing to capture long term dependencies or remember recently seen words effectively.</p>
</div>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p">To understand the impact the pointer had on the model, specifically the validation set perplexity, we detail the contribution that each word has on the cache model’s overall perplexity in Table 3.
We compute the sum of the total difference in the loss function value (i.e., log perplexity) between the LSTM-only and LSTM-with-cache models for the target words in the validation portion of the WikiText-2 data set.
We present results for the sum of the difference as opposed to the mean since the latter undesirably overemphasizes infrequently occurring words for which the cache helps significantly and ignores frequently occurring words for which the cache provides modest improvements that cumulatively make a strong contribution.</p>
</div>
<div id="S7.p5" class="ltx_para">
<p id="S7.p5.1" class="ltx_p">The largest cumulative gain is in improving the handling of &lt;unk&gt; tokens, though this is over 11540 instances.
The second best improvement, approximately one fifth the gain given by the &lt;unk&gt; tokens, is for Meridian, yet this word only occurs 161 times.
This indicates the cache still helps significantly even for relatively rare words, further demonstrated by Churchill, Blythe, or Sonic.
The cache is not beneficial when handling frequent word categories, such as punctuation or stop words, for which the language model is likely well suited.
These observations motivate the design of a cache framework that is more aware of the relative strengths of the two models.</p>
</div>
<figure id="S7.T3" class="ltx_table">
<table id="S7.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S7.T3.2.2" class="ltx_tr">
<th id="S7.T3.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S7.T3.2.2.3.1" class="ltx_text" style="font-size:90%;">Word</span></th>
<th id="S7.T3.2.2.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S7.T3.2.2.4.1" class="ltx_text" style="font-size:90%;">Count</span></th>
<th id="S7.T3.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_r ltx_border_tt">
<math id="S7.T3.1.1.1.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S7.T3.1.1.1.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S7.T3.1.1.1.m1.1.1" xref="S7.T3.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S7.T3.1.1.1.m1.1b"><ci id="S7.T3.1.1.1.m1.1.1.cmml" xref="S7.T3.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.1.1.1.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S7.T3.1.1.1.m1.1d">roman_Δ</annotation></semantics></math><span id="S7.T3.1.1.1.1" class="ltx_text" style="font-size:90%;">loss</span>
</th>
<th id="S7.T3.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S7.T3.2.2.5.1" class="ltx_text" style="font-size:90%;">Word</span></th>
<th id="S7.T3.2.2.6" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt"><span id="S7.T3.2.2.6.1" class="ltx_text" style="font-size:90%;">Count</span></th>
<th id="S7.T3.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">
<math id="S7.T3.2.2.2.m1.1" class="ltx_Math" alttext="\Delta" display="inline"><semantics id="S7.T3.2.2.2.m1.1a"><mi mathsize="90%" mathvariant="normal" id="S7.T3.2.2.2.m1.1.1" xref="S7.T3.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S7.T3.2.2.2.m1.1b"><ci id="S7.T3.2.2.2.m1.1.1.cmml" xref="S7.T3.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.T3.2.2.2.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S7.T3.2.2.2.m1.1d">roman_Δ</annotation></semantics></math><span id="S7.T3.2.2.2.1" class="ltx_text" style="font-size:90%;">loss</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S7.T3.2.3.1" class="ltx_tr">
<th id="S7.T3.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S7.T3.2.3.1.1.1" class="ltx_text" style="font-size:90%;">.</span></th>
<td id="S7.T3.2.3.1.2" class="ltx_td ltx_align_right ltx_border_t"><span id="S7.T3.2.3.1.2.1" class="ltx_text" style="font-size:90%;">7632</span></td>
<td id="S7.T3.2.3.1.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t"><span id="S7.T3.2.3.1.3.1" class="ltx_text" style="font-size:90%;">-696.45</span></td>
<th id="S7.T3.2.3.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S7.T3.2.3.1.4.1" class="ltx_text" style="font-size:90%;">&lt;unk&gt;</span></th>
<td id="S7.T3.2.3.1.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S7.T3.2.3.1.5.1" class="ltx_text" style="font-size:90%;">11540</span></td>
<td id="S7.T3.2.3.1.6" class="ltx_td ltx_align_right ltx_border_t"><span id="S7.T3.2.3.1.6.1" class="ltx_text" style="font-size:90%;">5047.34</span></td>
</tr>
<tr id="S7.T3.2.4.2" class="ltx_tr">
<th id="S7.T3.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.4.2.1.1" class="ltx_text" style="font-size:90%;">,</span></th>
<td id="S7.T3.2.4.2.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.4.2.2.1" class="ltx_text" style="font-size:90%;">9857</span></td>
<td id="S7.T3.2.4.2.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.4.2.3.1" class="ltx_text" style="font-size:90%;">-687.49</span></td>
<th id="S7.T3.2.4.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.4.2.4.1" class="ltx_text" style="font-size:90%;">Meridian</span></th>
<td id="S7.T3.2.4.2.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.4.2.5.1" class="ltx_text" style="font-size:90%;">161</span></td>
<td id="S7.T3.2.4.2.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.4.2.6.1" class="ltx_text" style="font-size:90%;">1057.78</span></td>
</tr>
<tr id="S7.T3.2.5.3" class="ltx_tr">
<th id="S7.T3.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.5.3.1.1" class="ltx_text" style="font-size:90%;">of</span></th>
<td id="S7.T3.2.5.3.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.5.3.2.1" class="ltx_text" style="font-size:90%;">5816</span></td>
<td id="S7.T3.2.5.3.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.5.3.3.1" class="ltx_text" style="font-size:90%;">-365.21</span></td>
<th id="S7.T3.2.5.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.5.3.4.1" class="ltx_text" style="font-size:90%;">Churchill</span></th>
<td id="S7.T3.2.5.3.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.5.3.5.1" class="ltx_text" style="font-size:90%;">137</span></td>
<td id="S7.T3.2.5.3.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.5.3.6.1" class="ltx_text" style="font-size:90%;">849.43</span></td>
</tr>
<tr id="S7.T3.2.6.4" class="ltx_tr">
<th id="S7.T3.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.6.4.1.1" class="ltx_text" style="font-size:90%;">=</span></th>
<td id="S7.T3.2.6.4.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.6.4.2.1" class="ltx_text" style="font-size:90%;">2884</span></td>
<td id="S7.T3.2.6.4.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.6.4.3.1" class="ltx_text" style="font-size:90%;">-342.01</span></td>
<th id="S7.T3.2.6.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.6.4.4.1" class="ltx_text" style="font-size:90%;">-</span></th>
<td id="S7.T3.2.6.4.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.6.4.5.1" class="ltx_text" style="font-size:90%;">67</span></td>
<td id="S7.T3.2.6.4.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.6.4.6.1" class="ltx_text" style="font-size:90%;">682.15</span></td>
</tr>
<tr id="S7.T3.2.7.5" class="ltx_tr">
<th id="S7.T3.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.7.5.1.1" class="ltx_text" style="font-size:90%;">to</span></th>
<td id="S7.T3.2.7.5.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.7.5.2.1" class="ltx_text" style="font-size:90%;">4048</span></td>
<td id="S7.T3.2.7.5.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.7.5.3.1" class="ltx_text" style="font-size:90%;">-283.10</span></td>
<th id="S7.T3.2.7.5.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.7.5.4.1" class="ltx_text" style="font-size:90%;">Blythe</span></th>
<td id="S7.T3.2.7.5.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.7.5.5.1" class="ltx_text" style="font-size:90%;">97</span></td>
<td id="S7.T3.2.7.5.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.7.5.6.1" class="ltx_text" style="font-size:90%;">554.95</span></td>
</tr>
<tr id="S7.T3.2.8.6" class="ltx_tr">
<th id="S7.T3.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.8.6.1.1" class="ltx_text" style="font-size:90%;">in</span></th>
<td id="S7.T3.2.8.6.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.8.6.2.1" class="ltx_text" style="font-size:90%;">4178</span></td>
<td id="S7.T3.2.8.6.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.8.6.3.1" class="ltx_text" style="font-size:90%;">-222.94</span></td>
<th id="S7.T3.2.8.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.8.6.4.1" class="ltx_text" style="font-size:90%;">Sonic</span></th>
<td id="S7.T3.2.8.6.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.8.6.5.1" class="ltx_text" style="font-size:90%;">75</span></td>
<td id="S7.T3.2.8.6.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.8.6.6.1" class="ltx_text" style="font-size:90%;">543.85</span></td>
</tr>
<tr id="S7.T3.2.9.7" class="ltx_tr">
<th id="S7.T3.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.9.7.1.1" class="ltx_text" style="font-size:90%;">&lt;eos&gt;</span></th>
<td id="S7.T3.2.9.7.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.9.7.2.1" class="ltx_text" style="font-size:90%;">3690</span></td>
<td id="S7.T3.2.9.7.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.9.7.3.1" class="ltx_text" style="font-size:90%;">-216.42</span></td>
<th id="S7.T3.2.9.7.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.9.7.4.1" class="ltx_text" style="font-size:90%;">Richmond</span></th>
<td id="S7.T3.2.9.7.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.9.7.5.1" class="ltx_text" style="font-size:90%;">101</span></td>
<td id="S7.T3.2.9.7.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.9.7.6.1" class="ltx_text" style="font-size:90%;">429.18</span></td>
</tr>
<tr id="S7.T3.2.10.8" class="ltx_tr">
<th id="S7.T3.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.10.8.1.1" class="ltx_text" style="font-size:90%;">and</span></th>
<td id="S7.T3.2.10.8.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.10.8.2.1" class="ltx_text" style="font-size:90%;">5251</span></td>
<td id="S7.T3.2.10.8.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.10.8.3.1" class="ltx_text" style="font-size:90%;">-215.38</span></td>
<th id="S7.T3.2.10.8.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.10.8.4.1" class="ltx_text" style="font-size:90%;">Starr</span></th>
<td id="S7.T3.2.10.8.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.10.8.5.1" class="ltx_text" style="font-size:90%;">74</span></td>
<td id="S7.T3.2.10.8.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.10.8.6.1" class="ltx_text" style="font-size:90%;">416.52</span></td>
</tr>
<tr id="S7.T3.2.11.9" class="ltx_tr">
<th id="S7.T3.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.11.9.1.1" class="ltx_text" style="font-size:90%;">the</span></th>
<td id="S7.T3.2.11.9.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.11.9.2.1" class="ltx_text" style="font-size:90%;">12481</span></td>
<td id="S7.T3.2.11.9.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.11.9.3.1" class="ltx_text" style="font-size:90%;">-209.97</span></td>
<th id="S7.T3.2.11.9.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.11.9.4.1" class="ltx_text" style="font-size:90%;">Australian</span></th>
<td id="S7.T3.2.11.9.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.11.9.5.1" class="ltx_text" style="font-size:90%;">234</span></td>
<td id="S7.T3.2.11.9.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.11.9.6.1" class="ltx_text" style="font-size:90%;">366.36</span></td>
</tr>
<tr id="S7.T3.2.12.10" class="ltx_tr">
<th id="S7.T3.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.12.10.1.1" class="ltx_text" style="font-size:90%;">a</span></th>
<td id="S7.T3.2.12.10.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.12.10.2.1" class="ltx_text" style="font-size:90%;">3381</span></td>
<td id="S7.T3.2.12.10.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.12.10.3.1" class="ltx_text" style="font-size:90%;">-149.78</span></td>
<th id="S7.T3.2.12.10.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.12.10.4.1" class="ltx_text" style="font-size:90%;">Pagan</span></th>
<td id="S7.T3.2.12.10.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.12.10.5.1" class="ltx_text" style="font-size:90%;">54</span></td>
<td id="S7.T3.2.12.10.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.12.10.6.1" class="ltx_text" style="font-size:90%;">365.19</span></td>
</tr>
<tr id="S7.T3.2.13.11" class="ltx_tr">
<th id="S7.T3.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.13.11.1.1" class="ltx_text" style="font-size:90%;">"</span></th>
<td id="S7.T3.2.13.11.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.13.11.2.1" class="ltx_text" style="font-size:90%;">2540</span></td>
<td id="S7.T3.2.13.11.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.13.11.3.1" class="ltx_text" style="font-size:90%;">-127.99</span></td>
<th id="S7.T3.2.13.11.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.13.11.4.1" class="ltx_text" style="font-size:90%;">Asahi</span></th>
<td id="S7.T3.2.13.11.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.13.11.5.1" class="ltx_text" style="font-size:90%;">39</span></td>
<td id="S7.T3.2.13.11.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.13.11.6.1" class="ltx_text" style="font-size:90%;">316.24</span></td>
</tr>
<tr id="S7.T3.2.14.12" class="ltx_tr">
<th id="S7.T3.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.14.12.1.1" class="ltx_text" style="font-size:90%;">that</span></th>
<td id="S7.T3.2.14.12.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.14.12.2.1" class="ltx_text" style="font-size:90%;">1365</span></td>
<td id="S7.T3.2.14.12.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.14.12.3.1" class="ltx_text" style="font-size:90%;">-118.09</span></td>
<th id="S7.T3.2.14.12.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.14.12.4.1" class="ltx_text" style="font-size:90%;">Japanese</span></th>
<td id="S7.T3.2.14.12.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.14.12.5.1" class="ltx_text" style="font-size:90%;">181</span></td>
<td id="S7.T3.2.14.12.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.14.12.6.1" class="ltx_text" style="font-size:90%;">295.97</span></td>
</tr>
<tr id="S7.T3.2.15.13" class="ltx_tr">
<th id="S7.T3.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.15.13.1.1" class="ltx_text" style="font-size:90%;">by</span></th>
<td id="S7.T3.2.15.13.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.15.13.2.1" class="ltx_text" style="font-size:90%;">1252</span></td>
<td id="S7.T3.2.15.13.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.15.13.3.1" class="ltx_text" style="font-size:90%;">-113.05</span></td>
<th id="S7.T3.2.15.13.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.15.13.4.1" class="ltx_text" style="font-size:90%;">Hu</span></th>
<td id="S7.T3.2.15.13.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.15.13.5.1" class="ltx_text" style="font-size:90%;">43</span></td>
<td id="S7.T3.2.15.13.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.15.13.6.1" class="ltx_text" style="font-size:90%;">285.58</span></td>
</tr>
<tr id="S7.T3.2.16.14" class="ltx_tr">
<th id="S7.T3.2.16.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.16.14.1.1" class="ltx_text" style="font-size:90%;">was</span></th>
<td id="S7.T3.2.16.14.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.16.14.2.1" class="ltx_text" style="font-size:90%;">2279</span></td>
<td id="S7.T3.2.16.14.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.16.14.3.1" class="ltx_text" style="font-size:90%;">-107.95</span></td>
<th id="S7.T3.2.16.14.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.16.14.4.1" class="ltx_text" style="font-size:90%;">Hedgehog</span></th>
<td id="S7.T3.2.16.14.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.16.14.5.1" class="ltx_text" style="font-size:90%;">29</span></td>
<td id="S7.T3.2.16.14.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.16.14.6.1" class="ltx_text" style="font-size:90%;">266.48</span></td>
</tr>
<tr id="S7.T3.2.17.15" class="ltx_tr">
<th id="S7.T3.2.17.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.17.15.1.1" class="ltx_text" style="font-size:90%;">)</span></th>
<td id="S7.T3.2.17.15.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.17.15.2.1" class="ltx_text" style="font-size:90%;">1101</span></td>
<td id="S7.T3.2.17.15.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.17.15.3.1" class="ltx_text" style="font-size:90%;">-94.74</span></td>
<th id="S7.T3.2.17.15.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.17.15.4.1" class="ltx_text" style="font-size:90%;">Burma</span></th>
<td id="S7.T3.2.17.15.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.17.15.5.1" class="ltx_text" style="font-size:90%;">35</span></td>
<td id="S7.T3.2.17.15.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.17.15.6.1" class="ltx_text" style="font-size:90%;">263.65</span></td>
</tr>
<tr id="S7.T3.2.18.16" class="ltx_tr">
<th id="S7.T3.2.18.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.18.16.1.1" class="ltx_text" style="font-size:90%;">with</span></th>
<td id="S7.T3.2.18.16.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.18.16.2.1" class="ltx_text" style="font-size:90%;">1176</span></td>
<td id="S7.T3.2.18.16.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.18.16.3.1" class="ltx_text" style="font-size:90%;">-93.01</span></td>
<th id="S7.T3.2.18.16.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.18.16.4.1" class="ltx_text" style="font-size:90%;">29</span></th>
<td id="S7.T3.2.18.16.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.18.16.5.1" class="ltx_text" style="font-size:90%;">92</span></td>
<td id="S7.T3.2.18.16.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.18.16.6.1" class="ltx_text" style="font-size:90%;">260.88</span></td>
</tr>
<tr id="S7.T3.2.19.17" class="ltx_tr">
<th id="S7.T3.2.19.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.19.17.1.1" class="ltx_text" style="font-size:90%;">for</span></th>
<td id="S7.T3.2.19.17.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.19.17.2.1" class="ltx_text" style="font-size:90%;">1215</span></td>
<td id="S7.T3.2.19.17.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.19.17.3.1" class="ltx_text" style="font-size:90%;">-87.68</span></td>
<th id="S7.T3.2.19.17.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.19.17.4.1" class="ltx_text" style="font-size:90%;">Mississippi</span></th>
<td id="S7.T3.2.19.17.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.19.17.5.1" class="ltx_text" style="font-size:90%;">72</span></td>
<td id="S7.T3.2.19.17.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.19.17.6.1" class="ltx_text" style="font-size:90%;">241.59</span></td>
</tr>
<tr id="S7.T3.2.20.18" class="ltx_tr">
<th id="S7.T3.2.20.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.20.18.1.1" class="ltx_text" style="font-size:90%;">on</span></th>
<td id="S7.T3.2.20.18.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.20.18.2.1" class="ltx_text" style="font-size:90%;">1485</span></td>
<td id="S7.T3.2.20.18.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.20.18.3.1" class="ltx_text" style="font-size:90%;">-81.55</span></td>
<th id="S7.T3.2.20.18.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.20.18.4.1" class="ltx_text" style="font-size:90%;">German</span></th>
<td id="S7.T3.2.20.18.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.20.18.5.1" class="ltx_text" style="font-size:90%;">108</span></td>
<td id="S7.T3.2.20.18.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.20.18.6.1" class="ltx_text" style="font-size:90%;">241.23</span></td>
</tr>
<tr id="S7.T3.2.21.19" class="ltx_tr">
<th id="S7.T3.2.21.19.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.21.19.1.1" class="ltx_text" style="font-size:90%;">as</span></th>
<td id="S7.T3.2.21.19.2" class="ltx_td ltx_align_right"><span id="S7.T3.2.21.19.2.1" class="ltx_text" style="font-size:90%;">1338</span></td>
<td id="S7.T3.2.21.19.3" class="ltx_td ltx_align_right ltx_border_r"><span id="S7.T3.2.21.19.3.1" class="ltx_text" style="font-size:90%;">-77.05</span></td>
<th id="S7.T3.2.21.19.4" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S7.T3.2.21.19.4.1" class="ltx_text" style="font-size:90%;">mill</span></th>
<td id="S7.T3.2.21.19.5" class="ltx_td ltx_align_right"><span id="S7.T3.2.21.19.5.1" class="ltx_text" style="font-size:90%;">67</span></td>
<td id="S7.T3.2.21.19.6" class="ltx_td ltx_align_right"><span id="S7.T3.2.21.19.6.1" class="ltx_text" style="font-size:90%;">237.76</span></td>
</tr>
<tr id="S7.T3.2.22.20" class="ltx_tr">
<th id="S7.T3.2.22.20.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S7.T3.2.22.20.1.1" class="ltx_text" style="font-size:90%;">at</span></th>
<td id="S7.T3.2.22.20.2" class="ltx_td ltx_align_right ltx_border_bb"><span id="S7.T3.2.22.20.2.1" class="ltx_text" style="font-size:90%;">879</span></td>
<td id="S7.T3.2.22.20.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r"><span id="S7.T3.2.22.20.3.1" class="ltx_text" style="font-size:90%;">-59.86</span></td>
<th id="S7.T3.2.22.20.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S7.T3.2.22.20.4.1" class="ltx_text" style="font-size:90%;">Cooke</span></th>
<td id="S7.T3.2.22.20.5" class="ltx_td ltx_align_right ltx_border_bb"><span id="S7.T3.2.22.20.5.1" class="ltx_text" style="font-size:90%;">33</span></td>
<td id="S7.T3.2.22.20.6" class="ltx_td ltx_align_right ltx_border_bb"><span id="S7.T3.2.22.20.6.1" class="ltx_text" style="font-size:90%;">231.11</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>
The sum total difference in loss (log perplexity) that a given word results in over all instances in the validation data set of WikiText-2 when the continuous cache pointer is introduced. The right column contains the words with the twenty best improvements (i.e., where the cache was advantageous), and the left column the twenty most deteriorated (i.e., where the cache was disadvantageous).</figcaption>
</figure>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Model Ablation Analysis</h2>

<figure id="S8.T4" class="ltx_table">
<table id="S8.T4.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S8.T4.6.7.1" class="ltx_tr">
<th id="S8.T4.6.7.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt"></th>
<td id="S8.T4.6.7.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2">PTB</td>
<td id="S8.T4.6.7.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">WT2</td>
</tr>
<tr id="S8.T4.6.8.2" class="ltx_tr">
<th id="S8.T4.6.8.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r"><span id="S8.T4.6.8.2.1.1" class="ltx_text ltx_font_bold">Model</span></th>
<td id="S8.T4.6.8.2.2" class="ltx_td ltx_align_center"><span id="S8.T4.6.8.2.2.1" class="ltx_text ltx_font_bold">Validation</span></td>
<td id="S8.T4.6.8.2.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S8.T4.6.8.2.3.1" class="ltx_text ltx_font_bold">Test</span></td>
<td id="S8.T4.6.8.2.4" class="ltx_td ltx_align_center"><span id="S8.T4.6.8.2.4.1" class="ltx_text ltx_font_bold">Validation</span></td>
<td id="S8.T4.6.8.2.5" class="ltx_td ltx_align_center"><span id="S8.T4.6.8.2.5.1" class="ltx_text ltx_font_bold">Test</span></td>
</tr>
<tr id="S8.T4.2.2" class="ltx_tr">
<th id="S8.T4.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">AWD-LSTM (tied)</th>
<td id="S8.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S8.T4.1.1.1.m1.1" class="ltx_Math" alttext="60.0" display="inline"><semantics id="S8.T4.1.1.1.m1.1a"><mn id="S8.T4.1.1.1.m1.1.1" xref="S8.T4.1.1.1.m1.1.1.cmml">60.0</mn><annotation-xml encoding="MathML-Content" id="S8.T4.1.1.1.m1.1b"><cn type="float" id="S8.T4.1.1.1.m1.1.1.cmml" xref="S8.T4.1.1.1.m1.1.1">60.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.1.1.1.m1.1c">60.0</annotation><annotation encoding="application/x-llamapun" id="S8.T4.1.1.1.m1.1d">60.0</annotation></semantics></math></td>
<td id="S8.T4.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S8.T4.2.2.2.m1.1" class="ltx_Math" alttext="57.3" display="inline"><semantics id="S8.T4.2.2.2.m1.1a"><mn id="S8.T4.2.2.2.m1.1.1" xref="S8.T4.2.2.2.m1.1.1.cmml">57.3</mn><annotation-xml encoding="MathML-Content" id="S8.T4.2.2.2.m1.1b"><cn type="float" id="S8.T4.2.2.2.m1.1.1.cmml" xref="S8.T4.2.2.2.m1.1.1">57.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.2.2.2.m1.1c">57.3</annotation><annotation encoding="application/x-llamapun" id="S8.T4.2.2.2.m1.1d">57.3</annotation></semantics></math></td>
<td id="S8.T4.2.2.4" class="ltx_td ltx_align_center ltx_border_t">68.6</td>
<td id="S8.T4.2.2.5" class="ltx_td ltx_align_center ltx_border_t">65.8</td>
</tr>
<tr id="S8.T4.6.6" class="ltx_tr">
<th id="S8.T4.6.6.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">– fine-tuning</th>
<td id="S8.T4.3.3.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S8.T4.3.3.1.m1.1" class="ltx_Math" alttext="60.7" display="inline"><semantics id="S8.T4.3.3.1.m1.1a"><mn id="S8.T4.3.3.1.m1.1.1" xref="S8.T4.3.3.1.m1.1.1.cmml">60.7</mn><annotation-xml encoding="MathML-Content" id="S8.T4.3.3.1.m1.1b"><cn type="float" id="S8.T4.3.3.1.m1.1.1.cmml" xref="S8.T4.3.3.1.m1.1.1">60.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.3.3.1.m1.1c">60.7</annotation><annotation encoding="application/x-llamapun" id="S8.T4.3.3.1.m1.1d">60.7</annotation></semantics></math></td>
<td id="S8.T4.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S8.T4.4.4.2.m1.1" class="ltx_Math" alttext="58.8" display="inline"><semantics id="S8.T4.4.4.2.m1.1a"><mn id="S8.T4.4.4.2.m1.1.1" xref="S8.T4.4.4.2.m1.1.1.cmml">58.8</mn><annotation-xml encoding="MathML-Content" id="S8.T4.4.4.2.m1.1b"><cn type="float" id="S8.T4.4.4.2.m1.1.1.cmml" xref="S8.T4.4.4.2.m1.1.1">58.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.4.4.2.m1.1c">58.8</annotation><annotation encoding="application/x-llamapun" id="S8.T4.4.4.2.m1.1d">58.8</annotation></semantics></math></td>
<td id="S8.T4.5.5.3" class="ltx_td ltx_align_center ltx_border_t"><math id="S8.T4.5.5.3.m1.1" class="ltx_Math" alttext="69.1" display="inline"><semantics id="S8.T4.5.5.3.m1.1a"><mn id="S8.T4.5.5.3.m1.1.1" xref="S8.T4.5.5.3.m1.1.1.cmml">69.1</mn><annotation-xml encoding="MathML-Content" id="S8.T4.5.5.3.m1.1b"><cn type="float" id="S8.T4.5.5.3.m1.1.1.cmml" xref="S8.T4.5.5.3.m1.1.1">69.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.5.5.3.m1.1c">69.1</annotation><annotation encoding="application/x-llamapun" id="S8.T4.5.5.3.m1.1d">69.1</annotation></semantics></math></td>
<td id="S8.T4.6.6.4" class="ltx_td ltx_align_center ltx_border_t"><math id="S8.T4.6.6.4.m1.1" class="ltx_Math" alttext="66.0" display="inline"><semantics id="S8.T4.6.6.4.m1.1a"><mn id="S8.T4.6.6.4.m1.1.1" xref="S8.T4.6.6.4.m1.1.1.cmml">66.0</mn><annotation-xml encoding="MathML-Content" id="S8.T4.6.6.4.m1.1b"><cn type="float" id="S8.T4.6.6.4.m1.1.1.cmml" xref="S8.T4.6.6.4.m1.1.1">66.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.6.6.4.m1.1c">66.0</annotation><annotation encoding="application/x-llamapun" id="S8.T4.6.6.4.m1.1d">66.0</annotation></semantics></math></td>
</tr>
<tr id="S8.T4.6.9.3" class="ltx_tr">
<th id="S8.T4.6.9.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">– NT-ASGD</th>
<td id="S8.T4.6.9.3.2" class="ltx_td ltx_align_center">66.3</td>
<td id="S8.T4.6.9.3.3" class="ltx_td ltx_align_center ltx_border_r">63.7</td>
<td id="S8.T4.6.9.3.4" class="ltx_td ltx_align_center">73.3</td>
<td id="S8.T4.6.9.3.5" class="ltx_td ltx_align_center">69.7</td>
</tr>
<tr id="S8.T4.6.10.4" class="ltx_tr">
<th id="S8.T4.6.10.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">– variable sequence lengths</th>
<td id="S8.T4.6.10.4.2" class="ltx_td ltx_align_center ltx_border_t">61.3</td>
<td id="S8.T4.6.10.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58.9</td>
<td id="S8.T4.6.10.4.4" class="ltx_td ltx_align_center ltx_border_t">69.3</td>
<td id="S8.T4.6.10.4.5" class="ltx_td ltx_align_center ltx_border_t">66.2</td>
</tr>
<tr id="S8.T4.6.11.5" class="ltx_tr">
<th id="S8.T4.6.11.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">– embedding dropout</th>
<td id="S8.T4.6.11.5.2" class="ltx_td ltx_align_center">65.1</td>
<td id="S8.T4.6.11.5.3" class="ltx_td ltx_align_center ltx_border_r">62.7</td>
<td id="S8.T4.6.11.5.4" class="ltx_td ltx_align_center">71.1</td>
<td id="S8.T4.6.11.5.5" class="ltx_td ltx_align_center">68.1</td>
</tr>
<tr id="S8.T4.6.12.6" class="ltx_tr">
<th id="S8.T4.6.12.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">– weight decay</th>
<td id="S8.T4.6.12.6.2" class="ltx_td ltx_align_center">63.7</td>
<td id="S8.T4.6.12.6.3" class="ltx_td ltx_align_center ltx_border_r">61.0</td>
<td id="S8.T4.6.12.6.4" class="ltx_td ltx_align_center">71.9</td>
<td id="S8.T4.6.12.6.5" class="ltx_td ltx_align_center">68.7</td>
</tr>
<tr id="S8.T4.6.13.7" class="ltx_tr">
<th id="S8.T4.6.13.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">– AR/TAR</th>
<td id="S8.T4.6.13.7.2" class="ltx_td ltx_align_center">62.7</td>
<td id="S8.T4.6.13.7.3" class="ltx_td ltx_align_center ltx_border_r">60.3</td>
<td id="S8.T4.6.13.7.4" class="ltx_td ltx_align_center">73.2</td>
<td id="S8.T4.6.13.7.5" class="ltx_td ltx_align_center">70.1</td>
</tr>
<tr id="S8.T4.6.14.8" class="ltx_tr">
<th id="S8.T4.6.14.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">– full sized embedding</th>
<td id="S8.T4.6.14.8.2" class="ltx_td ltx_align_center">68.0</td>
<td id="S8.T4.6.14.8.3" class="ltx_td ltx_align_center ltx_border_r">65.6</td>
<td id="S8.T4.6.14.8.4" class="ltx_td ltx_align_center">73.7</td>
<td id="S8.T4.6.14.8.5" class="ltx_td ltx_align_center">70.7</td>
</tr>
<tr id="S8.T4.6.15.9" class="ltx_tr">
<th id="S8.T4.6.15.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">– weight-dropping</th>
<td id="S8.T4.6.15.9.2" class="ltx_td ltx_align_center ltx_border_bb">71.1</td>
<td id="S8.T4.6.15.9.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">68.9</td>
<td id="S8.T4.6.15.9.4" class="ltx_td ltx_align_center ltx_border_bb">78.4</td>
<td id="S8.T4.6.15.9.5" class="ltx_td ltx_align_center ltx_border_bb">74.9</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>
Model ablations for our best LSTM models reporting results over the validation and test set on Penn Treebank and WikiText-2.
Ablations are split into optimization and regularization variants, sorted according to the achieved validation perplexity on WikiText-2.
</figcaption>
</figure>
<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">In Table <a href="#S8.T4" title="Table 4 ‣ 8 Model Ablation Analysis ‣ Regularizing and Optimizing LSTM Language Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we present the values of validation and testing perplexity for different variants of our best-performing LSTM model.
Each variant removes a form of optimization or regularization.</p>
</div>
<div id="S8.p2" class="ltx_para">
<p id="S8.p2.1" class="ltx_p">The first two variants deal with the optimization of the language models while the rest deal with the regularization.
For the model using SGD with learning rate reduced by 2 using the same nonmonotonic fashion, there is a significant degradation in performance.
This stands as empirical evidence regarding the benefit of averaging of the iterates.
Using a monotonic criterion instead also hampered performance.
Similarly, the removal of the fine-tuning step expectedly also degrades the performance. This step helps improve the estimate of the minimizer by resetting the memory of the previous experiment. While this process of fine-tuning can be repeated multiple times, we found little benefit in repeating it more than once.</p>
</div>
<div id="S8.p3" class="ltx_para">
<p id="S8.p3.1" class="ltx_p">The removal of regularization strategies paints a similar picture; the inclusion of all of the proposed strategies was pivotal in ensuring state-of-the-art performance.
The most extreme perplexity jump was in removing the hidden-to-hidden LSTM regularization provided by the weight-dropped LSTM.
Without such hidden-to-hidden regularization, perplexity rises substantially, up to 11 points.
This is in line with previous work showing the necessity of recurrent regularization in state-of-the-art models <cite class="ltx_cite ltx_citemacro_citep">(Gal &amp; Ghahramani, <a href="#bib.bib9" title="" class="ltx_ref">2016</a>; Inan et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S8.p4" class="ltx_para">
<p id="S8.p4.5" class="ltx_p">We also experiment with static sequence lengths which we had hypothesized would lead to inefficient data usage.
This also worsens the performance by approximately one perplexity unit. Next, we experiment with reverting to matching the sizes of the embedding vectors and the hidden states.
This significantly increases the number of parameters in the network (to <math id="S8.p4.1.m1.1" class="ltx_Math" alttext="43" display="inline"><semantics id="S8.p4.1.m1.1a"><mn id="S8.p4.1.m1.1.1" xref="S8.p4.1.m1.1.1.cmml">43</mn><annotation-xml encoding="MathML-Content" id="S8.p4.1.m1.1b"><cn type="integer" id="S8.p4.1.m1.1.1.cmml" xref="S8.p4.1.m1.1.1">43</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.1.m1.1c">43</annotation><annotation encoding="application/x-llamapun" id="S8.p4.1.m1.1d">43</annotation></semantics></math>M in the case of PTB and <math id="S8.p4.2.m2.1" class="ltx_Math" alttext="70" display="inline"><semantics id="S8.p4.2.m2.1a"><mn id="S8.p4.2.m2.1.1" xref="S8.p4.2.m2.1.1.cmml">70</mn><annotation-xml encoding="MathML-Content" id="S8.p4.2.m2.1b"><cn type="integer" id="S8.p4.2.m2.1.1.cmml" xref="S8.p4.2.m2.1.1">70</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.2.m2.1c">70</annotation><annotation encoding="application/x-llamapun" id="S8.p4.2.m2.1d">70</annotation></semantics></math>M for WT2) and leads to degradation by almost <math id="S8.p4.3.m3.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S8.p4.3.m3.1a"><mn id="S8.p4.3.m3.1.1" xref="S8.p4.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S8.p4.3.m3.1b"><cn type="integer" id="S8.p4.3.m3.1.1.cmml" xref="S8.p4.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.3.m3.1c">8</annotation><annotation encoding="application/x-llamapun" id="S8.p4.3.m3.1d">8</annotation></semantics></math> perplexity points, which we attribute to overfitting in the word embeddings.
While this could potentially be improved with more aggressive regularization, the computational overhead involved with substantially larger embeddings likely outweighs any advantages.
Finally, we experiment with the removal of embedding dropout, AR/TAR and weight decay. In all of the cases, the model suffers a perplexity increase of <math id="S8.p4.4.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S8.p4.4.m4.1a"><mn id="S8.p4.4.m4.1.1" xref="S8.p4.4.m4.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S8.p4.4.m4.1b"><cn type="integer" id="S8.p4.4.m4.1.1.cmml" xref="S8.p4.4.m4.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.4.m4.1c">2</annotation><annotation encoding="application/x-llamapun" id="S8.p4.4.m4.1d">2</annotation></semantics></math>–<math id="S8.p4.5.m5.1" class="ltx_Math" alttext="6" display="inline"><semantics id="S8.p4.5.m5.1a"><mn id="S8.p4.5.m5.1.1" xref="S8.p4.5.m5.1.1.cmml">6</mn><annotation-xml encoding="MathML-Content" id="S8.p4.5.m5.1b"><cn type="integer" id="S8.p4.5.m5.1.1.cmml" xref="S8.p4.5.m5.1.1">6</cn></annotation-xml><annotation encoding="application/x-tex" id="S8.p4.5.m5.1c">6</annotation><annotation encoding="application/x-llamapun" id="S8.p4.5.m5.1d">6</annotation></semantics></math> points which we hypothesize is due to insufficient regularization in the network.</p>
</div>
</section>
<section id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Conclusion</h2>

<div id="S9.p1" class="ltx_para">
<p id="S9.p1.1" class="ltx_p">In this work, we discuss regularization and optimization strategies for neural language models. We propose the weight-dropped LSTM, a strategy that uses a DropConnect mask on the hidden-to-hidden weight matrices, as a means to prevent overfitting across the recurrent connections. Further, we investigate the use of averaged SGD with a non-monontonic trigger for training language models and show that it outperforms SGD by a significant margin. We investigate other regularization strategies including the use of variable BPTT length and achieve a new state-of-the-art perplexity on the PTB and WikiText-2 data sets. Our models outperform custom-built RNN cells and complex regularization strategies that preclude the possibility of using optimized libraries such as the NVIDIA cuDNN LSTM. Finally, we explore the use of a neural cache in conjunction with our proposed model and show that this further improves the performance, thus attaining an even lower state-of-the-art perplexity.
While the regularization and optimization strategies proposed are demonstrated on the task of language modeling, we anticipate that they would be generally applicable across other sequence learning tasks.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arjovsky et al. (2016)</span>
<span class="ltx_bibblock">
Arjovsky, M., Shah, A., and Bengio, Y.

</span>
<span class="ltx_bibblock">Unitary evolution recurrent neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 1120–1128, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ba et al. (2016)</span>
<span class="ltx_bibblock">
Ba, J., Kiros, J., and Hinton, G. E.

</span>
<span class="ltx_bibblock">Layer normalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1607.06450, 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balduzzi &amp; Ghifary (2016)</span>
<span class="ltx_bibblock">
Balduzzi, D. and Ghifary, M.

</span>
<span class="ltx_bibblock">Strongly-typed recurrent neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1602.02218</em>, 2016.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bottou et al. (2016)</span>
<span class="ltx_bibblock">
Bottou, L., Curtis, F. E., and Nocedal, J.

</span>
<span class="ltx_bibblock">Optimization methods for large-scale machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.04838</em>, 2016.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradbury et al. (2016)</span>
<span class="ltx_bibblock">
Bradbury, J., Merity, S., Xiong, C., and Socher, R.

</span>
<span class="ltx_bibblock">Quasi-Recurrent Neural Networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1611.01576</em>, 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cooijmans et al. (2016)</span>
<span class="ltx_bibblock">
Cooijmans, T., Ballas, N., Laurent, C., and Courville, A. C.

</span>
<span class="ltx_bibblock">Recurrent batch normalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1603.09025, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duchi et al. (2011)</span>
<span class="ltx_bibblock">
Duchi, J., Hazan, E., and Singer, Y.

</span>
<span class="ltx_bibblock">Adaptive subgradient methods for online learning and stochastic
optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 12(Jul):2121–2159, 2011.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Földiák (1991)</span>
<span class="ltx_bibblock">
Földiák, P.

</span>
<span class="ltx_bibblock">Learning invariance from transformation sequences.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Neural Computation</em>, 3(2):194–200, 1991.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gal &amp; Ghahramani (2016)</span>
<span class="ltx_bibblock">
Gal, Y. and Ghahramani, Z.

</span>
<span class="ltx_bibblock">A theoretically grounded application of dropout in recurrent neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Goyal, P., Dollár, P., Girshick, R., Noordhuis, P., Wesolowski, L., Kyrola,
A., Tulloch, A., Jia, Y., and He, K.

</span>
<span class="ltx_bibblock">Accurate, large minibatch sgd: Training imagenet in 1 hour.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1706.02677</em>, 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grave et al. (2016)</span>
<span class="ltx_bibblock">
Grave, E., Joulin, A., and Usunier, N.

</span>
<span class="ltx_bibblock">Improving neural language models with a continuous cache.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1612.04426</em>, 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hardt et al. (2015)</span>
<span class="ltx_bibblock">
Hardt, M., Recht, B., and Singer, Y.

</span>
<span class="ltx_bibblock">Train faster, generalize better: Stability of stochastic gradient
descent.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1509.01240</em>, 2015.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton (1989)</span>
<span class="ltx_bibblock">
Hinton, G. E.

</span>
<span class="ltx_bibblock">Connectionist learning procedures.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence</em>, 40(1-3):185–234,
1989.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Inan et al. (2016)</span>
<span class="ltx_bibblock">
Inan, H., Khosravi, K., and Socher, R.

</span>
<span class="ltx_bibblock">Tying Word Vectors and Word Classifiers: A Loss Framework for
Language Modeling.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1611.01462</em>, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ioffe &amp; Szegedy (2015)</span>
<span class="ltx_bibblock">
Ioffe, S. and Szegedy, C.

</span>
<span class="ltx_bibblock">Batch normalization: Accelerating deep network training by reducing
internal covariate shift.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2015.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jing et al. (2016)</span>
<span class="ltx_bibblock">
Jing, L., Shen, Y., Dubček, T., Peurifoy, J., Skirlo, S., Tegmark, M.,
and Soljačić, M.

</span>
<span class="ltx_bibblock">Tunable Efficient Unitary Neural Networks (EUNN) and their
application to RNN.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1612.05231</em>, 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jonschkowski &amp; Brock (2015)</span>
<span class="ltx_bibblock">
Jonschkowski, R. and Brock, O.

</span>
<span class="ltx_bibblock">Learning state representations with robotic priors.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Auton. Robots</em>, 39:407–428, 2015.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keskar &amp; Saon (2015)</span>
<span class="ltx_bibblock">
Keskar, N. and Saon, G.

</span>
<span class="ltx_bibblock">A nonmonotone learning rate strategy for sgd training of deep neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Acoustics, Speech and Signal Processing (ICASSP), 2015 IEEE
International Conference on</em>, pp.  4974–4978. IEEE, 2015.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2016)</span>
<span class="ltx_bibblock">
Kim, Y., Jernite, Y., Sontag, D., and Rush, A. M.

</span>
<span class="ltx_bibblock">Character-aware neural language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Thirtieth AAAI Conference on Artificial Intelligence</em>, 2016.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Kingma, D. and Ba, J.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koehn et al. (2007)</span>
<span class="ltx_bibblock">
Koehn, P., Hoang, H., Birch, A., Callison-Burch, C., Federico, M., Bertoldi,
N., Cowan, B., Shen, W., Moran, C., Zens, R., Dyer, C., Bojar, O.,
Constantin, A., and Herbst, E.

</span>
<span class="ltx_bibblock">Moses: Open source toolkit for statistical machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ACL</em>, 2007.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krueger et al. (2016)</span>
<span class="ltx_bibblock">
Krueger, D., Maharaj, T., Kramár, J., Pezeshki, M., Ballas, N., Ke, N.,
Goyal, A., Bengio, Y., Larochelle, H., Courville, A., et al.

</span>
<span class="ltx_bibblock">Zoneout: Regularizing RNNss by randomly preserving hidden
activations.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.01305</em>, 2016.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luciw &amp; Schmidhuber (2012)</span>
<span class="ltx_bibblock">
Luciw, M. and Schmidhuber, J.

</span>
<span class="ltx_bibblock">Low complexity proto-value function learning from sensory
observations with incremental slow feature analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Artificial Neural Networks and Machine Learning–ICANN 2012</em>,
pp.  279–287, 2012.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mandt et al. (2017)</span>
<span class="ltx_bibblock">
Mandt, S., Hoffman, M. D., and Blei, D. M.

</span>
<span class="ltx_bibblock">Stochastic gradient descent as approximate bayesian inference.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1704.04289</em>, 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Melis et al. (2017)</span>
<span class="ltx_bibblock">
Melis, G., Dyer, C., and Blunsom, P.

</span>
<span class="ltx_bibblock">On the State of the Art of Evaluation in Neural Language Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.05589</em>, 2017.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et al. (2016)</span>
<span class="ltx_bibblock">
Merity, S., Xiong, C., Bradbury, J., and Socher, R.

</span>
<span class="ltx_bibblock">Pointer Sentinel Mixture Models.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1609.07843</em>, 2016.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Merity et al. (2017)</span>
<span class="ltx_bibblock">
Merity, S., McCann, B., and Socher, R.

</span>
<span class="ltx_bibblock">Revisiting activation regularization for language rnns.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1708.01009</em>, 2017.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov &amp; Zweig (2012)</span>
<span class="ltx_bibblock">
Mikolov, T. and Zweig, G.

</span>
<span class="ltx_bibblock">Context dependent recurrent neural network language model.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">SLT</em>, 12:234–239, 2012.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikolov et al. (2010)</span>
<span class="ltx_bibblock">
Mikolov, T., Karafiát, M., Burget, L., Cernocký, J., and Khudanpur, S.

</span>
<span class="ltx_bibblock">Recurrent neural network based language model.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">INTERSPEECH</em>, 2010.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Panageas &amp; Piliouras (2016)</span>
<span class="ltx_bibblock">
Panageas, I. and Piliouras, G.

</span>
<span class="ltx_bibblock">Gradient descent converges to minimizers: The case of non-isolated
critical points.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">CoRR, abs/1605.00405</em>, 2016.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Polyak &amp; Juditsky (1992)</span>
<span class="ltx_bibblock">
Polyak, B. and Juditsky, A.

</span>
<span class="ltx_bibblock">Acceleration of stochastic approximation by averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">SIAM Journal on Control and Optimization</em>, 30(4):838–855, 1992.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Press &amp; Wolf (2016)</span>
<span class="ltx_bibblock">
Press, O. and Wolf, L.

</span>
<span class="ltx_bibblock">Using the output embedding to improve language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1608.05859</em>, 2016.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Semeniuta et al. (2016)</span>
<span class="ltx_bibblock">
Semeniuta, S., Severyn, A., and Barth, E.

</span>
<span class="ltx_bibblock">Recurrent dropout without memory loss.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">COLING</em>, 2016.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seo et al. (2016)</span>
<span class="ltx_bibblock">
Seo, M., Min, S., Farhadi, A., and Hajishirzi, H.

</span>
<span class="ltx_bibblock">Query-Reduction Networks for Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.04582</em>, 2016.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al. (2014)</span>
<span class="ltx_bibblock">
Srivastava, N., Hinton, G., Krizhevsky, A., Sutskever, I., and Salakhutdinov,
R.

</span>
<span class="ltx_bibblock">Dropout: a simple way to prevent neural networks from overfitting.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 15:1929–1958,
2014.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. (2013)</span>
<span class="ltx_bibblock">
Sutskever, I., Martens, J., Dahl, G., and Hinton, G.

</span>
<span class="ltx_bibblock">On the importance of initialization and momentum in deep learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp. 1139–1147, 2013.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tallec &amp; Ollivier (2017)</span>
<span class="ltx_bibblock">
Tallec, C. and Ollivier, Y.

</span>
<span class="ltx_bibblock">Unbiasing truncated backpropagation through time.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1705.08209</em>, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tieleman &amp; Hinton (2012)</span>
<span class="ltx_bibblock">
Tieleman, T. and Hinton, G.

</span>
<span class="ltx_bibblock">Lecture 6.5-rmsprop: Divide the gradient by a running average of its
recent magnitude.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">COURSERA: Neural networks for machine learning</em>, 4(2):26–31, 2012.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wan et al. (2013)</span>
<span class="ltx_bibblock">
Wan, L., Zeiler, M., Zhang, S., LeCun, Y, and Fergus, R.

</span>
<span class="ltx_bibblock">Regularization of neural networks using dropconnect.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 30th international conference on machine
learning (ICML-13)</em>, pp.  1058–1066, 2013.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wilson et al. (2017)</span>
<span class="ltx_bibblock">
Wilson, A. C, Roelofs, R., Stern, M., Srebro, N., and Recht, B.

</span>
<span class="ltx_bibblock">The marginal value of adaptive gradient methods in machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1705.08292</em>, 2017.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wisdom et al. (2016)</span>
<span class="ltx_bibblock">
Wisdom, S., Powers, T., Hershey, J., Le Roux, J., and Atlas, L.

</span>
<span class="ltx_bibblock">Full-capacity unitary recurrent neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pp. 4880–4888, 2016.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaremba et al. (2014)</span>
<span class="ltx_bibblock">
Zaremba, W., Sutskever, I., and Vinyals, O.

</span>
<span class="ltx_bibblock">Recurrent neural network regularization.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1409.2329</em>, 2014.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zilly et al. (2016)</span>
<span class="ltx_bibblock">
Zilly, J. G., Srivastava, R. K., Koutník, J., and Schmidhuber, J.

</span>
<span class="ltx_bibblock">Recurrent highway networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1607.03474</em>, 2016.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zoph &amp; Le (2016)</span>
<span class="ltx_bibblock">
Zoph, B. and Le, Q. V.

</span>
<span class="ltx_bibblock">Neural architecture search with reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1611.01578</em>, 2016.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1708.02181" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1708.02182" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1708.02182">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1708.02182" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1708.02183" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Dec 31 15:01:12 2021 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }      
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })
      
      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
